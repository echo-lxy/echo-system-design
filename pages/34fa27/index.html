<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Linux ф╕нчЪД IO хдЪш╖пхдНчФи | Echo ч│╗ч╗Яшо╛шобф╣Лч╛О</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="ц░┤ц╗┤чЯ│чй┐я╝Мшо╛шобцЧащУ╢х╝╣">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.bc6beed4.css" as="style"><link rel="preload" href="/assets/js/app.aaad5302.js" as="script"><link rel="preload" href="/assets/js/2.933750c6.js" as="script"><link rel="preload" href="/assets/js/44.ff4f9547.js" as="script"><link rel="preload" href="/assets/js/7.7eb70372.js" as="script"><link rel="prefetch" href="/assets/js/10.2cc95be8.js"><link rel="prefetch" href="/assets/js/11.c7521a10.js"><link rel="prefetch" href="/assets/js/12.c0ea1b08.js"><link rel="prefetch" href="/assets/js/13.d9d26d25.js"><link rel="prefetch" href="/assets/js/14.1141ec27.js"><link rel="prefetch" href="/assets/js/15.61830f0a.js"><link rel="prefetch" href="/assets/js/16.f2ccbb47.js"><link rel="prefetch" href="/assets/js/17.1f44d5e0.js"><link rel="prefetch" href="/assets/js/18.e689f555.js"><link rel="prefetch" href="/assets/js/19.68db5844.js"><link rel="prefetch" href="/assets/js/20.b5e0fdf1.js"><link rel="prefetch" href="/assets/js/21.af1069aa.js"><link rel="prefetch" href="/assets/js/22.af583a75.js"><link rel="prefetch" href="/assets/js/23.f8a8e8e0.js"><link rel="prefetch" href="/assets/js/24.88b84218.js"><link rel="prefetch" href="/assets/js/25.acf70158.js"><link rel="prefetch" href="/assets/js/26.381f581c.js"><link rel="prefetch" href="/assets/js/27.e82ff876.js"><link rel="prefetch" href="/assets/js/28.6b737928.js"><link rel="prefetch" href="/assets/js/29.ebd14054.js"><link rel="prefetch" href="/assets/js/3.d9533589.js"><link rel="prefetch" href="/assets/js/30.ed6ead0e.js"><link rel="prefetch" href="/assets/js/31.89a26765.js"><link rel="prefetch" href="/assets/js/32.9a158243.js"><link rel="prefetch" href="/assets/js/33.a9dfc110.js"><link rel="prefetch" href="/assets/js/34.9740832c.js"><link rel="prefetch" href="/assets/js/35.017688d8.js"><link rel="prefetch" href="/assets/js/36.69f4f9a7.js"><link rel="prefetch" href="/assets/js/37.381f3758.js"><link rel="prefetch" href="/assets/js/38.3f232ff8.js"><link rel="prefetch" href="/assets/js/39.5259c5c3.js"><link rel="prefetch" href="/assets/js/4.73518a0f.js"><link rel="prefetch" href="/assets/js/40.6da9cd20.js"><link rel="prefetch" href="/assets/js/41.5525b2c4.js"><link rel="prefetch" href="/assets/js/42.9f3d0d39.js"><link rel="prefetch" href="/assets/js/43.d6629a36.js"><link rel="prefetch" href="/assets/js/45.bcc663f0.js"><link rel="prefetch" href="/assets/js/46.bf329f04.js"><link rel="prefetch" href="/assets/js/47.bcbfaada.js"><link rel="prefetch" href="/assets/js/48.9c747df7.js"><link rel="prefetch" href="/assets/js/49.4732d3cb.js"><link rel="prefetch" href="/assets/js/5.dd198b3d.js"><link rel="prefetch" href="/assets/js/50.9bff482f.js"><link rel="prefetch" href="/assets/js/51.8c80377e.js"><link rel="prefetch" href="/assets/js/52.37d81e55.js"><link rel="prefetch" href="/assets/js/53.88841637.js"><link rel="prefetch" href="/assets/js/54.1a887e66.js"><link rel="prefetch" href="/assets/js/55.3c3f2203.js"><link rel="prefetch" href="/assets/js/56.590fc579.js"><link rel="prefetch" href="/assets/js/57.a2182867.js"><link rel="prefetch" href="/assets/js/58.28ea8ba4.js"><link rel="prefetch" href="/assets/js/59.d771376d.js"><link rel="prefetch" href="/assets/js/6.0b558b79.js"><link rel="prefetch" href="/assets/js/8.0ec7f6e8.js"><link rel="prefetch" href="/assets/js/9.6e274fca.js">
    <link rel="stylesheet" href="/assets/css/0.styles.bc6beed4.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="чЫох╜Х" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Echo ч│╗ч╗Яшо╛шобф╣Лч╛О" class="logo"> <span class="site-name can-hide">Echo ч│╗ч╗Яшо╛шобф╣Лч╛О</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">ЁЯПащжЦщб╡</a></div><div class="nav-item"><a href="/pages/fccd91/" class="nav-link">тЬТя╕ПчГнщЧичоЧц│Х</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕" class="dropdown-title"><!----> <span class="title" style="display:;">ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/252196/" class="nav-link">Redis ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/pages/b9733b/" class="nav-link">Kafka ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/pages/4601ca/" class="nav-link">Nginx ч│╗ч╗Яшо╛шоб</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ЁЯзСтАНЁЯТ╗хоЮцИШч│╗ч╗Яшо╛шоб" class="dropdown-title"><!----> <span class="title" style="display:;">ЁЯзСтАНЁЯТ╗хоЮцИШч│╗ч╗Яшо╛шоб</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/84cb49/" class="nav-link">шо╛шобхЯ║чбАшо╛цЦ╜</a></li><li class="dropdown-item"><!----> <a href="/pages/a95d7d/" class="nav-link">шо╛шобчГнщЧих║ФчФи</a></li><li class="dropdown-item"><!----> <a href="/pages/def08a/" class="nav-link">хЬ║цЩпшо╛шоб</a></li></ul></div></div><div class="nav-item"><a href="/pages/92b2ee/" class="nav-link">тЭУщЧочнФ</a></div><div class="nav-item"><a href="/pages/52ebd8/" class="nav-link">ЁЯСАхКицАБ</a></div> <a href="https://github.com/echo-lxy/echo-system-design" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">ЁЯПащжЦщб╡</a></div><div class="nav-item"><a href="/pages/fccd91/" class="nav-link">тЬТя╕ПчГнщЧичоЧц│Х</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕" class="dropdown-title"><!----> <span class="title" style="display:;">ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/252196/" class="nav-link">Redis ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/pages/b9733b/" class="nav-link">Kafka ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/pages/4601ca/" class="nav-link">Nginx ч│╗ч╗Яшо╛шоб</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ЁЯзСтАНЁЯТ╗хоЮцИШч│╗ч╗Яшо╛шоб" class="dropdown-title"><!----> <span class="title" style="display:;">ЁЯзСтАНЁЯТ╗хоЮцИШч│╗ч╗Яшо╛шоб</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/84cb49/" class="nav-link">шо╛шобхЯ║чбАшо╛цЦ╜</a></li><li class="dropdown-item"><!----> <a href="/pages/a95d7d/" class="nav-link">шо╛шобчГнщЧих║ФчФи</a></li><li class="dropdown-item"><!----> <a href="/pages/def08a/" class="nav-link">хЬ║цЩпшо╛шоб</a></li></ul></div></div><div class="nav-item"><a href="/pages/92b2ee/" class="nav-link">тЭУщЧочнФ</a></div><div class="nav-item"><a href="/pages/52ebd8/" class="nav-link">ЁЯСАхКицАБ</a></div> <a href="https://github.com/echo-lxy/echo-system-design" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>цМЗхНЧ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>хЯ║чбА</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>ф╕╗ч║┐</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/34fa27/" aria-current="page" class="active sidebar-link">Linux ф╕нчЪД IO хдЪш╖пхдНчФи</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/34fa27/#хЙНшиА" class="sidebar-link">хЙНшиА</a></li><li class="sidebar-sub-header level2"><a href="/pages/34fa27/#linux-хжВф╜ХхоЮчО░-io-хдЪш╖пхдНчФи" class="sidebar-link">Linux хжВф╜ХхоЮчО░ IO хдЪш╖пхдНчФи</a></li><li class="sidebar-sub-header level2"><a href="/pages/34fa27/#цА╗ч╗У" class="sidebar-link">цА╗ч╗У</a></li></ul></li><li><a href="/pages/d4ecb9/" class="sidebar-link">Redis Server хИЭхзЛхМЦ</a></li><li><a href="/pages/d6b00d/" class="sidebar-link">Redis чЪД Reactor цибхЮЛ</a></li><li><a href="/pages/264b06/" class="sidebar-link">ц╖▒хЕе Redis ф║Лф╗╢щй▒хКицбЖцЮ╢</a></li><li><a href="/pages/e6d8ef/" class="sidebar-link">Redis чЪДцЙзшбМцибх╝П</a></li><li><a href="/pages/b4aed2/" class="sidebar-link">чоАш┐░ Redis хдЪч║┐чиЛ IO</a></li><li><a href="/pages/030696/" class="sidebar-link">ц╖▒хЕе Redis чЪДхдЪIOч║┐чиЛ</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>цФпч║┐</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>щЫЖч╛д</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="щжЦщб╡" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>Redis ч│╗ч╗Яшо╛шоб</span></li><li data-v-06225672><span data-v-06225672>ф╕╗ч║┐</span></li></ul> <div class="info" data-v-06225672><div title="ф╜ЬшАЕ" class="author iconfont icon-touxiang" data-v-06225672><a href="https://gitee.com/brother-one" target="_blank" title="ф╜ЬшАЕ" class="beLink" data-v-06225672>echo</a></div> <div title="хИЫх╗║цЧ╢щЧ┤" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-09-15</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">чЫох╜Х</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">Linux ф╕нчЪД IO хдЪш╖пхдНчФи<!----></h1> <div class="page-slot page-slot-top">
    <div class="wwads-cn wwads-horizontal page-wwads" data-id="136"></div>
    <style>
      .page-wwads{
        width:100%!important;
        min-height: 0;
        margin: 0;
      }
      .page-wwads .wwads-img img{
        width:80px!important;
      }
      .page-wwads .wwads-poweredby{
        width: 40px;
        position: absolute;
        right: 25px;
        bottom: 3px;
      }
      .wwads-content .wwads-text, .page-wwads .wwads-text{
        height: 100%;
        padding-top: 5px;
        display: block;
      }
  </style>
  </div> <div class="theme-vdoing-content content__default"><div class="custom-block note"><p class="custom-block-title">цПРхЗ║щЧощвШцШпф╕АхИЗцЩ║цЕзчЪДх╝Ачлп</p> <ul><li><p>ф╕║ф╗Аф╣И Redis ш┐Щца╖щлШх╣╢хПСчЪДх║ФчФищАЙцЛйф║Ж epollя╝МшАМф╕НцШп select цИЦ pollя╝Я</p></li> <li><p>хЬишо╛шобф╕Аф╕кщлШх╣╢хПСцЬНхКбхЩицЧ╢я╝МхжВф╜ХщАЙцЛйцЬАщАВхРИчЪД IO цибхЮЛя╝Я</p></li> <li><p>х╜УцЬНхКбхЩищЭвхп╣цИРхНГф╕Кф╕ЗчЪДш┐ЮцОецЧ╢я╝Мф╗Аф╣Ица╖чЪДцЬ║хИ╢хПпф╗ешойф╜ащлШцХИчобчРЖш┐Щф║Ыш┐ЮцОея╝Я</p></li> <li><p>щлШх╣╢хПСхЬ║цЩпф╕ня╝Мepoll цШпхжВф╜ХщАЪш┐Зф║Лф╗╢щАЪчЯецЬ║хИ╢щБ┐хЕНцАзшГ╜чУ╢щвИчЪДя╝Я</p></li> <li><p>хдЪш╖пхдНчФицЬ║хИ╢ф╝ЪчЫСхРмхеЧцОехнЧф╕КчЪДхУкф║Ыф║Лф╗╢я╝Я</p></li> <li><p>хдЪш╖пхдНчФицЬ║хИ╢хПпф╗ечЫСхРмхдЪх░Сф╕кхеЧцОехнЧя╝Я</p></li> <li><p>х╜УцЬЙхеЧцОехнЧх░▒ч╗кцЧ╢я╝МхдЪш╖пхдНчФицЬ║хИ╢шжБхжВф╜ХцЙ╛хИ░х░▒ч╗кчЪДхеЧцОехнЧя╝Я</p></li></ul></div> <h2 id="хЙНшиА"><a href="#хЙНшиА" class="header-anchor">#</a> хЙНшиА</h2> <p>Redis ф╜Ьф╕║ф╕Аф╕к Client-Server цЮ╢цЮДчЪДцХ░цНох║Уя╝МхЕ╢ц║РчаБф╕нх░Сф╕Нф║ЖчФицЭехоЮчО░ч╜Сч╗ЬщАЪф┐бчЪДщГихИЖуАВщАЪх╕╕ч│╗ч╗ЯхоЮчО░ч╜Сч╗ЬщАЪф┐бчЪДхЯ║цЬмцЦ╣ц│ХцШп <strong>ф╜┐чФи Socket ч╝ЦчиЛцибхЮЛ</strong>я╝Мф╜ЖцШпя╝МчФ▒ф║ОхЯ║цЬмчЪД Socket ч╝ЦчиЛцибхЮЛцШпхНХч║┐чиЛщШ╗хбЮчЪД ....</p> <p>цЙАф╗ех╜УшжБхдДчРЖ<strong>щлШх╣╢хПС</strong>шп╖ц▒ВцЧ╢я╝МцЬЙф╕дчзНцЦ╣цбИ</p> <ul><li>хдЪч║┐чиЛя╝МшойцпПф╕кч║┐чиЛш┤Яш┤гхдДчРЖф╕Аф╕кховцИ╖члпчЪДшп╖ц▒ВуАВшАМ Redis <strong>ш┤Яш┤гховцИ╖члпшп╖ц▒ВшзгцЮРхТМхдДчРЖчЪДч║┐чиЛхПкцЬЙф╕Аф╕к</strong>я╝МщВгф╣ИхжВцЮЬчЫ┤цОещЗЗчФихЯ║цЬм Socket цибхЮЛя╝Мх░▒ф╝Ъх╜▒хУН Redis цФпцМБщлШх╣╢хПСчЪДховцИ╖члпшо┐щЧоуАВ</li> <li>IO хдЪш╖пхдНчФия╝Мф╕║ф║ЖхоЮчО░щлШх╣╢хПСчЪДч╜Сч╗ЬщАЪф┐бя╝МцИСф╗мх╕╕чФичЪД Linux цУНф╜Ьч│╗ч╗Яя╝Мх░▒цПРф╛Ыф║Ж selectуАБpoll хТМ epoll ф╕ЙчзНч╝ЦчиЛцибхЮЛя╝МшАМхЬи Linux ф╕Кш┐РшбМчЪД Redisя╝МщАЪх╕╕х░▒ф╝ЪщЗЗчФихЕ╢ф╕нчЪД <strong>epoll цибхЮЛ</strong>цЭеш┐ЫшбМч╜Сч╗ЬщАЪф┐буАВ</li></ul> <h3 id="чоАш┐░ф╝ач╗Я-socket-цибхЮЛ"><a href="#чоАш┐░ф╝ач╗Я-socket-цибхЮЛ" class="header-anchor">#</a> чоАш┐░ф╝ач╗Я Socket цибхЮЛ</h3> <p>цИСф╗мчЬЛф╕Лф╜┐чФи Socket цибхЮЛхоЮчО░ч╜Сч╗ЬщАЪф┐бцЧ╢чЪДхЕ│щФоцУНф╜Ья╝Мф╗ецндх╕охКйцИСф╗мхИЖцЮР Socket цибхЮЛф╕нчЪДф╕Нш╢│</p> <p>щжЦхЕИя╝Мх╜УцИСф╗мщЬАшжБшойцЬНхКбхЩичлпхТМховцИ╖члпш┐ЫшбМщАЪф┐бцЧ╢я╝МхПпф╗ехЬицЬНхКбхЩичлпщАЪш┐Зф╗еф╕Лф╕Йцнея╝МцЭехИЫх╗║чЫСхРмховцИ╖члпш┐ЮцОечЪДчЫСхРмхеЧцОехнЧя╝ИListening Socketя╝Йя╝Ъ</p> <ol><li>ш░ГчФи socket хЗ╜цХ░я╝МхИЫх╗║ф╕Аф╕кхеЧцОехнЧуАВцИСф╗мщАЪх╕╕цККш┐Щф╕кхеЧцОехнЧчз░ф╕║ф╕╗хКихеЧцОехнЧя╝ИActive Socketя╝Й</li> <li>ш░ГчФи bind хЗ╜цХ░я╝Мх░Жф╕╗хКихеЧцОехнЧхТМх╜УхЙНцЬНхКбхЩичЪД IP хТМчЫСхРмчлпхПгш┐ЫшбМч╗СхоЪ</li> <li>ш░ГчФи listen хЗ╜цХ░я╝Мх░Жф╕╗хКихеЧцОехнЧш╜мцНвф╕║чЫСхРмхеЧцОехнЧя╝Мх╝АхзЛчЫСхРмховцИ╖члпчЪДш┐ЮцОе</li> <li>ш░ГчФи acceptхЗ╜цХ░я╝МхЬихоМцИРф╕Кш┐░ф╕Йцнеф╣ЛхРОя╝МцЬНхКбхЩичлпх░▒хПпф╗ецОецФ╢ховцИ╖члпчЪДш┐ЮцОешп╖ц▒Вф║ЖуАВф╕║ф║ЖшГ╜хПКцЧ╢хЬ░цФ╢хИ░ховцИ╖члпчЪДш┐ЮцОешп╖ц▒Вя╝МцИСф╗мхПпф╗еш┐РшбМф╕Аф╕кх╛кчОпц╡БчиЛя╝МхЬишпец╡БчиЛф╕нш░ГчФи accept хЗ╜цХ░я╝МчФиф║ОцОецФ╢ховцИ╖члпш┐ЮцОешп╖ц▒В</li> <li>цЬАхРОя╝МцЬНхКбхЩичлпхПпф╗ещАЪш┐Зш░ГчФи recv цИЦ send хЗ╜цХ░я╝МхЬихИЪцЙНш┐ФхЫЮчЪДх╖▓ш┐ЮцОехеЧцОехнЧф╕Кя╝МцОецФ╢х╣╢хдДчРЖшп╗хЖЩшп╖ц▒Вя╝МцИЦцШпх░ЖцХ░цНохПСщАБч╗ЩховцИ╖члп</li></ol> <div class="custom-block warning"><p class="custom-block-title">ц│ицДП</p> <p>accept хЗ╜цХ░цШпщШ╗хбЮхЗ╜цХ░я╝Мф╣Ях░▒цШпшп┤я╝МхжВцЮЬцндцЧ╢ф╕АчЫ┤ц▓бцЬЙховцИ╖члпш┐ЮцОешп╖ц▒Вя╝МщВгф╣Ия╝МцЬНхКбхЩичлпчЪДцЙзшбМц╡БчиЛф╝Ъф╕АчЫ┤щШ╗хбЮхЬи accept хЗ╜цХ░уАВф╕АцЧжцЬЙховцИ╖члпш┐ЮцОешп╖ц▒ВхИ░ш╛╛я╝Мaccept х░Жф╕НхЖНщШ╗хбЮя╝МшАМцШпхдДчРЖш┐ЮцОешп╖ц▒Вя╝МхТМховцИ╖члпх╗║члЛш┐ЮцОея╝Мх╣╢ш┐ФхЫЮх╖▓ш┐ЮцОехеЧцОехнЧя╝ИConnected Socketя╝Й</p></div> <div class="language-Java extra-class"><pre class="language-java"><code>listenSocket <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ш░ГчФиsocketч│╗ч╗Яш░ГчФихИЫх╗║ф╕Аф╕кф╕╗хКихеЧцОехнЧ</span>
<span class="token function">bind</span><span class="token punctuation">(</span>listenSocket<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//ч╗СхоЪхЬ░хЭАхТМчлпхПг</span>
<span class="token function">listen</span><span class="token punctuation">(</span>listenSocket<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//х░Жщ╗ШшодчЪДф╕╗хКихеЧцОехнЧш╜мцНвф╕║цЬНхКбхЩиф╜┐чФичЪДшвлхКихеЧцОехнЧя╝Мф╣Ях░▒цШпчЫСхРмхеЧцОехнЧ</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//х╛кчОпчЫСхРмцШпхРжцЬЙховцИ╖члпш┐ЮцОешп╖ц▒ВхИ░цЭе</span>
   connSocket <span class="token operator">=</span> <span class="token function">accept</span><span class="token punctuation">(</span>listenSocket<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//цОехПЧховцИ╖члпш┐ЮцОе</span>
   <span class="token function">recv</span><span class="token punctuation">(</span>connsocket<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ф╗ОховцИ╖члпшп╗хПЦцХ░цНоя╝МхПкшГ╜хРМцЧ╢хдДчРЖф╕Аф╕кховцИ╖члп</span>
   <span class="token function">send</span><span class="token punctuation">(</span>connsocket<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ч╗ЩховцИ╖члпш┐ФхЫЮцХ░цНоя╝МхПкшГ╜хРМцЧ╢хдДчРЖф╕Аф╕кховцИ╖члп</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ф╜аф╝ЪхПСчО░я╝МшЩ╜чД╢ф╕Кш┐░ф╗гчаБшГ╜хдЯхоЮчО░цЬНхКбхЩичлпхТМховцИ╖члпф╣ЛщЧ┤чЪДщАЪф┐бя╝Мф╜ЖцШпчиЛх║ПцпПш░ГчФиф╕Ацмб accept хЗ╜цХ░я╝М<strong>хПкшГ╜хдДчРЖф╕Аф╕кховцИ╖члпш┐ЮцОе</strong></p> <p>хЫацндя╝МхжВцЮЬцГ│шжБхдДчРЖхдЪф╕кх╣╢хПСховцИ╖члпчЪДшп╖ц▒Вя╝МцИСф╗мх░▒щЬАшжБф╜┐чФи<strong>хдЪч║┐чиЛ</strong>чЪДцЦ╣ц│Хя╝МцЭехдДчРЖщАЪш┐З accept хЗ╜цХ░х╗║члЛчЪДхдЪф╕кховцИ╖члпш┐ЮцОеф╕КчЪДшп╖ц▒В</p> <p>ф╜┐чФиш┐ЩчзНцЦ╣ц│ХхРОя╝МцИСф╗мщЬАшжБхЬи accept хЗ╜цХ░ш┐ФхЫЮх╖▓ш┐ЮцОехеЧцОехнЧхРОя╝МхИЫх╗║ф╕Аф╕кч║┐чиЛя╝Мх╣╢х░Жх╖▓ш┐ЮцОехеЧцОехнЧф╝ащАТч╗ЩхИЫх╗║чЪДч║┐чиЛя╝МчФ▒шпеч║┐чиЛш┤Яш┤гш┐Щф╕кш┐ЮцОехеЧцОехнЧф╕КхРОч╗нчЪДцХ░цНошп╗хЖЩуАВхРМцЧ╢я╝МцЬНхКбхЩичлпчЪДцЙзшбМц╡БчиЛф╝ЪхЖНцмбш░ГчФи accept хЗ╜цХ░я╝МчнЙх╛Еф╕Лф╕Аф╕кховцИ╖члпш┐ЮцОе</p> <p>ф╗еф╕Лч╗ЩхЗ║чЪДчд║ф╛Лф╗гчаБя╝Мх░▒х▒Хчд║ф║Жф╜┐чФихдЪч║┐чиЛцЭецПРхНЗцЬНхКбхЩичлпчЪДх╣╢хПСховцИ╖члпхдДчРЖшГ╜хКЫя╝Ъ</p> <div class="language-Java extra-class"><pre class="language-java"><code>listenSocket <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ш░ГчФиsocketч│╗ч╗Яш░ГчФихИЫх╗║ф╕Аф╕кф╕╗хКихеЧцОехнЧ</span>
<span class="token function">bind</span><span class="token punctuation">(</span>listenSocket<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//ч╗СхоЪхЬ░хЭАхТМчлпхПг</span>
<span class="token function">listen</span><span class="token punctuation">(</span>listenSocket<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//х░Жщ╗ШшодчЪДф╕╗хКихеЧцОехнЧш╜мцНвф╕║цЬНхКбхЩиф╜┐чФичЪДшвлхКихеЧцОехнЧя╝МхН│чЫСхРмхеЧцОехнЧ</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//х╛кчОпчЫСхРмцШпхРжцЬЙховцИ╖члпш┐ЮцОехИ░цЭе</span>
   connSocket <span class="token operator">=</span> <span class="token function">accept</span><span class="token punctuation">(</span>listenSocket<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//цОехПЧховцИ╖члпш┐ЮцОея╝Мш┐ФхЫЮх╖▓ш┐ЮцОехеЧцОехнЧ</span>
   <span class="token function">pthread_create</span><span class="token punctuation">(</span>processData<span class="token punctuation">,</span> connSocket<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//хИЫх╗║цЦ░ч║┐чиЛхп╣х╖▓ш┐ЮцОехеЧцОехнЧш┐ЫшбМхдДчРЖ</span>

<span class="token punctuation">}</span>

<span class="token comment">//хдДчРЖх╖▓ш┐ЮцОехеЧцОехнЧф╕КчЪДшп╗хЖЩшп╖ц▒В</span>
<span class="token function">processData</span><span class="token punctuation">(</span>connSocket<span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token function">recv</span><span class="token punctuation">(</span>connsocket<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ф╗ОховцИ╖члпшп╗хПЦцХ░цНоя╝МхПкшГ╜хРМцЧ╢хдДчРЖф╕Аф╕кховцИ╖члп</span>
   <span class="token function">send</span><span class="token punctuation">(</span>connsocket<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ч╗ЩховцИ╖члпш┐ФхЫЮцХ░цНоя╝МхПкшГ╜хРМцЧ╢хдДчРЖф╕Аф╕кховцИ╖члп</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="х▒ХцЬЫ-io-хдЪш╖пхдНчФи"><a href="#х▒ХцЬЫ-io-хдЪш╖пхдНчФи" class="header-anchor">#</a> х▒ХцЬЫ IO хдЪш╖пхдНчФи</h3> <p>шЩ╜чД╢ф╕Кш┐░цЦ╣ц│ХшГ╜цПРхНЗцЬНхКбхЩичлпчЪДх╣╢хПСхдДчРЖшГ╜хКЫя╝МщБЧцЖ╛чЪДцШп</p> <p><strong>Redis чЪДф╕╗цЙзшбМц╡БчиЛцШпчФ▒ф╕Аф╕кч║┐чиЛхЬицЙзшбМя╝МцЧац│Хф╜┐чФихдЪч║┐чиЛчЪДцЦ╣х╝ПцЭецПРхНЗх╣╢хПСхдДчРЖшГ╜хКЫуАВ</strong></p> <p>цЙАф╗ея╝МшпецЦ╣ц│Ххп╣ Redis х╣╢ф╕Нш╡╖ф╜ЬчФиуАВщВгф╣Ия╝Мш┐ШцЬЙц▓бцЬЙф╗Аф╣ИхЕ╢ф╗ЦцЦ╣ц│Хя╝МшГ╜х╕охКй Redis цПРхНЗх╣╢хПСховцИ╖члпчЪДхдДчРЖшГ╜хКЫхСвя╝Я</p> <p>ш┐Щх░▒шжБчФихИ░цУНф╜Ьч│╗ч╗ЯцПРф╛ЫчЪД <strong>IO хдЪш╖пхдНчФихКЯшГ╜</strong>ф║Ж</p> <p>хЬихЯ║цЬмчЪД Socket ч╝ЦчиЛцибхЮЛф╕ня╝Мaccept хЗ╜цХ░хПкшГ╜хЬиф╕Аф╕кчЫСхРмхеЧцОехнЧф╕КчЫСхРмховцИ╖члпчЪДш┐ЮцОея╝Мrecv хЗ╜цХ░ф╣ЯхПкшГ╜хЬиф╕Аф╕кх╖▓ш┐ЮцОехеЧцОехнЧф╕Кя╝МчнЙх╛ЕховцИ╖члпхПСщАБчЪДшп╖ц▒ВуАВ</p> <p>шАМ IO хдЪш╖пхдНчФицЬ║хИ╢я╝МхПпф╗ешойчиЛх║ПщАЪш┐Зш░ГчФихдЪш╖пхдНчФихЗ╜цХ░я╝МхРМцЧ╢чЫСхРмхдЪф╕кхеЧцОехнЧф╕КчЪДшп╖ц▒ВуАВш┐ЩщЗМцЧвхПпф╗ехМЕцЛмчЫСхРмхеЧцОехнЧф╕КчЪДш┐ЮцОешп╖ц▒Вя╝Мф╣ЯхПпф╗ехМЕцЛмх╖▓ш┐ЮцОехеЧцОехнЧф╕КчЪДшп╗хЖЩшп╖ц▒ВуАВш┐Щца╖х╜УцЬЙф╕Аф╕кцИЦхдЪф╕кхеЧцОехнЧф╕КцЬЙшп╖ц▒ВцЧ╢я╝МхдЪш╖пхдНчФихЗ╜цХ░х░▒ф╝Ъш┐ФхЫЮуАВцндцЧ╢я╝МчиЛх║Пх░▒хПпф╗ехдДчРЖш┐Щф║Ых░▒ч╗кхеЧцОехнЧф╕КчЪДшп╖ц▒Вя╝МцпФхжВшп╗хПЦх░▒ч╗кчЪДх╖▓ш┐ЮцОехеЧцОехнЧф╕КчЪДшп╖ц▒ВхЖЕхо╣уАВ</p> <p>хЫаф╕║ Linux цУНф╜Ьч│╗ч╗ЯхЬихоЮщЩЕх║ФчФиф╕нцпФш╛Гх╣┐ц│Ыя╝МцЙАф╗ешо▓шзг Linux ф╕КчЪД IO хдЪш╖пхдНчФицЬ║хИ╢уАВ</p> <p>Linux цПРф╛ЫчЪД IO хдЪш╖пхдНчФицЬ║хИ╢ф╕╗шжБцЬЙф╕ЙчзНя╝МхИЖхИлцШп</p> <ul><li>select</li> <li>poll</li> <li>epoll</li></ul> <p>ф╕ЛщЭвя╝МцИСф╗мх░▒хИЖхИлцЭехнжф╣аф╕Лш┐Щф╕ЙчзНцЬ║хИ╢чЪДхоЮчО░цАЭш╖пхТМф╜┐чФицЦ╣ц│ХуАВчД╢хРОя╝МцИСф╗мхЖНцЭечЬЛчЬЛя╝Мф╕║ф╗Аф╣И Redis щАЪх╕╕цШпщАЙцЛйф╜┐чФи epoll ш┐ЩчзНцЬ║хИ╢цЭехоЮчО░ч╜Сч╗ЬщАЪф┐б</p> <h2 id="linux-хжВф╜ХхоЮчО░-io-хдЪш╖пхдНчФи"><a href="#linux-хжВф╜ХхоЮчО░-io-хдЪш╖пхдНчФи" class="header-anchor">#</a> Linux хжВф╜ХхоЮчО░ IO хдЪш╖пхдНчФи</h2> <h3 id="select-цЬ║хИ╢-хдЪш╖пхдНчФичЪДхЯ║цЬмхоЮчО░"><a href="#select-цЬ║хИ╢-хдЪш╖пхдНчФичЪДхЯ║цЬмхоЮчО░" class="header-anchor">#</a> select цЬ║хИ╢я╝ЪхдЪш╖пхдНчФичЪДхЯ║цЬмхоЮчО░</h3> <p>select цЬ║хИ╢ф╕нчЪДф╕Аф╕кщЗНшжБхЗ╜цХ░х░▒цШп <strong>select хЗ╜цХ░</strong></p> <p>хп╣ф║О select хЗ╜цХ░цЭешп┤я╝МхоГчЪДхПВцХ░хМЕцЛм</p> <ul><li>чЫСхРмчЪДцЦЗф╗╢цППш┐░чмжцХ░щЗП<code>__nfds</code></li> <li>швлчЫСхРмцППш┐░чмжчЪДф╕Йф╕кщЫЖхРИ<code>*__readfds</code>уАБ<code>*__writefds</code>хТМ<code>*__exceptfds</code></li> <li>чЫСхРмцЧ╢щШ╗хбЮчнЙх╛ЕчЪДш╢ЕцЧ╢цЧ╢щХ┐<code>*__timeout</code></li></ul> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">select</span> <span class="token punctuation">(</span><span class="token keyword">int</span> __nfds<span class="token punctuation">,</span> fd_set <span class="token operator">*</span>__readfds<span class="token punctuation">,</span> fd_set <span class="token operator">*</span>__writefds<span class="token punctuation">,</span> fd_set <span class="token operator">*</span>__exceptfds<span class="token punctuation">,</span> <span class="token keyword">struct</span> <span class="token class-name">timeval</span> <span class="token operator">*</span>__timeout<span class="token punctuation">)</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">ц│ицДП</p> <p>Linux щТИхп╣цпПф╕Аф╕кхеЧцОехнЧщГ╜ф╝ЪцЬЙф╕Аф╕кцЦЗф╗╢цППш┐░чмжя╝Мф╣Ях░▒цШпф╕Аф╕кщЭЮш┤ЯцХ┤цХ░я╝МчФицЭехФпф╕АцаЗшпЖшпехеЧцОехнЧя╝М<strong>хЬихдЪш╖пхдНчФицЬ║хИ╢чЪДхЗ╜цХ░ф╕ня╝МLinux щАЪх╕╕ф╝ЪчФицЦЗф╗╢цППш┐░чмжф╜Ьф╕║хПВцХ░</strong>уАВцЬЙф║ЖцЦЗф╗╢цППш┐░чмжя╝МхЗ╜цХ░ф╣Ях░▒шГ╜цЙ╛хИ░хп╣х║ФчЪДхеЧцОехнЧя╝Мш┐ЫшАМш┐ЫшбМчЫСхРмуАБшп╗хЖЩчнЙцУНф╜Ь</p></div> <p>select хЗ╜цХ░чЪДхПВцХ░<code>__readfds</code>уАБ<code>__writefds</code>хТМ<code>__exceptfds</code>шбичд║чЪДцШпя╝МшвлчЫСхРмцППш┐░чмжчЪДщЫЖхРИя╝МхЕ╢хоЮх░▒цШпшвлчЫСхРмхеЧцОехнЧчЪДщЫЖхРИуАВщВгф╣Ия╝М<strong>ф╕║ф╗Аф╣Иф╝ЪцЬЙф╕Йф╕кщЫЖхРИхСвя╝Я</strong></p> <p>ш┐Щх░▒хТМцИСхИЪцЙНцПРхЗ║чЪДчммф╕Аф╕кщЧощвШчЫ╕хЕ│я╝Мф╣Ях░▒цШп<strong>хдЪш╖пхдНчФицЬ║хИ╢ф╝ЪчЫСхРмхУкф║Ыф║Лф╗╢</strong>уАВselect хЗ╜цХ░ф╜┐чФиф╕Йф╕кщЫЖхРИя╝Мшбичд║чЫСхРмчЪДф╕Йч▒╗ф║Лф╗╢я╝МхИЖхИлцШп</p> <ul><li>шп╗цХ░цНоф║Лф╗╢я╝Ихп╣х║Ф<code>__readfds</code>щЫЖхРИя╝Й</li> <li>хЖЩцХ░цНоф║Лф╗╢я╝Ихп╣х║Ф<code>__writefds</code>щЫЖхРИя╝Й</li> <li>х╝Вх╕╕ф║Лф╗╢я╝Ихп╣х║Ф<code>__exceptfds</code>щЫЖхРИя╝Й</li></ul> <p>цИСф╗мш┐Ыф╕АцнехПпф╗ечЬЛхИ░я╝МхПВцХ░ <strong>readfdsуАБwritefds хТМ exceptfds</strong> чЪДч▒╗хЮЛцШп fd_set ч╗УцЮДф╜Уя╝МхоГф╕╗шжБхоЪф╣ЙщГихИЖхжВф╕ЛцЙАчд║уАВхЕ╢ф╕ня╝М<code>__fd_mask</code>ч▒╗хЮЛцШп long int ч▒╗хЮЛчЪДхИлхРНя╝М<strong>FD_SETSIZE хТМ</strong>NFDBITS ш┐Щф╕дф╕кхоПхоЪф╣ЙчЪДхдзх░Пщ╗Шшодф╕║ 1024 хТМ 32</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span>
   тАж
   __fd_mask  __fds_bits<span class="token punctuation">[</span>__FD_SETSIZE <span class="token operator">/</span> __NFDBITS<span class="token punctuation">]</span><span class="token punctuation">;</span>
   тАж
<span class="token punctuation">}</span> fd_set
</code></pre></div><p>цЙАф╗ея╝Мfd_set ч╗УцЮДф╜УчЪДхоЪф╣Йя╝МхЕ╢хоЮх░▒цШпф╕Аф╕к long int ч▒╗хЮЛчЪДцХ░ч╗Дя╝МшпецХ░ч╗Дф╕нф╕АхЕ▒цЬЙ 32 ф╕кхЕГч┤ая╝И1024/32=32я╝Йя╝МцпПф╕кхЕГч┤ацШп 32 ф╜Ня╝Иlong int ч▒╗хЮЛчЪДхдзх░Пя╝Йя╝МшАМцпПф╕Аф╜НхПпф╗ечФицЭешбичд║ф╕Аф╕кцЦЗф╗╢цППш┐░чмжчЪДчК╢цАБ</p> <p>хе╜ф║Жя╝Мф║Жшзгф║Ж fd_set ч╗УцЮДф╜УчЪДхоЪф╣Йя╝МцИСф╗мх░▒хПпф╗ехЫЮчнФхИЪцЙНцПРхЗ║чЪДчммф║Мф╕кщЧощвШф║ЖуАВ<strong>select хЗ╜цХ░хп╣цпПф╕Аф╕кцППш┐░чмжщЫЖхРИя╝МщГ╜хПпф╗ечЫСхРм 1024 ф╕кцППш┐░чмж</strong>уАВ</p> <p>цОеф╕ЛцЭея╝МцИСф╗мхЖНцЭеф║Жшзгф╕Л <strong>хжВф╜Хф╜┐чФи select цЬ║хИ╢цЭехоЮчО░ч╜Сч╗ЬщАЪф┐б</strong>уАВ</p> <ol><li>щжЦхЕИя╝МцИСф╗м<strong>хЬиш░ГчФи select хЗ╜цХ░хЙНя╝МхПпф╗ехЕИхИЫх╗║хе╜ф╝ащАТч╗Щ select хЗ╜цХ░чЪДцППш┐░чмжщЫЖхРИя╝МчД╢хРОхЖНхИЫх╗║чЫСхРмхеЧцОехнЧ</strong>уАВшАМф╕║ф║ЖшойхИЫх╗║чЪДчЫСхРмхеЧцОехнЧшГ╜швл select хЗ╜цХ░чЫСцОзя╝МцИСф╗мщЬАшжБцККш┐Щф╕кхеЧцОехнЧчЪДцППш┐░чмжхКахЕехИ░хИЫх╗║хе╜чЪДцППш┐░чмжщЫЖхРИф╕нуАВ</li> <li>чД╢хРОя╝МцИСф╗мх░▒хПпф╗е<strong>ш░ГчФи select хЗ╜цХ░я╝Мх╣╢цККхИЫх╗║хе╜чЪДцППш┐░чмжщЫЖхРИф╜Ьф╕║хПВцХ░ф╝ащАТч╗Щ select хЗ╜цХ░</strong>уАВчиЛх║ПхЬиш░ГчФи select хЗ╜цХ░хРОя╝Мф╝ЪхПСчФЯ<strong>щШ╗хбЮ</strong>уАВшАМх╜У select хЗ╜цХ░цгАц╡ЛхИ░цЬЙцППш┐░чмж<strong>х░▒ч╗к</strong>хРОя╝Мх░▒ф╝Ъ<strong>ч╗УцЭЯщШ╗хбЮ</strong>я╝Мх╣╢ш┐ФхЫЮх░▒ч╗кчЪДцЦЗф╗╢цППш┐░чмжф╕кцХ░уАВ</li> <li>цндцЧ╢я╝МцИСф╗мх░▒хПпф╗ехЬицППш┐░чмжщЫЖхРИф╕нцЯецЙ╛хУкф║ЫцППш┐░чмжх░▒ч╗кф║ЖуАВчД╢хРОя╝МцИСф╗мхп╣х╖▓х░▒ч╗кцППш┐░чмжхп╣х║ФчЪДхеЧцОехнЧш┐ЫшбМхдДчРЖуАВцпФхжВя╝МхжВцЮЬцШп__readfds щЫЖхРИф╕нцЬЙцППш┐░чмжх░▒ч╗кя╝Мш┐Щх░▒шбицШОш┐Щф║Ых░▒ч╗кцППш┐░чмжхп╣х║ФчЪДхеЧцОехнЧф╕Кя╝МцЬЙшп╗ф║Лф╗╢хПСчФЯя╝МцндцЧ╢я╝МцИСф╗мх░▒хЬишпехеЧцОехнЧф╕Кшп╗хПЦцХ░цНо</li></ol> <p>шАМхЫаф╕║ select хЗ╜цХ░ф╕АцмбхПпф╗ечЫСхРм 1024 ф╕кцЦЗф╗╢цППш┐░чмжчЪДчК╢цАБя╝МцЙАф╗е select хЗ╜цХ░хЬиш┐ФхЫЮцЧ╢я╝Мф╣ЯхПпшГ╜ф╝Ъф╕Ацмбш┐ФхЫЮхдЪф╕кх░▒ч╗кчЪДцЦЗф╗╢цППш┐░чмжуАВш┐Щца╖ф╕АцЭея╝МцИСф╗мх░▒хПпф╗еф╜┐чФиф╕Аф╕кх╛кчОпц╡БчиЛя╝Мф╛Эцмбхп╣х░▒ч╗кцППш┐░чмжхп╣х║ФчЪДхеЧцОехнЧш┐ЫшбМшп╗хЖЩцИЦх╝Вх╕╕хдДчРЖцУНф╜ЬуАВ</p> <p><img src="https://echo798.oss-cn-shenzhen.aliyuncs.com/img/202409171344187.png" alt="image-20240917134414085"></p> <p>ф╕ЛщЭвчЪДф╗гчаБх▒Хчд║чЪДцШпф╜┐чФи select хЗ╜цХ░я╝Мш┐ЫшбМх╣╢хПСховцИ╖члпхдДчРЖчЪДхЕ│щФоцнещкдхТМф╕╗шжБхЗ╜цХ░ш░ГчФия╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> sock_fd<span class="token punctuation">,</span>conn_fd<span class="token punctuation">;</span> <span class="token comment">//чЫСхРмхеЧцОехнЧхТМх╖▓ш┐ЮцОехеЧцОехнЧчЪДхПШщЗП</span>
sock_fd <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//хИЫх╗║хеЧцОехнЧ</span>
<span class="token function">bind</span><span class="token punctuation">(</span>sock_fd<span class="token punctuation">)</span>   <span class="token comment">//ч╗СхоЪхеЧцОехнЧ</span>
<span class="token function">listen</span><span class="token punctuation">(</span>sock_fd<span class="token punctuation">)</span> <span class="token comment">//хЬихеЧцОехнЧф╕Кш┐ЫшбМчЫСхРмя╝Мх░ЖхеЧцОехнЧш╜мф╕║чЫСхРмхеЧцОехнЧ</span>

fd_set rset<span class="token punctuation">;</span>  <span class="token comment">//швлчЫСхРмчЪДцППш┐░чмжщЫЖхРИя╝МхЕ│ц│ицППш┐░чмжф╕КчЪДшп╗ф║Лф╗╢</span>

<span class="token keyword">int</span> max_fd <span class="token operator">=</span> sock_fd

<span class="token comment">//хИЭхзЛхМЦrsetцХ░ч╗Дя╝Мф╜┐чФиFD_ZEROхоПшо╛ч╜оцпПф╕кхЕГч┤аф╕║0</span>
<span class="token function">FD_ZERO</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>rset<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//ф╜┐чФиFD_SETхоПшо╛ч╜оrsetцХ░ч╗Дф╕нф╜Нч╜оф╕║sock_fdчЪДцЦЗф╗╢цППш┐░чмжф╕║1я╝Мшбичд║щЬАшжБчЫСхРмшпецЦЗф╗╢цППш┐░чмж</span>
<span class="token function">FD_SET</span><span class="token punctuation">(</span>sock_fd<span class="token punctuation">,</span><span class="token operator">&amp;</span>rset<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//шо╛ч╜ош╢ЕцЧ╢цЧ╢щЧ┤</span>
<span class="token keyword">struct</span> <span class="token class-name">timeval</span> timeout<span class="token punctuation">;</span>
timeout<span class="token punctuation">.</span>tv_sec <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
timeout<span class="token punctuation">.</span>tv_usec <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//ш░ГчФиselectхЗ╜цХ░я╝МцгАц╡ЛrsetцХ░ч╗Дф┐ЭхнШчЪДцЦЗф╗╢цППш┐░чмжцШпхРжх╖▓цЬЙшп╗ф║Лф╗╢х░▒ч╗кя╝Мш┐ФхЫЮх░▒ч╗кчЪДцЦЗф╗╢цППш┐░чмжф╕кцХ░</span>
   n <span class="token operator">=</span> <span class="token function">select</span><span class="token punctuation">(</span>max_fd<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>rset<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token comment">//ш░ГчФиFD_ISSETхоПя╝МхЬиrsetцХ░ч╗Дф╕нцгАц╡Лsock_fdхп╣х║ФчЪДцЦЗф╗╢цППш┐░чмжцШпхРжх░▒ч╗к</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">FD_ISSET</span><span class="token punctuation">(</span>sock_fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rset<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment">//хжВцЮЬsock_fdх╖▓ч╗Пх░▒ч╗кя╝МшбицШОх╖▓цЬЙховцИ╖члпш┐ЮцОея╝Ыш░ГчФиacceptхЗ╜цХ░х╗║члЛш┐ЮцОе</span>
       conn_fd <span class="token operator">=</span> <span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">//шо╛ч╜оrsetцХ░ч╗Дф╕нф╜Нч╜оф╕║conn_fdчЪДцЦЗф╗╢цППш┐░чмжф╕║1я╝Мшбичд║щЬАшжБчЫСхРмшпецЦЗф╗╢цППш┐░чмж</span>
       <span class="token function">FD_SET</span><span class="token punctuation">(</span>conn_fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rset<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token comment">//ф╛ЭцмбцгАцЯех╖▓ш┐ЮцОехеЧцОехнЧчЪДцЦЗф╗╢цППш┐░чмж</span>
   <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> maxfd<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//ш░ГчФиFD_ISSETхоПя╝МхЬиrsetцХ░ч╗Дф╕нцгАц╡ЛцЦЗф╗╢цППш┐░чмжцШпхРжх░▒ч╗к</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">FD_ISSET</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rset<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token comment">//цЬЙцХ░цНохПпшп╗я╝Мш┐ЫшбМшп╗цХ░цНохдДчРЖ</span>
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ф╕Нш┐Зя╝Мф╜ацИЦшо╕ф╝ЪхПСчО░ select хЗ╜цХ░хнШхЬи <strong>ф╕дф╕кшо╛шобф╕КчЪДф╕Нш╢│</strong>я╝Ъ</p> <ul><li>select хЗ╜цХ░хп╣хНХф╕кш┐ЫчиЛшГ╜чЫСхРмчЪДцЦЗф╗╢цППш┐░чмжцХ░щЗПцШп<strong>цЬЙщЩРхИ╢</strong>чЪДя╝МхоГшГ╜чЫСхРмчЪДцЦЗф╗╢цППш┐░чмжф╕кцХ░чФ▒__FD_SETSIZE хЖ│хоЪя╝Мщ╗ШшодхА╝цШп 1024уАВ</li> <li>х╜У select хЗ╜цХ░ш┐ФхЫЮхРОя╝МцИСф╗мщЬАшжБ<strong>щБНхОЖ</strong>цППш┐░чмжщЫЖхРИя╝МцЙНшГ╜цЙ╛хИ░хЕ╖ф╜УцШпхУкф║ЫцППш┐░чмжх░▒ч╗кф║ЖуАВш┐Щф╕кщБНхОЖш┐ЗчиЛф╝Ъф║зчФЯф╕АхоЪх╝АщФАя╝Мф╗ОшАМщЩНф╜ОчиЛх║ПчЪДцАзшГ╜уАВ</li></ul> <p>цЙАф╗ея╝Мф╕║ф║ЖшзгхЖ│ select хЗ╜цХ░хПЧщЩРф║О 1024 ф╕кцЦЗф╗╢цППш┐░чмжчЪДф╕Нш╢│я╝Мpoll хЗ╜цХ░хп╣цндхБЪф║ЖцФ╣ш┐Ы</p> <h3 id="poll-цЬ║хИ╢-ф╕НхПЧщЩРчЪДцЦЗф╗╢цППш┐░чмжцХ░щЗП"><a href="#poll-цЬ║хИ╢-ф╕НхПЧщЩРчЪДцЦЗф╗╢цППш┐░чмжцХ░щЗП" class="header-anchor">#</a> poll цЬ║хИ╢я╝Ъф╕НхПЧщЩРчЪДцЦЗф╗╢цППш┐░чмжцХ░щЗП</h3> <p>poll цЬ║хИ╢чЪДф╕╗шжБхЗ╜цХ░цШп poll хЗ╜цХ░я╝МцИСф╗мхЕИцЭечЬЛф╕ЛхоГчЪДхОЯхЮЛхоЪф╣Йя╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">poll</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">pollfd</span> <span class="token operator">*</span>__fds<span class="token punctuation">,</span> <span class="token class-name">nfds_t</span> __nfds<span class="token punctuation">,</span> <span class="token keyword">int</span> __timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>хЕ╢ф╕ня╝МхПВцХ░ fds цШп pollfd ч╗УцЮДф╜УцХ░ч╗Дя╝МхПВцХ░ nfds шбичд║чЪДцШп fds цХ░ч╗ДчЪДхЕГч┤аф╕кцХ░я╝МшАМtimeout шбичд║ poll хЗ╜цХ░щШ╗хбЮчЪДш╢ЕцЧ╢цЧ╢щЧ┤уАВ</p> <p>pollfd ч╗УцЮДф╜УщЗМхМЕхРлф║ЖшжБчЫСхРмчЪДцППш┐░чмжя╝Мф╗ехПКшпецППш┐░чмжф╕КшжБчЫСхРмчЪДф║Лф╗╢ч▒╗хЮЛуАВш┐Щф╕кцИСф╗мхПпф╗еф╗О pollfd ч╗УцЮДф╜УчЪДхоЪф╣Йф╕нчЬЛхЗ║цЭея╝МхжВф╕ЛцЙАчд║уАВpollfd ч╗УцЮДф╜Уф╕нхМЕхРлф║Жф╕Йф╕кцИРхСШхПШщЗП fdуАБevents хТМ reventsя╝МхИЖхИлшбичд║шжБчЫСхРмчЪДцЦЗф╗╢цППш┐░чмжуАБшжБчЫСхРмчЪДф║Лф╗╢ч▒╗хЮЛхТМхоЮщЩЕхПСчФЯчЪДф║Лф╗╢ч▒╗хЮЛуАВ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">pollfd</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> fd<span class="token punctuation">;</span>         <span class="token comment">//ш┐ЫшбМчЫСхРмчЪДцЦЗф╗╢цППш┐░чмж</span>
    <span class="token keyword">short</span> <span class="token keyword">int</span> events<span class="token punctuation">;</span>       <span class="token comment">//шжБчЫСхРмчЪДф║Лф╗╢ч▒╗хЮЛ</span>
    <span class="token keyword">short</span> <span class="token keyword">int</span> revents<span class="token punctuation">;</span>      <span class="token comment">//хоЮщЩЕхПСчФЯчЪДф║Лф╗╢ч▒╗хЮЛ</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>pollfd ч╗УцЮДф╜Уф╕ншжБчЫСхРмхТМхоЮщЩЕхПСчФЯчЪДф║Лф╗╢ч▒╗хЮЛя╝МцШпщАЪш┐Зф╗еф╕Лф╕Йф╕кхоПхоЪф╣ЙцЭешбичд║чЪДя╝МхИЖхИлцШп POLLRDNORMуАБPOLLWRNORM хТМ POLLERRя╝МхоГф╗мхИЖхИлшбичд║хПпшп╗уАБхПпхЖЩхТМщФЩшппф║Лф╗╢уАВ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">POLLRDNORM</span>  <span class="token expression"><span class="token number">0x040</span>       </span><span class="token comment">//хПпшп╗ф║Лф╗╢</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">POLLWRNORM</span>  <span class="token expression"><span class="token number">0x100</span>       </span><span class="token comment">//хПпхЖЩф║Лф╗╢</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">POLLERR</span>     <span class="token expression"><span class="token number">0x008</span>       </span><span class="token comment">//щФЩшппф║Лф╗╢</span></span>
</code></pre></div><p>хе╜ф║Жя╝Мф║Жшзгф║Ж poll хЗ╜цХ░чЪДхПВцХ░хРОя╝МцИСф╗мцЭечЬЛф╕ЛхжВф╜Хф╜┐чФи poll хЗ╜цХ░хоМцИРч╜Сч╗ЬщАЪф┐буАВш┐Щф╕кц╡БчиЛф╕╗шжБхПпф╗ехИЖцИРф╕Йцнея╝Ъ</p> <ol><li>хИЫх╗║ pollfd цХ░ч╗ДхТМчЫСхРмхеЧцОехнЧя╝Мх╣╢ш┐ЫшбМч╗СхоЪя╝Ы</li> <li>х░ЖчЫСхРмхеЧцОехнЧхКахЕе pollfd цХ░ч╗Дя╝Мх╣╢шо╛ч╜охЕ╢чЫСхРмшп╗ф║Лф╗╢я╝Мф╣Ях░▒цШпховцИ╖члпчЪДш┐ЮцОешп╖ц▒Вя╝Ы</li> <li>х╛кчОпш░ГчФи poll хЗ╜цХ░я╝МцгАц╡Л pollfd цХ░ч╗Дф╕нцШпхРжцЬЙх░▒ч╗кчЪДцЦЗф╗╢цППш┐░чмжуАВ</li></ol> <p>шАМхЬичммф╕ЙцнечЪДх╛кчОпш┐ЗчиЛф╕ня╝МхЕ╢хдДчРЖщА╗ш╛СхПИхИЖцИРф║Жф╕дчзНцГЕхЖ╡я╝Ъ</p> <ul><li>хжВцЮЬцШпш┐ЮцОехеЧцОехнЧх░▒ч╗кя╝Мш┐ЩшбицШОцШпцЬЙховцИ╖члпш┐ЮцОея╝МцИСф╗мхПпф╗еш░ГчФи accept цОехПЧш┐ЮцОея╝Мх╣╢хИЫх╗║х╖▓ш┐ЮцОехеЧцОехнЧя╝Мх╣╢х░ЖхЕ╢хКахЕе pollfd цХ░ч╗Дя╝Мх╣╢чЫСхРмшп╗ф║Лф╗╢я╝Ы</li> <li>хжВцЮЬцШпх╖▓ш┐ЮцОехеЧцОехнЧх░▒ч╗кя╝Мш┐ЩшбицШОховцИ╖члпцЬЙшп╗хЖЩшп╖ц▒Вя╝МцИСф╗мхПпф╗еш░ГчФи recv/send хЗ╜цХ░хдДчРЖшп╗хЖЩшп╖ц▒ВуАВ</li></ul> <p>цИСчФ╗ф║Жф╕ЛщЭвш┐Щх╝ахЫ╛я╝Мх▒Хчд║ф║Жф╜┐чФи poll хЗ╜цХ░чЪДц╡БчиЛя╝Мф╜ахПпф╗ехнжф╣ацОМцПбф╕ЛуАВ</p> <p><img src="https://echo798.oss-cn-shenzhen.aliyuncs.com/img/202409171348928.png" alt="image-20240917134801867"></p> <p>хПжхдЦя╝Мф╕║ф║Жф╛┐ф║Оф╜ацОМцПбхЬиф╗гчаБф╕нф╜┐чФи poll хЗ╜цХ░я╝МцИСф╣ЯхЖЩф║Жф╕Аф╗╜чд║ф╛Лф╗гчаБя╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> sock_fd<span class="token punctuation">,</span>conn_fd<span class="token punctuation">;</span> <span class="token comment">//чЫСхРмхеЧцОехнЧхТМх╖▓ш┐ЮцОехеЧцОехнЧчЪДхПШщЗП</span>
sock_fd <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//хИЫх╗║хеЧцОехнЧ</span>
<span class="token function">bind</span><span class="token punctuation">(</span>sock_fd<span class="token punctuation">)</span>   <span class="token comment">//ч╗СхоЪхеЧцОехнЧ</span>
<span class="token function">listen</span><span class="token punctuation">(</span>sock_fd<span class="token punctuation">)</span> <span class="token comment">//хЬихеЧцОехнЧф╕Кш┐ЫшбМчЫСхРмя╝Мх░ЖхеЧцОехнЧш╜мф╕║чЫСхРмхеЧцОехнЧ</span>

<span class="token comment">//pollхЗ╜цХ░хПпф╗ечЫСхРмчЪДцЦЗф╗╢цППш┐░чмжцХ░щЗПя╝МхПпф╗ехдзф║О1024</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAX_OPEN</span> <span class="token expression"><span class="token operator">=</span> <span class="token number">2048</span></span></span>

<span class="token comment">//pollfdч╗УцЮДф╜УцХ░ч╗Дя╝Мхп╣х║ФцЦЗф╗╢цППш┐░чмж</span>
<span class="token keyword">struct</span> <span class="token class-name">pollfd</span> client<span class="token punctuation">[</span>MAX_OPEN<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//х░ЖхИЫх╗║чЪДчЫСхРмхеЧцОехнЧхКахЕеpollfdцХ░ч╗Дя╝Мх╣╢чЫСхРмхЕ╢хПпшп╗ф║Лф╗╢</span>
client<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">=</span> sock_fd<span class="token punctuation">;</span>
client<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">=</span> POLLRDNORM<span class="token punctuation">;</span>
maxfd <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">//хИЭхзЛхМЦclientцХ░ч╗ДхЕ╢ф╗ЦхЕГч┤аф╕║-1</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> MAX_OPEN<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    client<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//ш░ГчФиpollхЗ╜цХ░я╝МцгАц╡ЛclientцХ░ч╗ДщЗМчЪДцЦЗф╗╢цППш┐░чмжцШпхРжцЬЙх░▒ч╗кчЪДя╝Мш┐ФхЫЮх░▒ч╗кчЪДцЦЗф╗╢цППш┐░чмжф╕кцХ░</span>
   n <span class="token operator">=</span> <span class="token function">poll</span><span class="token punctuation">(</span>client<span class="token punctuation">,</span> maxfd<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">//хжВцЮЬчЫСхРмхеЧф╗╢хнЧчЪДцЦЗф╗╢цППш┐░чмжцЬЙхПпшп╗ф║Лф╗╢я╝МхИЩш┐ЫшбМхдДчРЖ</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>client<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> POLLRDNORM<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment">//цЬЙховцИ╖члпш┐ЮцОея╝Ыш░ГчФиacceptхЗ╜цХ░х╗║члЛш┐ЮцОе</span>
       conn_fd <span class="token operator">=</span> <span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token comment">//ф┐ЭхнШх╖▓х╗║члЛш┐ЮцОехеЧцОехнЧ</span>
       <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> MAX_OPEN<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>client<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           client<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fd <span class="token operator">=</span> conn_fd<span class="token punctuation">;</span> <span class="token comment">//х░Жх╖▓х╗║члЛш┐ЮцОечЪДцЦЗф╗╢цППш┐░чмжф┐ЭхнШхИ░clientцХ░ч╗Д</span>
           client<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">=</span> POLLRDNORM<span class="token punctuation">;</span> <span class="token comment">//шо╛ч╜ошпецЦЗф╗╢цППш┐░чмжчЫСхРмхПпшп╗ф║Лф╗╢</span>
           <span class="token keyword">break</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
       maxfd <span class="token operator">=</span> i<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token comment">//ф╛ЭцмбцгАцЯех╖▓ш┐ЮцОехеЧцОехнЧчЪДцЦЗф╗╢цППш┐░чмж</span>
   <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> MAX_OPEN<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span>client<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>revents <span class="token operator">&amp;</span> <span class="token punctuation">(</span>POLLRDNORM <span class="token operator">|</span> POLLERR<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token comment">//цЬЙцХ░цНохПпшп╗цИЦхПСчФЯщФЩшппя╝Мш┐ЫшбМшп╗цХ░цНохдДчРЖцИЦщФЩшппхдДчРЖ</span>
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>хЕ╢хоЮя╝МхТМ select хЗ╜цХ░чЫ╕цпФя╝Мpoll хЗ╜цХ░чЪДцФ╣ш┐Ыф╣ЛхдДф╕╗шжБх░▒хЬиф║Оя╝М<strong>хоГхЕБшо╕ф╕АцмбчЫСхРмш╢Еш┐З 1024 ф╕кцЦЗф╗╢цППш┐░чмж</strong>уАВф╜ЖцШпх╜Уш░ГчФиф║Ж poll хЗ╜цХ░хРОя╝МцИСф╗мф╗НчД╢щЬАшжБщБНхОЖцпПф╕кцЦЗф╗╢цППш┐░чмжя╝МцгАц╡ЛшпецППш┐░чмжцШпхРжх░▒ч╗кя╝МчД╢хРОхЖНш┐ЫшбМхдДчРЖуАВ</p> <p><strong>щВгф╣Ия╝МцЬЙц▓бцЬЙхКЮц│ХхПпф╗ещБ┐хЕНщБНхОЖцпПф╕кцППш┐░чмжхСвя╝Я</strong> ш┐Щх░▒цШпцИСцОеф╕ЛцЭехРСф╜аф╗Лч╗НчЪД epoll цЬ║хИ╢</p> <h3 id="epoll-цЬ║хИ╢-щБ┐хЕНщБНхОЖцпПф╕кцППш┐░чмж"><a href="#epoll-цЬ║хИ╢-щБ┐хЕНщБНхОЖцпПф╕кцППш┐░чмж" class="header-anchor">#</a> epoll цЬ║хИ╢я╝ЪщБ┐хЕНщБНхОЖцпПф╕кцППш┐░чмж</h3> <p>щжЦхЕИя╝Мepoll цЬ║хИ╢цШпф╜┐чФи epoll_event ч╗УцЮДф╜Уя╝МцЭешо░х╜Хх╛ЕчЫСхРмчЪДцЦЗф╗╢цППш┐░чмжхПКхЕ╢чЫСхРмчЪДф║Лф╗╢ч▒╗хЮЛчЪДя╝Мш┐ЩхТМ poll цЬ║хИ╢ф╕нф╜┐чФи pollfd ч╗УцЮДф╜УцпФш╛Гч▒╗ф╝╝уАВ</p> <p>щВгф╣Ия╝Мхп╣ф║О epoll_event ч╗УцЮДф╜УцЭешп┤я╝МхЕ╢ф╕нхМЕхРлф║Ж epoll_data_t шБФхРИф╜УхПШщЗПя╝Мф╗ехПКцХ┤цХ░ч▒╗хЮЛчЪД events хПШщЗПуАВepoll_data_t шБФхРИф╜Уф╕нцЬЙшо░х╜ХцЦЗф╗╢цППш┐░чмжчЪДцИРхСШхПШщЗП fdя╝МшАМ events хПШщЗПф╝ЪхПЦхА╝ф╜┐чФиф╕НхРМчЪДхоПхоЪф╣ЙхА╝я╝МцЭешбичд║ epoll_data_t хПШщЗПф╕нчЪДцЦЗф╗╢цППш┐░чмжцЙАхЕ│ц│ичЪДф║Лф╗╢ч▒╗хЮЛя╝МцпФхжВф╕Аф║Ых╕╕шзБчЪДф║Лф╗╢ч▒╗хЮЛхМЕцЛмф╗еф╕Лш┐ЩхЗачзНуАВ</p> <ul><li>EPOLLINя╝Ъшп╗ф║Лф╗╢я╝Мшбичд║цЦЗф╗╢цППш┐░чмжхп╣х║ФхеЧцОехнЧцЬЙцХ░цНохПпшп╗уАВ</li> <li>EPOLLOUTя╝ЪхЖЩф║Лф╗╢я╝Мшбичд║цЦЗф╗╢цППш┐░чмжхп╣х║ФхеЧцОехнЧцЬЙцХ░цНошжБхЖЩуАВ</li> <li>EPOLLERRя╝ЪщФЩшппф║Лф╗╢я╝Мшбичд║цЦЗф╗╢цППш┐░чмжхп╣ф║ОхеЧцОехнЧхЗ║щФЩуАВ</li></ul> <p>ф╕ЛщЭвчЪДф╗гчаБх▒Хчд║ф║Ж epoll_event ч╗УцЮДф╜Уф╗ехПК epoll_data шБФхРИф╜УчЪДхоЪф╣Йя╝Мф╜ахПпф╗ечЬЛф╕ЛуАВ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">union</span> epoll_data
<span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token keyword">int</span> fd<span class="token punctuation">;</span>  <span class="token comment">//шо░х╜ХцЦЗф╗╢цППш┐░чмж</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span> <span class="token class-name">epoll_data_t</span><span class="token punctuation">;</span>


<span class="token keyword">struct</span> <span class="token class-name">epoll_event</span>
<span class="token punctuation">{</span>
  <span class="token class-name">uint32_t</span> events<span class="token punctuation">;</span>  <span class="token comment">//epollчЫСхРмчЪДф║Лф╗╢ч▒╗хЮЛ</span>
  <span class="token class-name">epoll_data_t</span> data<span class="token punctuation">;</span> <span class="token comment">//х║ФчФичиЛх║ПцХ░цНо</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>хе╜ф║Жя╝МчО░хЬицИСф╗мчЯещБУя╝МхЬиф╜┐чФи select цИЦ poll хЗ╜цХ░чЪДцЧ╢хАЩя╝МхИЫх╗║хе╜цЦЗф╗╢цППш┐░чмжщЫЖхРИцИЦ pollfd цХ░ч╗ДхРОя╝Мх░▒хПпф╗ех╛АцХ░ч╗Дф╕нц╖╗хКацИСф╗мщЬАшжБчЫСхРмчЪДцЦЗф╗╢цППш┐░чмжуАВ</p> <p>ф╜ЖцШпхп╣ф║О epoll цЬ║хИ╢цЭешп┤я╝МцИСф╗мхИЩщЬАшжБхЕИш░ГчФи epoll_create хЗ╜цХ░я╝МхИЫх╗║ф╕Аф╕к epoll хоЮф╛ЛуАВш┐Щф╕к epoll хоЮф╛ЛхЖЕщГич╗┤цКдф║Жф╕дф╕кч╗УцЮДя╝МхИЖхИлцШп<strong>шо░х╜ХшжБчЫСхРмчЪДцЦЗф╗╢цППш┐░чмж</strong>хТМ<strong>х╖▓ч╗Пх░▒ч╗кчЪДцЦЗф╗╢цППш┐░чмж</strong>я╝МшАМхп╣ф║Ох╖▓ч╗Пх░▒ч╗кчЪДцЦЗф╗╢цППш┐░чмжцЭешп┤я╝МхоГф╗мф╝Ъшвлш┐ФхЫЮч╗ЩчФицИ╖чиЛх║Пш┐ЫшбМхдДчРЖуАВ</p> <p>цЙАф╗ея╝МцИСф╗мхЬиф╜┐чФи epoll цЬ║хИ╢цЧ╢я╝Мх░▒ф╕НчФихГПф╜┐чФи select хТМ poll ф╕Аца╖я╝МщБНхОЖцЯешпвхУкф║ЫцЦЗф╗╢цППш┐░чмжх╖▓ч╗Пх░▒ч╗кф║ЖуАВш┐Щца╖ф╕АцЭея╝М epoll чЪДцХИчОЗх░▒цпФ select хТМ poll цЬЙф║ЖцЫ┤щлШчЪДцПРхНЗуАВ</p> <p>хЬихИЫх╗║ф║Ж epoll хоЮф╛ЛхРОя╝МцИСф╗мщЬАшжБхЖНф╜┐чФи epoll_ctl хЗ╜цХ░я╝Мч╗ЩшвлчЫСхРмчЪДцЦЗф╗╢цППш┐░чмжц╖╗хКачЫСхРмф║Лф╗╢ч▒╗хЮЛя╝Мф╗ехПКф╜┐чФи epoll_wait хЗ╜цХ░шО╖хПЦх░▒ч╗кчЪДцЦЗф╗╢цППш┐░чмжуАВ</p> <p>цИСчФ╗ф║Жф╕Ах╝ахЫ╛я╝Мх▒Хчд║ф║Жф╜┐чФи epoll ш┐ЫшбМч╜Сч╗ЬщАЪф┐бчЪДц╡БчиЛя╝Мф╜ахПпф╗ечЬЛф╕ЛуАВ</p> <p><img src="https://echo798.oss-cn-shenzhen.aliyuncs.com/img/202409171348223.png" alt="image-20240917134850159"></p> <p>ф╕ЛщЭвчЪДф╗гчаБх▒Хчд║ф║Жф╜┐чФи epoll хЗ╜цХ░чЪДц╡БчиЛя╝Мф╜аф╣ЯхПпф╗ечЬЛф╕ЛуАВ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> sock_fd<span class="token punctuation">,</span>conn_fd<span class="token punctuation">;</span> <span class="token comment">//чЫСхРмхеЧцОехнЧхТМх╖▓ш┐ЮцОехеЧцОехнЧчЪДхПШщЗП</span>
sock_fd <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//хИЫх╗║хеЧцОехнЧ</span>
<span class="token function">bind</span><span class="token punctuation">(</span>sock_fd<span class="token punctuation">)</span>   <span class="token comment">//ч╗СхоЪхеЧцОехнЧ</span>
<span class="token function">listen</span><span class="token punctuation">(</span>sock_fd<span class="token punctuation">)</span> <span class="token comment">//хЬихеЧцОехнЧф╕Кш┐ЫшбМчЫСхРмя╝Мх░ЖхеЧцОехнЧш╜мф╕║чЫСхРмхеЧцОехнЧ</span>

epfd <span class="token operator">=</span> <span class="token function">epoll_create</span><span class="token punctuation">(</span>EPOLL_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//хИЫх╗║epollхоЮф╛Ля╝М</span>
<span class="token comment">//хИЫх╗║epoll_eventч╗УцЮДф╜УцХ░ч╗Дя╝Мф┐ЭхнШхеЧцОехнЧхп╣х║ФцЦЗф╗╢цППш┐░чмжхТМчЫСхРмф║Лф╗╢ч▒╗хЮЛ</span>
ep_events <span class="token operator">=</span> <span class="token punctuation">(</span>epoll_event<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>epoll_event<span class="token punctuation">)</span> <span class="token operator">*</span> EPOLL_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//хИЫх╗║epoll_eventхПШщЗП</span>
<span class="token keyword">struct</span> <span class="token class-name">epoll_event</span> ee
<span class="token comment">//чЫСхРмшп╗ф║Лф╗╢</span>
ee<span class="token punctuation">.</span>events <span class="token operator">=</span> EPOLLIN<span class="token punctuation">;</span>
<span class="token comment">//чЫСхРмчЪДцЦЗф╗╢цППш┐░чмжцШпхИЪхИЫх╗║чЪДчЫСхРмхеЧцОехнЧ</span>
ee<span class="token punctuation">.</span>data<span class="token punctuation">.</span>fd <span class="token operator">=</span> sock_fd<span class="token punctuation">;</span>

<span class="token comment">//х░ЖчЫСхРмхеЧцОехнЧхКахЕехИ░чЫСхРмхИЧшбиф╕н</span>
<span class="token function">epoll_ctl</span><span class="token punctuation">(</span>epfd<span class="token punctuation">,</span> EPOLL_CTL_ADD<span class="token punctuation">,</span> sock_fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ee<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//чнЙх╛Еш┐ФхЫЮх╖▓ч╗Пх░▒ч╗кчЪДцППш┐░чмж</span>
   n <span class="token operator">=</span> <span class="token function">epoll_wait</span><span class="token punctuation">(</span>epfd<span class="token punctuation">,</span> ep_events<span class="token punctuation">,</span> EPOLL_SIZE<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">//щБНхОЖцЙАцЬЙх░▒ч╗кчЪДцППш┐░чмж</span>
   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment">//хжВцЮЬцШпчЫСхРмхеЧцОехнЧцППш┐░чмжх░▒ч╗кя╝МшбицШОцЬЙф╕Аф╕кцЦ░ховцИ╖члпш┐ЮцОехИ░цЭе</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span>ep_events<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>fd <span class="token operator">==</span> sock_fd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          conn_fd <span class="token operator">=</span> <span class="token function">accept</span><span class="token punctuation">(</span>sock_fd<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ш░ГчФиaccept()х╗║члЛш┐ЮцОе</span>
          ee<span class="token punctuation">.</span>events <span class="token operator">=</span> EPOLLIN<span class="token punctuation">;</span>
          ee<span class="token punctuation">.</span>data<span class="token punctuation">.</span>fd <span class="token operator">=</span> conn_fd<span class="token punctuation">;</span>
          <span class="token comment">//ц╖╗хКахп╣цЦ░хИЫх╗║чЪДх╖▓ш┐ЮцОехеЧцОехнЧцППш┐░чмжчЪДчЫСхРмя╝МчЫСхРмхРОч╗нхЬих╖▓ш┐ЮцОехеЧцОехнЧф╕КчЪДшп╗ф║Лф╗╢</span>
          <span class="token function">epoll_ctl</span><span class="token punctuation">(</span>epfd<span class="token punctuation">,</span> EPOLL_CTL_ADD<span class="token punctuation">,</span> conn_fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ee<span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">//хжВцЮЬцШпх╖▓ш┐ЮцОехеЧцОехнЧцППш┐░чмжх░▒ч╗кя╝МхИЩхПпф╗ешп╗цХ░цНо</span>
           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token comment">//шп╗хПЦцХ░цНох╣╢хдДчРЖ</span>
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>хе╜ф║Жя╝МхИ░ш┐ЩщЗМя╝Мф╜ах░▒ф║Жшзгф║Ж epoll хЗ╜цХ░чЪДф╜┐чФицЦ╣ц│Хф║ЖуАВхоЮщЩЕф╕Кя╝Мф╣ЯцнгцШпхЫаф╕║ epoll шГ╜шЗкхоЪф╣ЙчЫСхРмчЪДцППш┐░чмжцХ░щЗПя╝Мф╗ехПКхПпф╗ечЫ┤цОеш┐ФхЫЮх░▒ч╗кчЪДцППш┐░чмжя╝МRedis хЬишо╛шобхТМхоЮчО░ч╜Сч╗ЬщАЪф┐бцбЖцЮ╢цЧ╢я╝Мх░▒хЯ║ф║О epoll цЬ║хИ╢ф╕нчЪД epoll_createуАБepoll_ctl хТМ epoll_wait чнЙхЗ╜цХ░хТМшп╗хЖЩф║Лф╗╢я╝Мш┐ЫшбМф║Жх░БшгЕх╝АхПСя╝МхоЮчО░ф║ЖчФиф║Оч╜Сч╗ЬщАЪф┐бчЪДф║Лф╗╢щй▒хКицбЖцЮ╢я╝Мф╗ОшАМф╜┐х╛Ч Redis шЩ╜чД╢цШпхНХч║┐чиЛш┐РшбМя╝Мф╜ЖцШпф╗НчД╢шГ╜щлШцХИх║Фхп╣щлШх╣╢хПСчЪДховцИ╖члпшо┐щЧоуАВ</p> <h2 id="цА╗ч╗У"><a href="#цА╗ч╗У" class="header-anchor">#</a> цА╗ч╗У</h2> <p>echo ч╗Щф╜аф╗Лч╗Нф║Ж Redis ч╜Сч╗ЬщАЪф┐бф╛Эш╡ЦчЪДцУНф╜Ьч│╗ч╗Ях║Хх▒ВцЬ║хИ╢я╝Мф╣Ях░▒цШп IO хдЪш╖пхдНчФицЬ║хИ╢</p> <p>чФ▒ф║О Redis цШпхНХч║┐чиЛчиЛх║Пя╝МхжВцЮЬф╜┐чФихЯ║цЬмчЪД Socket ч╝ЦчиЛцибхЮЛчЪДшпЭя╝МхПкшГ╜хп╣ф╕Аф╕кчЫСхРмхеЧцОехнЧцИЦф╕Аф╕кх╖▓ш┐ЮцОехеЧцОехнЧш┐ЫшбМчЫСхРмуАВшАМх╜У Redis хоЮф╛ЛщЭвф╕┤х╛ИхдЪх╣╢хПСчЪДховцИ╖члпцЧ╢я╝Мш┐ЩчзНхдДчРЖцЦ╣х╝ПчЪДцХИчОЗх░▒ф╝Ъх╛Иф╜ОуАВ</p> <p>цЙАф╗ея╝МхТМхЯ║цЬмчЪД Socket щАЪф┐бчЫ╕цпФя╝Мф╜┐чФи IO хдЪш╖пхдНчФицЬ║хИ╢я╝Мх░▒хПпф╗еф╕АцмбцАзшО╖х╛Чх░▒ч╗кчЪДхдЪф╕кхеЧцОехнЧя╝Мф╗ОшАМщБ┐хЕНф║ЖщАРф╕кцгАц╡ЛхеЧцОехнЧчЪДх╝АщФАуАВ</p> <p>цИСцШпф╗ецЬАх╕╕чФичЪД Linux цУНф╜Ьч│╗ч╗Яф╕║ф╛Ля╝Мч╗Щф╜ахЕ╖ф╜Уф╗Лч╗Нф║Ж Linux ч│╗ч╗ЯцПРф╛ЫчЪДф╕ЙчзН IO хдЪш╖пхдНчФицЬ║хИ╢я╝МхИЖхИлцШп selectуАБpoll хТМ epollуАВш┐Щф╕ЙчзНцЬ║хИ╢хЬишГ╜чЫСхРмчЪДцППш┐░чмжцХ░щЗПхТМцЯецЙ╛х░▒ч╗кцППш┐░чмжчЪДцЦ╣ц│Хф╕КцШпф╕Нф╕Аца╖чЪД</p> <table><thead><tr><th>хдЪш╖пхдНчФицЬ║хИ╢</th> <th>чЫСхРмчЪДцЦЗф╗╢цППш┐░чмжцХ░щЗП</th> <th>цЯецЙ╛х░▒ч╗кчЪДцЦЗф╗╢цППш┐░чмж</th></tr></thead> <tbody><tr><td>select</td> <td>цЬАхдЪ 1024</td> <td>щБНхОЖцЙАцЬЙцППш┐░чмж</td></tr> <tr><td>poll</td> <td>ф╕НхПЧщЩР</td> <td>щБНхОЖцЙАцЬЙцППш┐░чмж</td></tr> <tr><td>epoll</td> <td>ф╕Оф╜┐чФи</td> <td>epoll_wait шЗкхКиш┐ФхЫЮх░▒ч╗кчЪДцППш┐░чмжя╝МцЬкх░▒ч╗кчЪДцППш┐░чмжф╕Нш┐ФхЫЮ</td></tr></tbody></table></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/echo-lxy/echo-system-design/edit/master/docs/Redis ч│╗ч╗Яшо╛шоб/03.ф╕╗ч║┐/01.Linux ф╕нчЪД IO хдЪш╖пхдНчФи.md" target="_blank" rel="noopener noreferrer">ч╝Цш╛С</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">ф╕КцмбцЫ┤цЦ░ф║О:</span> <span class="time">2024/09/17, 08:34:31</span></div></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><span class="prev">
        тЖР
        <a href="/pages/2d4312/" class="prev">ZSet шо╛шобф╕ОхоЮчО░</a></span> <span class="next"><a href="/pages/d4ecb9/">Redis Server хИЭхзЛхМЦ</a>тЖТ
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:lixinyang2002@163.com" title="хПСщВоф╗╢" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/echo-lxy" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="хРмщЯ│ф╣Р" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="цЬмчлЩф╕╗щвШ">Vdoing</a> 
    | Copyright ┬й 2024-2024
    <span>Xinyang Li | MIT License</span></div> <div class="buttons"><div title="ш┐ФхЫЮщб╢щГи" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="хО╗шпДшо║" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ф╕╗щвШцибх╝П" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          ш╖ЯщЪПч│╗ч╗Я
        </li><li class="iconfont icon-rijianmoshi">
          ц╡ЕшЙ▓цибх╝П
        </li><li class="iconfont icon-yejianmoshi">
          ц╖▒шЙ▓цибх╝П
        </li><li class="iconfont icon-yuedu">
          щШЕшп╗цибх╝П
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.aaad5302.js" defer></script><script src="/assets/js/2.933750c6.js" defer></script><script src="/assets/js/44.ff4f9547.js" defer></script><script src="/assets/js/7.7eb70372.js" defer></script>
  </body>
</html>
