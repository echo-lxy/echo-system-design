<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>String | Echo ч│╗ч╗Яшо╛шобф╣Лч╛О</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="ц░┤ц╗┤чЯ│чй┐я╝Мшо╛шобцЧащУ╢х╝╣">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.3b389ff4.css" as="style"><link rel="preload" href="/assets/js/app.e6c7c0bc.js" as="script"><link rel="preload" href="/assets/js/2.c1dbdf51.js" as="script"><link rel="preload" href="/assets/js/8.f8705c03.js" as="script"><link rel="prefetch" href="/assets/js/10.ce9e2824.js"><link rel="prefetch" href="/assets/js/11.4b96b543.js"><link rel="prefetch" href="/assets/js/12.2feff802.js"><link rel="prefetch" href="/assets/js/13.4332a769.js"><link rel="prefetch" href="/assets/js/14.464e0155.js"><link rel="prefetch" href="/assets/js/15.0d61cf57.js"><link rel="prefetch" href="/assets/js/16.506c965c.js"><link rel="prefetch" href="/assets/js/17.0b9e4b65.js"><link rel="prefetch" href="/assets/js/18.c7917c05.js"><link rel="prefetch" href="/assets/js/19.fad48692.js"><link rel="prefetch" href="/assets/js/20.ff68a659.js"><link rel="prefetch" href="/assets/js/21.93b2e430.js"><link rel="prefetch" href="/assets/js/22.e8989777.js"><link rel="prefetch" href="/assets/js/23.de5a9e3c.js"><link rel="prefetch" href="/assets/js/24.914d458e.js"><link rel="prefetch" href="/assets/js/25.b6565a06.js"><link rel="prefetch" href="/assets/js/26.977f0fd3.js"><link rel="prefetch" href="/assets/js/27.7bde72bc.js"><link rel="prefetch" href="/assets/js/28.e34d1ee9.js"><link rel="prefetch" href="/assets/js/29.b4c0912f.js"><link rel="prefetch" href="/assets/js/3.d5abcf7b.js"><link rel="prefetch" href="/assets/js/30.662f616d.js"><link rel="prefetch" href="/assets/js/31.8a8e803f.js"><link rel="prefetch" href="/assets/js/32.b41ef25a.js"><link rel="prefetch" href="/assets/js/33.24569bcc.js"><link rel="prefetch" href="/assets/js/34.dac446b7.js"><link rel="prefetch" href="/assets/js/35.f6fabb4e.js"><link rel="prefetch" href="/assets/js/36.85b2b5dc.js"><link rel="prefetch" href="/assets/js/37.da59a00f.js"><link rel="prefetch" href="/assets/js/38.655f6ff9.js"><link rel="prefetch" href="/assets/js/39.b0056866.js"><link rel="prefetch" href="/assets/js/4.d946b097.js"><link rel="prefetch" href="/assets/js/40.3ddc2c59.js"><link rel="prefetch" href="/assets/js/41.16557a6f.js"><link rel="prefetch" href="/assets/js/42.0e64221c.js"><link rel="prefetch" href="/assets/js/43.7976c385.js"><link rel="prefetch" href="/assets/js/44.71553edf.js"><link rel="prefetch" href="/assets/js/45.1313072b.js"><link rel="prefetch" href="/assets/js/46.c2baf55f.js"><link rel="prefetch" href="/assets/js/47.635abf6e.js"><link rel="prefetch" href="/assets/js/48.c68ae1bc.js"><link rel="prefetch" href="/assets/js/49.0ded727d.js"><link rel="prefetch" href="/assets/js/5.39afb5af.js"><link rel="prefetch" href="/assets/js/50.e00d3a7e.js"><link rel="prefetch" href="/assets/js/51.9da875f4.js"><link rel="prefetch" href="/assets/js/52.d552ff92.js"><link rel="prefetch" href="/assets/js/53.dffecfdc.js"><link rel="prefetch" href="/assets/js/54.e64b0f07.js"><link rel="prefetch" href="/assets/js/55.bf7710d3.js"><link rel="prefetch" href="/assets/js/56.2d336989.js"><link rel="prefetch" href="/assets/js/6.7a2f25e5.js"><link rel="prefetch" href="/assets/js/7.a5188780.js"><link rel="prefetch" href="/assets/js/9.b279253b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3b389ff4.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="чЫох╜Х" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Echo ч│╗ч╗Яшо╛шобф╣Лч╛О" class="logo"> <span class="site-name can-hide">Echo ч│╗ч╗Яшо╛шобф╣Лч╛О</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">ЁЯПащжЦщб╡</a></div><div class="nav-item"><a href="/pages/fccd91/" class="nav-link">тЬТя╕ПчГнщЧичоЧц│Х</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕" class="dropdown-title"><!----> <span class="title" style="display:;">ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/252196/" class="nav-link">Redis ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/pages/b9733b/" class="nav-link">Kafka ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/pages/4601ca/" class="nav-link">Nginx ч│╗ч╗Яшо╛шоб</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ЁЯзСтАНЁЯТ╗хоЮцИШч│╗ч╗Яшо╛шоб" class="dropdown-title"><!----> <span class="title" style="display:;">ЁЯзСтАНЁЯТ╗хоЮцИШч│╗ч╗Яшо╛шоб</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/84cb49/" class="nav-link">шо╛шобхЯ║чбАшо╛цЦ╜</a></li><li class="dropdown-item"><!----> <a href="/pages/a95d7d/" class="nav-link">шо╛шобчГнщЧих║ФчФи</a></li><li class="dropdown-item"><!----> <a href="/pages/def08a/" class="nav-link">хЬ║цЩпшо╛шоб</a></li></ul></div></div><div class="nav-item"><a href="/pages/92b2ee/" class="nav-link">тЭУщЧочнФ</a></div><div class="nav-item"><a href="/pages/52ebd8/" class="nav-link">ЁЯСАхКицАБ</a></div> <a href="https://github.com/echo-lxy/echo-system-design" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">ЁЯПащжЦщб╡</a></div><div class="nav-item"><a href="/pages/fccd91/" class="nav-link">тЬТя╕ПчГнщЧичоЧц│Х</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕" class="dropdown-title"><!----> <span class="title" style="display:;">ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/252196/" class="nav-link">Redis ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/pages/b9733b/" class="nav-link">Kafka ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/pages/4601ca/" class="nav-link">Nginx ч│╗ч╗Яшо╛шоб</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ЁЯзСтАНЁЯТ╗хоЮцИШч│╗ч╗Яшо╛шоб" class="dropdown-title"><!----> <span class="title" style="display:;">ЁЯзСтАНЁЯТ╗хоЮцИШч│╗ч╗Яшо╛шоб</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/84cb49/" class="nav-link">шо╛шобхЯ║чбАшо╛цЦ╜</a></li><li class="dropdown-item"><!----> <a href="/pages/a95d7d/" class="nav-link">шо╛шобчГнщЧих║ФчФи</a></li><li class="dropdown-item"><!----> <a href="/pages/def08a/" class="nav-link">хЬ║цЩпшо╛шоб</a></li></ul></div></div><div class="nav-item"><a href="/pages/92b2ee/" class="nav-link">тЭУщЧочнФ</a></div><div class="nav-item"><a href="/pages/52ebd8/" class="nav-link">ЁЯСАхКицАБ</a></div> <a href="https://github.com/echo-lxy/echo-system-design" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>цМЗхНЧ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/252196/" class="sidebar-link">ф╗Лч╗Н</a></li><li><a href="/pages/69fbd7/" class="sidebar-link">Redis ф╝кчаБшУЭхЫ╛уАРх┐ЕчЬЛуАС</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>хЯ║чбА</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/ee2b16/" class="sidebar-link">list</a></li><li><a href="/pages/2d4311/" class="sidebar-link">Hash</a></li><li><a href="/pages/c7cf4a/" class="sidebar-link">ZSet</a></li><li><a href="/pages/2ab65e/" class="sidebar-link">хЖЕхнШхПЛхе╜чЪДцХ░цНоч╗УцЮДшпехжВф╜Хч╗ЖхМЦшо╛шобя╝Я</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ф╕╗ч║┐</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/d4ecb9/" class="sidebar-link">Redis Server хИЭхзЛхМЦ</a></li><li><a href="/pages/34fa27/" class="sidebar-link">Linux ф╕нчЪД IO хдЪш╖пхдНчФи</a></li><li><a href="/pages/d6b00d/" class="sidebar-link">Redis чЪД Reactor цибхЮЛ</a></li><li><a href="/pages/264b06/" class="sidebar-link">ц╖▒хЕе Redis ф║Лф╗╢щй▒хКицбЖцЮ╢</a></li><li><a href="/pages/e6d8ef/" class="sidebar-link">Redis чЪДцЙзшбМцибх╝П</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>цФпч║┐</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/b43a19/" class="sidebar-link">LRU чнЦчХе</a></li><li><a href="/pages/b43a89/" class="sidebar-link">LFU чнЦчХе</a></li><li><a href="/pages/f44fbe/" class="sidebar-link">Redis ш┐ЗцЬЯчнЦчХе</a></li><li><a href="/pages/9b17a6/" class="sidebar-link">RDB цМБф╣ЕхМЦ</a></li><li><a href="/pages/9b17a7/" class="sidebar-link">AOF цМБф╣ЕхМЦ</a></li><li><a href="/pages/aa75e9/" class="sidebar-link">Redis ф╕нчЪДх╗╢ш┐ЯчЫСцОз</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>щЫЖч╛д</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/ebc8dc/" class="sidebar-link">ф╕╗ф╗ОхдНхИ╢</a></li><li><a href="/pages/af8752/" class="sidebar-link">хУихЕ╡</a></li><li><a href="/pages/040403/" class="sidebar-link">cluster</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="щжЦщб╡" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>Redis ч│╗ч╗Яшо╛шоб</span></li><li data-v-06225672><span data-v-06225672>хЯ║чбА</span></li></ul> <div class="info" data-v-06225672><div title="ф╜ЬшАЕ" class="author iconfont icon-touxiang" data-v-06225672><a href="https://gitee.com/brother-one" target="_blank" title="ф╜ЬшАЕ" class="beLink" data-v-06225672>echo</a></div> <div title="хИЫх╗║цЧ╢щЧ┤" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-09-16</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">чЫох╜Х</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">String<!----></h1> <div class="page-slot page-slot-top">
    <div class="wwads-cn wwads-horizontal page-wwads" data-id="136"></div>
    <style>
      .page-wwads{
        width:100%!important;
        min-height: 0;
        margin: 0;
      }
      .page-wwads .wwads-img img{
        width:80px!important;
      }
      .page-wwads .wwads-poweredby{
        width: 40px;
        position: absolute;
        right: 25px;
        bottom: 3px;
      }
      .wwads-content .wwads-text, .page-wwads .wwads-text{
        height: 100%;
        padding-top: 5px;
        display: block;
      }
  </style>
  </div> <div class="theme-vdoing-content content__default"><h2 id="хЙНшиА"><a href="#хЙНшиА" class="header-anchor">#</a> хЙНшиА</h2> <p>хнЧчмжф╕▓хЬицИСф╗мх╣│цЧ╢чЪДх║ФчФих╝АхПСф╕нхНБхИЖх╕╕шзБя╝МцпФхжВцИСф╗мшжБшо░х╜ХчФицИ╖ф┐бцБпуАБхХЖхУБф┐бцБпуАБчК╢цАБф┐бцБпчнЙчнЙя╝Мш┐Щф║ЫщГ╜ф╝ЪчФихИ░хнЧчмжф╕▓уАВ</p> <p>шАМхп╣ф║О Redis цЭешп┤я╝МщФохА╝хп╣ф╕нчЪДщФоцШпхнЧчмжф╕▓я╝МхА╝цЬЙцЧ╢ф╣ЯцШпхнЧчмжф╕▓уАВцИСф╗мхЬи Redis ф╕нхЖЩхЕеф╕АцЭбчФицИ╖ф┐бцБпя╝Мшо░х╜Хф║ЖчФицИ╖хзУхРНуАБцАзхИлуАБцЙАхЬихЯОх╕ВчнЙя╝Мш┐Щф║ЫщГ╜цШпхнЧчмжф╕▓я╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code>SET user<span class="token operator">:</span>id<span class="token operator">:</span><span class="token number">100</span> <span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;gender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;M&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;city&quot;</span><span class="token operator">:</span><span class="token string">&quot;beijing&quot;</span><span class="token punctuation">}</span>
</code></pre></div><p>цндхдЦя╝МRedis хоЮф╛ЛхТМховцИ╖члпф║дф║ТчЪДхС╜ф╗дхТМцХ░цНоя╝Мф╣ЯщГ╜цШпчФихнЧчмжф╕▓шбичд║чЪДуАВ</p> <p>ф╕Аф╕кхе╜чЪДхнЧчмжф╕▓цибхЭЧшо╛шобя╝МщЬАшжБх░╜щЗПц╗бш╢│ф╗еф╕Лф╕Йф╕кшжБц▒Вя╝Ъ</p> <ul><li>шГ╜цФпцМБф╕░хпМф╕ФщлШцХИчЪДхнЧчмжф╕▓цУНф╜Ья╝МцпФхжВхнЧчмжф╕▓ш┐╜хКауАБцЛ╖ш┤ЭуАБцпФш╛ГуАБшО╖хПЦщХ┐х║жчнЙ</li> <li>шГ╜ф┐ЭхнШф╗╗цДПчЪДф║Мш┐ЫхИ╢цХ░цНоя╝МцпФхжВхЫ╛чЙЗчнЙ</li> <li>шГ╜х░╜хПпшГ╜хЬ░шКВчЬБхЖЕхнШх╝АщФА</li></ul> <p>хЕ╢хоЮя╝МхжВцЮЬф╜ах╝АхПСш┐З C шпншиАчиЛх║Пя╝Мф╜ах║Фшпех░▒чЯещБУя╝МхЬи C шпншиАф╕нхПпф╗еф╜┐чФи хнЧчмжцХ░ч╗Д <em>char</em> цЭехоЮчО░хнЧчмжф╕▓уАВхРМцЧ╢я╝МC шпншиАцаЗхЗЖх║У string.h ф╕нф╣ЯхоЪф╣Йф║ЖхдЪчзНхнЧчмжф╕▓чЪДцУНф╜ЬхЗ╜цХ░я╝МцпФхжВхнЧчмжф╕▓цпФш╛ГхЗ╜цХ░ strcmpуАБхнЧчмжф╕▓щХ┐х║жшобчоЧхЗ╜цХ░ strlenуАБхнЧчмжф╕▓ш┐╜хКахЗ╜цХ░ strcat чнЙя╝Мш┐Щца╖х░▒ф╛┐ф║Ох╝АхПСшАЕчЫ┤цОеш░ГчФиш┐Щф║ЫхЗ╜цХ░цЭехоМцИРхнЧчмжф╕▓цУНф╜ЬуАВ</p> <p>цЙАф╗еш┐Щца╖чЬЛш╡╖цЭея╝М<strong>Redis хе╜хГПхоМхЕихПпф╗ехдНчФи C шпншиАф╕нхп╣хнЧчмжф╕▓чЪДхоЮчО░хСАя╝Я</strong></p> <p>ф╜ЖхоЮщЩЕф╕Кя╝МцИСф╗мхЬиф╜┐чФи C шпншиАхнЧчмжф╕▓цЧ╢я╝Мч╗Пх╕╕щЬАшжБцЙЛхКицгАцЯехТМхИЖщЕНхнЧчмжф╕▓чй║щЧ┤я╝МшАМш┐Щх░▒ф╝ЪхвЮхКаф╗гчаБх╝АхПСчЪДх╖еф╜ЬщЗПуАВшАМф╕Фя╝МхЫ╛чЙЗчнЙцХ░цНош┐ШцЧац│ХчФихнЧчмжф╕▓ф┐ЭхнШя╝Мф╣Ях░▒щЩРхИ╢ф║Жх║ФчФишМГхЫ┤уАВ</p> <p>щВгф╣Ия╝Мф╗Оч│╗ч╗Яшо╛шобчЪДшзТх║жцЭечЬЛя╝МцИСф╗мшпехжВф╜Хшо╛шобхоЮчО░хнЧчмжф╕▓хСвя╝Я</p> <p>хЕ╢хоЮя╝МRedis шо╛шобф║Ж<strong>чоАхНХхКицАБхнЧчмжф╕▓</strong>я╝ИSimple Dynamic Stringя╝МSDSя╝ЙчЪДч╗УцЮДя╝МчФицЭешбичд║хнЧчмжф╕▓уАВчЫ╕цпФф║О C шпншиАф╕нчЪДхнЧчмжф╕▓хоЮчО░я╝МSDS ш┐ЩчзНхнЧчмжф╕▓чЪДхоЮчО░цЦ╣х╝Пя╝Мф╝Ъ<strong>цПРхНЗхнЧчмжф╕▓чЪДцУНф╜ЬцХИчОЗя╝Мх╣╢ф╕ФхПпф╗ечФицЭеф┐ЭхнШф║Мш┐ЫхИ╢цХ░цНо</strong>уАВ</p> <p>цЙАф╗еф╗Кхдйш┐ЩшКВшп╛я╝МцИСх░▒цЭеч╗Щф╜аф╗Лч╗Нф╕Л SDS ч╗УцЮДчЪДшо╛шобцАЭцГ│хТМхоЮчО░цКАх╖зя╝Мш┐Щца╖ф╜ах░▒цЧвхПпф╗ецОМцПб char* хоЮчО░цЦ╣ц│ХчЪДф╕Нш╢│хТМ SDS чЪДф╝ШхК┐я╝Мш┐ШшГ╜хнжф╣ахИ░ч┤зхЗСхЮЛхЖЕхнШч╗УцЮДчЪДхоЮчО░цКАх╖зуАВхжВцЮЬф╜ашжБхЬишЗкх╖▒чЪДч│╗ч╗Яш╜пф╗╢ф╕нхоЮчО░хнЧчмжф╕▓ч▒╗хЮЛя╝Мх░▒хПпф╗ехПВшАГ Redis чЪДшо╛шобцАЭцГ│я╝МцЭецЫ┤хе╜хЬ░цПРхНЗцУНф╜ЬцХИчОЗя╝МшКВчЬБхЖЕхнШх╝АщФАуАВ</p> <p>хе╜я╝МцОеф╕ЛцЭея╝МцИСф╗мхЕИцЭеф║Жшзгф╕Лф╕║ф╗Аф╣И Redis ц▓бцЬЙхдНчФи C шпншиАчЪДхнЧчмжф╕▓хоЮчО░цЦ╣ц│ХуАВ</p> <h2 id="char-цЬЙхХеф╕Нхе╜"><a href="#char-цЬЙхХеф╕Нхе╜" class="header-anchor">#</a> <code>char*</code> цЬЙхХеф╕Нхе╜</h2> <p>хоЮщЩЕф╕Кя╝МшжБцГ│шзгчнФш┐Щф╕кщЧощвШя╝МцИСф╗мщЬАшжБхЕИчЯещБУ char* хнЧчмжф╕▓цХ░ч╗ДчЪДч╗УцЮДчЙ╣чВ╣я╝Мш┐ШцЬЙ Redis хп╣хнЧчмжф╕▓чЪДщЬАц▒ВцШпф╗Аф╣Ия╝МцЙАф╗еф╕ЛщЭвцИСф╗мх░▒цЭехЕ╖ф╜УхИЖцЮРф╕Аф╕ЛуАВ</p> <h3 id="char-чЪДч╗УцЮДшо╛шоб"><a href="#char-чЪДч╗УцЮДшо╛шоб" class="header-anchor">#</a> <code>char*</code> чЪДч╗УцЮДшо╛шоб</h3> <p>щжЦхЕИя╝МцИСф╗мцЭечЬЛчЬЛ char* хнЧчмжцХ░ч╗ДчЪДч╗УцЮДуАВ</p> <p><code>char*</code> хнЧчмжцХ░ч╗ДчЪДч╗УцЮДх╛ИчоАхНХя╝Мх░▒цШпуАВцпФхжВя╝Мф╕ЛхЫ╛цШ╛чд║чЪДх░▒цШпхнЧчмжф╕▓тАЬredisтАЭчЪД char ф╕АхЭЧш┐Юч╗нчЪДхЖЕхнШчй║щЧ┤я╝Мф╛ЭцмбхнШцФ╛ф║ЖхнЧчмжф╕▓ф╕нчЪДцпПф╕Аф╕кхнЧчмжцХ░ч╗Дч╗УцЮДуАВ</p> <p><img src="https://echo798.oss-cn-shenzhen.aliyuncs.com/img/202409161739553.png" alt="image-20240916173944511"></p> <p>ф╗ОхЫ╛ф╕нхПпф╗ечЬЛхИ░я╝МхнЧчмжцХ░ч╗ДчЪДцЬАхРОф╕Аф╕кхнЧчмжцШптАЬ\0тАЭя╝Мш┐Щф╕кхнЧчмжчЪДф╜ЬчФицШпф╗Аф╣ИхСвя╝ЯхЕ╢хоЮя╝МC шпншиАхЬихп╣хнЧчмжф╕▓ш┐ЫшбМцУНф╜ЬцЧ╢я╝Мchar* цМЗщТИхПкцШпцМЗхРСхнЧчмжцХ░ч╗ДчЪДш╡╖хзЛф╜Нч╜оя╝МшАМ<strong>хнЧчмжцХ░ч╗ДчЪДч╗Ух░╛ф╜Нч╜ох░▒чФитАЬ\0тАЭшбичд║я╝МцДПцАЭцШпцМЗхнЧчмжф╕▓чЪДч╗УцЭЯуАВ</strong></p> <p>ш┐Щца╖ф╕АцЭея╝МC шпншиАцаЗхЗЖх║Уф╕нхнЧчмжф╕▓чЪДцУНф╜ЬхЗ╜цХ░я╝Мх░▒ф╝ЪщАЪш┐ЗцгАцЯехнЧчмжцХ░ч╗Дф╕нцШпхРжцЬЙтАЬ\0тАЭя╝МцЭехИдцЦнхнЧчмжф╕▓цШпхРжч╗УцЭЯуАВцпФхжВя╝Мstrlen хЗ╜цХ░х░▒цШпф╕АчзНхнЧчмжф╕▓цУНф╜ЬхЗ╜цХ░я╝МхоГхПпф╗еш┐ФхЫЮф╕Аф╕кхнЧчмжф╕▓чЪДщХ┐х║жуАВш┐Щф╕кхЗ╜цХ░ф╝ЪщБНхОЖхнЧчмжцХ░ч╗Дф╕нчЪДцпПф╕Аф╕кхнЧчмжя╝Мх╣╢ш┐ЫшбМшобцХ░я╝МчЫ┤хИ░цгАцЯечЪДхнЧчмжф╕║тАЬ\0тАЭуАВцндцЧ╢я╝Мstrlen хЗ╜цХ░ф╝ЪхБЬцнвшобцХ░я╝Мш┐ФхЫЮх╖▓ч╗Пч╗ЯшобхИ░чЪДхнЧчмжф╕кцХ░уАВф╕ЛхЫ╛цШ╛чд║ф║Ж strlen хЗ╜цХ░чЪДцЙзшбМц╡БчиЛя╝Ъ</p> <p><img src="https://echo798.oss-cn-shenzhen.aliyuncs.com/img/202409161740231.png" alt="image-20240916174001168"></p> <p>цИСф╗мхЖНщАЪш┐Зф╕Ацо╡ф╗гчаБя╝МцЭечЬЛф╕Л**тАЬ\0тАЭч╗УцЭЯхнЧчмжхп╣хнЧчмжф╕▓щХ┐х║жчЪДх╜▒хУН**уАВш┐ЩщЗМцИСхИЫх╗║ф║Жф╕дф╕кхнЧчмжф╕▓хПШщЗП a хТМ bя╝МхИЖхИлч╗ЩхоГф╗мш╡ЛхА╝ф╕║тАЬred\0isтАЭхТМтАЬredis\0тАЭуАВчД╢хРОя╝МцИСчФи strlen хЗ╜цХ░шобчоЧш┐Щф╕дф╕кхнЧчмжф╕▓щХ┐х║жя╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code>  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
  <span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
     <span class="token keyword">char</span> <span class="token operator">*</span>a <span class="token operator">=</span> <span class="token string">&quot;red\0is&quot;</span><span class="token punctuation">;</span>
     <span class="token keyword">char</span> <span class="token operator">*</span>b <span class="token operator">=</span> <span class="token string">&quot;redis\0&quot;</span><span class="token punctuation">;</span>
     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%lu\n&quot;</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%lu\n&quot;</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>х╜УчиЛх║ПцЙзшбМхоМш┐Щцо╡ф╗гчаБхРОя╝Мш╛УхЗ║чЪДч╗УцЮЬхИЖхИлцШп 3 хТМ 5я╝Мшбичд║ a хТМ b чЪДщХ┐х║жхИЖхИлцШп 3 ф╕кхнЧчмжхТМ 5 ф╕кхнЧчмжуАВш┐ЩцШпхЫаф╕║ a ф╕нхЬитАЬredтАЭш┐Щ 3 ф╕кхнЧчмжхРОя╝Мх░▒цЬЙф║Жч╗УцЭЯхнЧчмжтАЬ\0тАЭя╝МшАМ b ф╕нчЪДч╗УцЭЯхнЧчмжцШпхЬитАЬredisтАЭ5 ф╕кхнЧчмжхРОуАВ</p> <p>ф╣Ях░▒цШпшп┤я╝Мchar* хнЧчмжф╕▓ф╗етАЬ\0тАЭшбичд║хнЧчмжф╕▓чЪДч╗УцЭЯя╝МхЕ╢хоЮф╝Ъч╗ЩцИСф╗мф┐ЭхнШцХ░цНох╕жцЭеф╕АхоЪчЪДш┤ЯщЭвх╜▒хУНуАВхжВцЮЬцИСф╗мшжБф┐ЭхнШчЪДцХ░цНоф╕ня╝МцЬмш║лх░▒цЬЙтАЬ\0тАЭя╝МщВгф╣ИцХ░цНохЬитАЬ\0тАЭхдДх░▒ф╝ЪшвлцИкцЦня╝МшАМш┐Щх░▒<strong>ф╕НчмжхРИ Redis х╕МцЬЫшГ╜ф┐ЭхнШф╗╗цДПф║Мш┐ЫхИ╢цХ░цНочЪДщЬАц▒Вф║ЖуАВ</strong></p> <h3 id="цУНф╜ЬхЗ╜цХ░хдНцЭВх║ж"><a href="#цУНф╜ЬхЗ╜цХ░хдНцЭВх║ж" class="header-anchor">#</a> цУНф╜ЬхЗ╜цХ░хдНцЭВх║ж</h3> <p>шАМщЩдф║Ж char* хнЧчмжцХ░ч╗Дч╗УцЮДчЪДшо╛шобщЧощвШф╗ехдЦя╝Мф╜┐чФитАЬ\0тАЭф╜Ьф╕║хнЧчмжф╕▓чЪДч╗УцЭЯхнЧчмжя╝МшЩ╜чД╢хПпф╗ешойхнЧчмжф╕▓цУНф╜ЬхЗ╜цХ░хИдцЦнхнЧчмжф╕▓чЪДч╗УцЭЯф╜Нч╜оя╝Мф╜ЖхоГф╣Яф╝Ъх╕жцЭехПжф╕АцЦ╣щЭвчЪДш┤ЯщЭвх╜▒хУНя╝Мф╣Ях░▒цШпф╝Ъхп╝шЗ┤цУНф╜ЬхЗ╜цХ░чЪДхдНцЭВх║жхвЮхКауАВ</p> <p>цИСш┐ШцШпф╗е strlen хЗ╜цХ░ф╕║ф╛Ля╝МшпехЗ╜цХ░щЬАшжБщБНхОЖхнЧчмжцХ░ч╗Дф╕нчЪДцпПф╕Аф╕кхнЧчмжя╝МцЙНшГ╜х╛ЧхИ░хнЧчмжф╕▓щХ┐х║жя╝МцЙАф╗еш┐Щф╕кцУНф╜ЬхЗ╜цХ░чЪДхдНцЭВх║жцШп O(N)уАВ</p> <p>цИСф╗мхЖНцЭечЬЛхПжф╕Аф╕кх╕╕чФичЪДцУНф╜ЬхЗ╜цХ░я╝Ъ<strong>хнЧчмжф╕▓ш┐╜хКахЗ╜цХ░ strcat</strong>уАВstrcat хЗ╜цХ░цШпх░Жф╕Аф╕кц║РхнЧчмжф╕▓ src ш┐╜хКахИ░ф╕Аф╕кчЫоцаЗхнЧчмжф╕▓чЪДцЬлх░╛уАВшпехЗ╜цХ░чЪДф╗гчаБхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code>  <span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">strcat</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>dest<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>src<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">//х░ЖчЫоцаЗхнЧчмжф╕▓хдНхИ╢ч╗ЩtmpхПШщЗП</span>
     <span class="token keyword">char</span> <span class="token operator">*</span>tmp <span class="token operator">=</span> dest<span class="token punctuation">;</span>
     <span class="token comment">//чФиф╕Аф╕кwhileх╛кчОпщБНхОЖчЫоцаЗхнЧчмжф╕▓я╝МчЫ┤хИ░щБЗхИ░тАЬ\0тАЭш╖│хЗ║х╛кчОпя╝МцМЗхРСчЫоцаЗхнЧчмжф╕▓чЪДцЬлх░╛</span>
     <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">*</span>dest<span class="token punctuation">)</span>
        dest<span class="token operator">++</span><span class="token punctuation">;</span>
     <span class="token comment">//х░Жц║РхнЧчмжф╕▓ф╕нчЪДцпПф╕кхнЧчмжщАРф╕Аш╡ЛхА╝хИ░чЫоцаЗхнЧчмжф╕▓ф╕ня╝МчЫ┤хИ░щБЗхИ░ч╗УцЭЯхнЧчмж</span>
     <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>dest<span class="token operator">++</span> <span class="token operator">=</span> <span class="token operator">*</span>src<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token char">'\0'</span> <span class="token punctuation">)</span>
     <span class="token keyword">return</span> tmp<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>ф╗Оф╗гчаБф╕нхПпф╗ечЬЛхИ░я╝Мstrcat хЗ╜цХ░хТМ strlen хЗ╜цХ░ч▒╗ф╝╝я╝МхдНцЭВх║жщГ╜х╛ИщлШя╝Мф╣ЯщГ╜щЬАшжБхЕИщАЪш┐ЗщБНхОЖхнЧчмжф╕▓цЙНшГ╜х╛ЧхИ░чЫоцаЗхнЧчмжф╕▓чЪДцЬлх░╛уАВчД╢хРОхп╣ф║О strcat хЗ╜цХ░цЭешп┤я╝Мш┐ШшжБхЖНщБНхОЖц║РхнЧчмжф╕▓цЙНшГ╜хоМцИРш┐╜хКауАВхПжхдЦя╝МхоГхЬицККц║РхнЧчмжф╕▓ш┐╜хКахИ░чЫоцаЗхнЧчмжф╕▓цЬлх░╛цЧ╢я╝Мш┐ШщЬАшжБчбошодчЫоцаЗхнЧчмжф╕▓хЕ╖цЬЙш╢│хдЯчЪДхПпчФичй║щЧ┤я╝МхРжхИЩх░▒цЧац│Хш┐╜хКауАВ</p> <p>цЙАф╗ея╝Мш┐Щх░▒шжБц▒Вх╝АхПСф║║хСШхЬиш░ГчФи strcat цЧ╢я╝МшжБф┐ЭшпБчЫоцаЗхнЧчмжф╕▓цЬЙш╢│хдЯчЪДчй║щЧ┤я╝Мф╕НчД╢х░▒щЬАшжБх╝АхПСф║║хСШхКицАБхИЖщЕНчй║щЧ┤я╝Мф╗ОшАМхвЮхКаф║Жч╝ЦчиЛчЪДхдНцЭВх║жуАВшАМцУНф╜ЬхЗ╜цХ░чЪДхдНцЭВх║жф╕АцЧжхвЮхКая╝Мх░▒ф╝Ъх╜▒хУНхнЧчмжф╕▓чЪДцУНф╜ЬцХИчОЗя╝Мш┐Щх░▒ <strong>ф╕НчмжхРИ Redis хп╣хнЧчмжф╕▓щлШцХИцУНф╜ЬчЪДщЬАц▒В</strong>ф║ЖуАВ</p> <p>хе╜ф║Жя╝Мч╗╝хРИф╗еф╕КхЬи C шпншиАф╕нф╜┐чФи char* хоЮчО░хнЧчмжф╕▓чЪДф╕дхдзф╕Нш╢│ф╣ЛхдДф╗ехРОя╝МцИСф╗мчО░хЬих░▒щЬАшжБцЙ╛хИ░цЦ░чЪДхоЮчО░хнЧчмжф╕▓чЪДцЦ╣х╝Пф║ЖуАВцЙАф╗ецОеф╕ЛцЭея╝МцИСф╗мх░▒цЭехнжф╣аф╕Ля╝МRedis цШпхжВф╜Ххп╣хнЧчмжф╕▓чЪДхоЮчО░ш┐ЫшбМшо╛шобшАГшЩСчЪДуАВ</p> <h2 id="sds-чЪДшо╛шобцАЭцГ│"><a href="#sds-чЪДшо╛шобцАЭцГ│" class="header-anchor">#</a> SDS чЪДшо╛шобцАЭцГ│</h2> <p>хЫаф╕║ Redis цШпф╜┐чФи C шпншиАх╝АхПСчЪДя╝МцЙАф╗еф╕║ф║Жф┐ЭшпБшГ╜х░╜щЗПхдНчФи C цаЗхЗЖх║Уф╕нчЪДхнЧчмжф╕▓цУНф╜ЬхЗ╜цХ░я╝МRedis ф┐ЭчХЩф║Жф╜┐чФихнЧчмжцХ░ч╗ДцЭеф┐ЭхнШхоЮщЩЕчЪДцХ░цНоуАВф╜ЖцШпя╝МхТМ C шпншиАф╗ЕчФихнЧчмжцХ░ч╗Дф╕НхРМя╝МRedis ш┐Шф╕УщЧишо╛шобф║Ж SDSя╝ИхН│чоАхНХхКицАБхнЧчмжф╕▓я╝ЙчЪДцХ░цНоч╗УцЮДуАВф╕ЛщЭвцИСф╗мф╕Аш╡╖цЭечЬЛчЬЛуАВ</p> <h3 id="sds-ч╗УцЮДшо╛шоб"><a href="#sds-ч╗УцЮДшо╛шоб" class="header-anchor">#</a> SDS ч╗УцЮДшо╛шоб</h3> <p>щжЦхЕИя╝МSDS ч╗УцЮДщЗМхМЕхРлф║Жф╕Аф╕кхнЧчмжцХ░ч╗Д buf[]я╝МчФицЭеф┐ЭхнШхоЮщЩЕцХ░цНоуАВхРМцЧ╢я╝МSDS ч╗УцЮДщЗМш┐ШхМЕхРлф║Жф╕Йф╕кхЕГцХ░цНоя╝МхИЖхИлцШп<strong>хнЧчмжцХ░ч╗ДчО░цЬЙщХ┐х║ж len</strong>уАБ<strong>хИЖщЕНч╗ЩхнЧчмжцХ░ч╗ДчЪДчй║щЧ┤щХ┐х║ж alloc</strong>я╝Мф╗ехПК <strong>SDS ч▒╗хЮЛ flags</strong>уАВхЕ╢ф╕ня╝МRedis ч╗Щ len хТМ alloc ш┐Щф╕дф╕кхЕГцХ░цНохоЪф╣Йф║ЖхдЪчзНцХ░цНоч▒╗хЮЛя╝Мш┐ЫшАМхПпф╗ечФицЭешбичд║ф╕НхРМч▒╗хЮЛчЪД SDSя╝МчиНхРОцИСф╝Ъч╗Щф╜ахЕ╖ф╜Уф╗Лч╗НуАВф╕ЛхЫ╛цШ╛чд║ф║Ж SDS чЪДч╗УцЮДя╝Мф╜ахПпф╗ехЕИчЬЛф╕ЛуАВ</p> <p><img src="https://echo798.oss-cn-shenzhen.aliyuncs.com/img/202409161741377.png" alt="image-20240916174113695"></p> <p>хПжхдЦя╝МхжВцЮЬф╜ахЬи Redis ц║РчаБф╕нцЯецЙ╛ш┐З SDS чЪДхоЪф╣Йя╝МщВгф╜ахПпшГ╜ф╝ЪчЬЛхИ░я╝МRedis ф╜┐чФи typedef ч╗Щ char* ч▒╗хЮЛхоЪф╣Йф║Жф╕Аф╕кхИлхРНя╝Мш┐Щф╕кхИлхРНх░▒цШп sdsя╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">char</span> <span class="token operator">*</span>sds<span class="token punctuation">;</span>
</code></pre></div><p>хЕ╢хоЮя╝Мш┐ЩцШпхЫаф╕║ SDS цЬмш┤иш┐ШцШпхнЧчмжцХ░ч╗Дя╝МхПкцШпхЬихнЧчмжцХ░ч╗ДхЯ║чбАф╕КхвЮхКаф║ЖщвЭхдЦчЪДхЕГцХ░цНоуАВхЬи Redis ф╕нщЬАшжБчФихИ░хнЧчмжцХ░ч╗ДцЧ╢я╝Мх░▒чЫ┤цОеф╜┐чФи sds ш┐Щф╕кхИлхРНуАВ</p> <p>хРМцЧ╢я╝МхЬихИЫх╗║цЦ░чЪДхнЧчмжф╕▓цЧ╢я╝МRedis ф╝Ъш░ГчФи SDS хИЫх╗║хЗ╜цХ░ sdsnewlenуАВsdsnewlen хЗ╜цХ░ф╝ЪцЦ░х╗║ sds ч▒╗хЮЛхПШщЗПя╝Иф╣Ях░▒цШп char* ч▒╗хЮЛхПШщЗПя╝Йя╝Мх╣╢цЦ░х╗║ SDS ч╗УцЮДф╜Уя╝МцКК SDS ч╗УцЮДф╜Уф╕нчЪДцХ░ч╗Д buf[] ш╡Лч╗Щ sds ч▒╗хЮЛхПШщЗПуАВцЬАхРОя╝Мsdsnewlen хЗ╜цХ░ф╝ЪцККшжБхИЫх╗║чЪДхнЧчмжф╕▓цЛ╖ш┤Эч╗Щ sds хПШщЗПуАВф╕ЛщЭвчЪДф╗гчаБх░▒цШ╛чд║ф║Ж sdsnewlen хЗ╜цХ░чЪДш┐Щф╕кцУНф╜ЬщА╗ш╛Ся╝Мф╜ахПпф╗ечЬЛф╕ЛуАВ</p> <div class="language-c extra-class"><pre class="language-c"><code>sds <span class="token function">sdsnewlen</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>init<span class="token punctuation">,</span> <span class="token class-name">size_t</span> initlen<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token operator">*</span>sh<span class="token punctuation">;</span>  <span class="token comment">//цМЗхРСSDSч╗УцЮДф╜УчЪДцМЗщТИ</span>
    sds s<span class="token punctuation">;</span>     <span class="token comment">//sdsч▒╗хЮЛхПШщЗПя╝МхН│char*хнЧчмжцХ░ч╗Д</span>

    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    sh <span class="token operator">=</span> <span class="token function">s_malloc</span><span class="token punctuation">(</span>hdrlen<span class="token operator">+</span>initlen<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//цЦ░х╗║SDSч╗УцЮДя╝Мх╣╢хИЖщЕНхЖЕхнШчй║щЧ┤</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    s <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>sh<span class="token operator">+</span>hdrlen<span class="token punctuation">;</span>              <span class="token comment">//sdsч▒╗хЮЛхПШщЗПцМЗхРСSDSч╗УцЮДф╜Уф╕нчЪДbufцХ░ч╗Дя╝МshцМЗхРСSDSч╗УцЮДф╜Уш╡╖хзЛф╜Нч╜оя╝МhdrlenцШпSDSч╗УцЮДф╜Уф╕нхЕГцХ░цНочЪДщХ┐х║ж</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>initlen <span class="token operator">&amp;&amp;</span> init<span class="token punctuation">)</span>
        <span class="token function">memcpy</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> init<span class="token punctuation">,</span> initlen<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//х░ЖшжБф╝ахЕечЪДхнЧчмжф╕▓цЛ╖ш┤Эч╗ЩsdsхПШщЗПs</span>
    s<span class="token punctuation">[</span>initlen<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>               <span class="token comment">//хПШщЗПsцЬлх░╛хвЮхКа\0я╝Мшбичд║хнЧчмжф╕▓ч╗УцЭЯ</span>
    <span class="token keyword">return</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>хе╜ф║Жя╝Мф║Жшзгф║Ж SDS ч╗УцЮДчЪДхоЪф╣ЙхРОя╝МцИСф╗мхЖНцЭечЬЛчЬЛя╝МчЫ╕цпФф╝ач╗Я C шпншиАхнЧчмжф╕▓я╝МSDS цУНф╜ЬцХИчОЗчЪДцФ╣ш┐Ыф╣ЛхдДуАВ</p> <h3 id="sds-цУНф╜ЬцХИчОЗ"><a href="#sds-цУНф╜ЬцХИчОЗ" class="header-anchor">#</a> SDS цУНф╜ЬцХИчОЗ</h3> <p>хЫаф╕║ SDS ч╗УцЮДф╕ншо░х╜Хф║ЖхнЧчмжцХ░ч╗Дх╖▓хНачФичЪДчй║щЧ┤хТМшвлхИЖщЕНчЪДчй║щЧ┤я╝Мш┐Щх░▒цпФф╝ач╗Я C шпншиАхоЮчО░чЪДхнЧчмжф╕▓шГ╜х╕жцЭецЫ┤щлШчЪДцУНф╜ЬцХИчОЗуАВ</p> <p>цИСш┐ШцШпф╗ехнЧчмжф╕▓ш┐╜хКацУНф╜Ьф╕║ф╛ЛуАВRedis ф╕нхоЮчО░хнЧчмжф╕▓ш┐╜хКачЪДхЗ╜цХ░цШп sds.c цЦЗф╗╢ф╕нчЪД <strong>sdscatlen хЗ╜цХ░</strong>уАВш┐Щф╕кхЗ╜цХ░чЪДхПВцХ░ф╕АхЕ▒цЬЙф╕Йф╕кя╝МхИЖхИлцШпчЫоцаЗхнЧчмжф╕▓ sуАБц║РхнЧчмжф╕▓ t хТМшжБш┐╜хКачЪДщХ┐х║ж lenя╝Мц║РчаБхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code>sds <span class="token function">sdscatlen</span><span class="token punctuation">(</span>sds s<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>t<span class="token punctuation">,</span> <span class="token class-name">size_t</span> len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//шО╖хПЦчЫоцаЗхнЧчмжф╕▓sчЪДх╜УхЙНщХ┐х║ж</span>
    <span class="token class-name">size_t</span> curlen <span class="token operator">=</span> <span class="token function">sdslen</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//ца╣цНошжБш┐╜хКачЪДщХ┐х║жlenхТМчЫоцаЗхнЧчмжф╕▓sчЪДчО░цЬЙщХ┐х║жя╝МхИдцЦнцШпхРжшжБхвЮхКацЦ░чЪДчй║щЧ┤</span>
    s <span class="token operator">=</span> <span class="token function">sdsMakeRoomFor</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token comment">//х░Жц║РхнЧчмжф╕▓tф╕нlenщХ┐х║жчЪДцХ░цНоцЛ╖ш┤ЭхИ░чЫоцаЗхнЧчмжф╕▓ч╗Ух░╛</span>
    <span class="token function">memcpy</span><span class="token punctuation">(</span>s<span class="token operator">+</span>curlen<span class="token punctuation">,</span> t<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//шо╛ч╜очЫоцаЗхнЧчмжф╕▓чЪДцЬАцЦ░щХ┐х║жя╝ЪцЛ╖ш┤ЭхЙНщХ┐х║жcurlenхКаф╕КцЛ╖ш┤ЭщХ┐х║ж</span>
    <span class="token function">sdssetlen</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> curlen<span class="token operator">+</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//цЛ╖ш┤ЭхРОя╝МхЬичЫоцаЗхнЧчмжф╕▓ч╗Ух░╛хКаф╕К\0</span>
    s<span class="token punctuation">[</span>curlen<span class="token operator">+</span>len<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>щАЪш┐ЗхИЖцЮРш┐Щф╕кхЗ╜цХ░чЪДц║РчаБя╝МцИСф╗мхПпф╗ечЬЛхИ░ sdscatlen чЪДхоЮчО░ш╛Гф╕║чоАхНХя╝МхЕ╢цЙзшбМш┐ЗчиЛхИЖф╕║ф╕Йцнея╝Ъ</p> <ul><li>щжЦхЕИя╝МшО╖хПЦчЫоцаЗхнЧчмжф╕▓чЪДх╜УхЙНщХ┐х║жя╝Мх╣╢ш░ГчФи sdsMakeRoomFor хЗ╜цХ░я╝Мца╣цНох╜УхЙНщХ┐х║жхТМшжБш┐╜хКачЪДщХ┐х║жя╝МхИдцЦнцШпхРжшжБч╗ЩчЫоцаЗхнЧчмжф╕▓цЦ░хвЮчй║щЧ┤уАВш┐Щф╕Ацнеф╕╗шжБцШпф┐ЭшпБя╝МчЫоцаЗхнЧчмжф╕▓цЬЙш╢│хдЯчЪДчй║щЧ┤цОецФ╢ш┐╜хКачЪДхнЧчмжф╕▓уАВ</li> <li>хЕ╢цмбя╝МхЬиф┐ЭшпБф║ЖчЫоцаЗхнЧчмжф╕▓чЪДчй║щЧ┤ш╢│хдЯхРОя╝Мх░Жц║РхнЧчмжф╕▓ф╕нцМЗхоЪщХ┐х║ж len чЪДцХ░цНош┐╜хКахИ░чЫоцаЗхнЧчмжф╕▓уАВ</li> <li>цЬАхРОя╝Мшо╛ч╜очЫоцаЗхнЧчмжф╕▓чЪДцЬАцЦ░щХ┐х║жуАВ</li></ul> <p>цИСчФ╗ф║Жф╕Ах╝ахЫ╛я╝МцШ╛чд║ф║Ж sdscatlen чЪДцЙзшбМш┐ЗчиЛя╝Мф╜ахПпф╗ечЬЛф╕ЛуАВ</p> <p><img src="https://echo798.oss-cn-shenzhen.aliyuncs.com/img/202409161742164.png" alt="image-20240916174222100"></p> <p>цЙАф╗ея╝МхИ░ш┐ЩщЗМф╜ах░▒шГ╜хПСчО░я╝МхТМ C шпншиАф╕нчЪДхнЧчмжф╕▓цУНф╜ЬчЫ╕цпФя╝МSDS щАЪш┐Зшо░х╜ХхнЧчмжцХ░ч╗ДчЪДф╜┐чФищХ┐х║жхТМхИЖщЕНчй║щЧ┤хдзх░Пя╝МщБ┐хЕНф║Жхп╣хнЧчмжф╕▓чЪДщБНхОЖцУНф╜Ья╝МщЩНф╜Оф║ЖцУНф╜Ьх╝АщФАя╝Мш┐Ыф╕Ацнех░▒хПпф╗ех╕охКйшп╕хдЪхнЧчмжф╕▓цУНф╜ЬцЫ┤хКащлШцХИхЬ░хоМцИРя╝МцпФхжВхИЫх╗║уАБш┐╜хКауАБхдНхИ╢уАБцпФш╛ГчнЙя╝Мш┐Щф╕Ашо╛шобцАЭцГ│щЭЮх╕╕хА╝х╛ЧцИСф╗мхнжф╣ауАВ</p> <p>цндхдЦя╝МSDS цККчЫоцаЗхнЧчмжф╕▓чЪД<strong>чй║щЧ┤цгАцЯехТМцЙйхо╣х░БшгЕхЬиф║Ж sdsMakeRoomFor хЗ╜цХ░ф╕н</strong>я╝Мх╣╢ф╕ФхЬиц╢ЙхПКхнЧчмжф╕▓чй║щЧ┤хПШхМЦчЪДцУНф╜Ьф╕ня╝МхжВш┐╜хКауАБхдНхИ╢чнЙя╝Мф╝ЪчЫ┤цОеш░ГчФишпехЗ╜цХ░уАВ</p> <p>ш┐Щф╕Ашо╛шобхоЮчО░я╝Мх░▒щБ┐хЕНф║Жх╝АхПСф║║хСШхЫах┐Шшо░ч╗ЩчЫоцаЗхнЧчмжф╕▓цЙйхо╣я╝МшАМхп╝шЗ┤цУНф╜Ьхд▒ш┤ечЪДцГЕхЖ╡уАВцпФхжВя╝МцИСф╗мф╜┐чФихЗ╜цХ░ strcpy (char *dest, const char *src) цЧ╢я╝МхжВцЮЬ src чЪДщХ┐х║жхдзф║О dest чЪДщХ┐х║жя╝Мф╗гчаБф╕нцИСф╗мф╣Яц▓бцЬЙхБЪцгАцЯечЪДшпЭя╝Мх░▒ф╝ЪщАацИРхЖЕхнШц║вхЗ║уАВцЙАф╗еш┐ЩчзНх░БшгЕцУНф╜ЬчЪДшо╛шобцАЭцГ│я╝МхРМца╖хА╝х╛ЧцИСф╗мхнжф╣ауАВ</p> <p>щВгф╣Ия╝МщЩдф║Жф╜┐чФихЕГцХ░цНошо░х╜ХхнЧчмжф╕▓цХ░ч╗ДщХ┐х║жхТМх░БшгЕцУНф╜ЬчЪДшо╛шобцАЭцГ│я╝МSDS ш┐ШцЬЙф╗Аф╣Иф╝ШчзАчЪДшо╛шобф╕ОхоЮчО░хА╝х╛ЧцИСф╗мхнжф╣ахСвя╝Яш┐Щх░▒хТМцИСхИЪцЙНч╗Щф╜аф╗Лч╗НчЪД Redis хп╣хЖЕхнШшКВчЬБчЪДщЬАц▒ВчЫ╕хЕ│ф║ЖуАВ</p> <p>цЙАф╗ецОеф╕ЛцЭея╝МцИСф╗мх░▒цЭечЬЛчЬЛ SDS хЬич╝ЦчиЛцКАх╖зф╕КцШпхжВф╜ХхоЮчО░шКВчЬБхЖЕхнШчЪДуАВ</p> <h2 id="ч┤зхЗСхЮЛхнЧчмжф╕▓ч╗УцЮДчЪДч╝ЦчиЛцКАх╖з"><a href="#ч┤зхЗСхЮЛхнЧчмжф╕▓ч╗УцЮДчЪДч╝ЦчиЛцКАх╖з" class="header-anchor">#</a> ч┤зхЗСхЮЛхнЧчмжф╕▓ч╗УцЮДчЪДч╝ЦчиЛцКАх╖з</h2> <p>хЙНщЭвцИСцПРхИ░я╝МSDS ч╗УцЮДф╕нцЬЙф╕Аф╕кхЕГцХ░цНо flagsя╝Мшбичд║чЪДцШп SDS ч▒╗хЮЛуАВф║ЛхоЮф╕Кя╝МSDS ф╕АхЕ▒шо╛шобф║Ж 5 чзНч▒╗хЮЛя╝МхИЖхИлцШп sdshdr5уАБsdshdr8уАБsdshdr16уАБsdshdr32 хТМ sdshdr64уАВш┐Щ 5 чзНч▒╗хЮЛчЪД<strong>ф╕╗шжБхМ║хИлх░▒хЬиф║О</strong>я╝МхоГф╗мцХ░цНоч╗УцЮДф╕нчЪДхнЧчмжцХ░ч╗ДчО░цЬЙщХ┐х║ж len хТМхИЖщЕНчй║щЧ┤щХ┐х║ж allocя╝Мш┐Щф╕дф╕кхЕГцХ░цНочЪДцХ░цНоч▒╗хЮЛф╕НхРМуАВ</p> <p>хЫаф╕║ sdshdr5 ш┐Щф╕Ач▒╗хЮЛ Redis х╖▓ч╗Пф╕НхЖНф╜┐чФиф║Жя╝МцЙАф╗ецИСф╗мш┐ЩщЗМф╕╗шжБцЭеф║Жшзгф╕ЛхЙйф╜ЩчЪД 4 чзНч▒╗хЮЛуАВф╗е sdshdr8 ф╕║ф╛Ля╝МхоГчЪДхоЪф╣ЙхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token keyword">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__packed__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token class-name">sdshdr8</span> <span class="token punctuation">{</span>
    <span class="token class-name">uint8_t</span> len<span class="token punctuation">;</span> <span class="token comment">/* хнЧчмжцХ░ч╗ДчО░цЬЙщХ┐х║ж*/</span>
    <span class="token class-name">uint8_t</span> alloc<span class="token punctuation">;</span> <span class="token comment">/* хнЧчмжцХ░ч╗ДчЪДх╖▓хИЖщЕНчй║щЧ┤я╝Мф╕НхМЕцЛмч╗УцЮДф╜УхТМ\0ч╗УцЭЯхнЧчмж*/</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> flags<span class="token punctuation">;</span> <span class="token comment">/* SDSч▒╗хЮЛ*/</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/*хнЧчмжцХ░ч╗Д*/</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>цИСф╗мхПпф╗ечЬЛхИ░я╝МчО░цЬЙщХ┐х║ж len хТМх╖▓хИЖщЕНчй║щЧ┤ alloc чЪДцХ░цНоч▒╗хЮЛщГ╜цШп uint8_tуАВ<strong>uint8_t цШп 8 ф╜НцЧачмжхП╖цХ┤хЮЛ</strong>я╝Мф╝ЪхНачФи 1 хнЧшКВчЪДхЖЕхнШчй║щЧ┤уАВх╜УхнЧчмжф╕▓ч▒╗хЮЛцШп sdshdr8 цЧ╢я╝МхоГшГ╜шбичд║чЪДхнЧчмжцХ░ч╗ДщХ┐х║жя╝ИхМЕцЛмцХ░ч╗ДцЬАхРОф╕Аф╜Н\0я╝Йф╕Нф╝Ъш╢Еш┐З 256 хнЧшКВя╝И2 чЪД 8 цмбцЦ╣чнЙф║О 256я╝ЙуАВ</p> <p>шАМхп╣ф║О sdshdr16уАБsdshdr32уАБsdshdr64 ф╕ЙчзНч▒╗хЮЛцЭешп┤я╝МхоГф╗мчЪД len хТМ alloc цХ░цНоч▒╗хЮЛхИЖхИлцШп uint16_tуАБuint32_tуАБuint64_tя╝МхН│хоГф╗мшГ╜шбичд║чЪДхнЧчмжцХ░ч╗ДщХ┐х║жя╝МхИЖхИлф╕Нш╢Еш┐З 2 чЪД 16 цмбцЦ╣уАБ32 цмбцЦ╣хТМ 64 цмбцЦ╣уАВш┐Щф╕дф╕кхЕГцХ░цНохРДшЗкхНачФичЪДхЖЕхнШчй║щЧ┤хЬи sdshdr16уАБsdshdr32уАБsdshdr64 ч▒╗хЮЛф╕ня╝МхИЩхИЖхИлцШп 2 хнЧшКВуАБ4 хнЧшКВхТМ 8 хнЧшКВуАВ</p> <p>хоЮщЩЕф╕Кя╝М**SDS ф╣ЛцЙАф╗ешо╛шобф╕НхРМчЪДч╗УцЮДхд┤я╝ИхН│ф╕НхРМч▒╗хЮЛя╝Йя╝МцШпф╕║ф║ЖшГ╜чБ╡ц┤╗ф┐ЭхнШф╕НхРМхдзх░ПчЪДхнЧчмжф╕▓я╝Мф╗ОшАМцЬЙцХИшКВчЬБхЖЕхнШчй║щЧ┤уАВ**хЫаф╕║хЬиф┐ЭхнШф╕НхРМхдзх░ПчЪДхнЧчмжф╕▓цЧ╢я╝Мч╗УцЮДхд┤хНачФичЪДхЖЕхнШчй║щЧ┤ф╣Яф╕Нф╕Аца╖я╝Мш┐Щца╖ф╕АцЭея╝МхЬиф┐ЭхнШх░ПхнЧчмжф╕▓цЧ╢я╝Мч╗УцЮДхд┤хНачФичй║щЧ┤ф╣ЯцпФш╛Гх░СуАВ</p> <p>хРжхИЩя╝МхБЗшо╛ SDS щГ╜шо╛шобф╕Аца╖хдзх░ПчЪДч╗УцЮДхд┤я╝МцпФхжВщГ╜ф╜┐чФи uint64_t ч▒╗хЮЛшбичд║ len хТМ allocя╝МщВгф╣ИхБЗшо╛шжБф┐ЭхнШчЪДхнЧчмжф╕▓цШп 10 ф╕кхнЧшКВя╝МшАМцндцЧ╢ч╗УцЮДхд┤ф╕н len хТМ alloc цЬмш║лх░▒хНачФиф║Ж 16 ф╕кхнЧшКВф║Жя╝МцпФф┐ЭхнШчЪДцХ░цНощГ╜хдЪф║ЖуАВцЙАф╗еш┐Щца╖чЪДшо╛шобхп╣хЖЕхнШх╣╢ф╕НхПЛхе╜я╝Мф╣Яф╕Нц╗бш╢│ Redis шКВчЬБхЖЕхнШчЪДщЬАц▒ВуАВ</p> <p>хе╜ф║Жя╝МщЩдф║Жшо╛шобф╕НхРМч▒╗хЮЛчЪДч╗УцЮДхд┤я╝МRedis хЬич╝ЦчиЛф╕Кш┐Ш<strong>ф╜┐чФиф║Жф╕УщЧичЪДч╝ЦшпСф╝ШхМЦцЭешКВчЬБхЖЕхнШчй║щЧ┤</strong>уАВхЬихИЪцЙНф╗Лч╗НчЪД sdshdr8 ч╗УцЮДхоЪф╣Йф╕ня╝МцИСф╗мхПпф╗ечЬЛхИ░я╝МхЬи struct хТМ sdshdr8 ф╣ЛщЧ┤ф╜┐чФиф║Ж<strong>attribute</strong> ((<strong>packed</strong>))я╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token keyword">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__packed__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token class-name">sdshdr8</span>
</code></pre></div><p>хЕ╢хоЮш┐ЩщЗМя╝М<strong>attribute</strong> ((<strong>packed</strong>))чЪДф╜ЬчФих░▒цШпхСКшпЙч╝ЦшпСхЩия╝МхЬич╝ЦшпС sdshdr8 ч╗УцЮДцЧ╢я╝Мф╕НшжБф╜┐чФихнЧшКВхп╣щ╜РчЪДцЦ╣х╝Пя╝МшАМцШп<strong>щЗЗчФич┤зхЗСчЪДцЦ╣х╝ПхИЖщЕНхЖЕхнШ</strong>уАВш┐ЩцШпхЫаф╕║хЬищ╗ШшодцГЕхЖ╡ф╕Ля╝Мч╝ЦшпСхЩиф╝ЪцМЙчЕз 8 хнЧшКВхп╣щ╜РчЪДцЦ╣х╝Пя╝Мч╗ЩхПШщЗПхИЖщЕНхЖЕхнШуАВф╣Ях░▒цШпшп┤я╝МхН│ф╜┐ф╕Аф╕кхПШщЗПчЪДхдзх░Пф╕НхИ░ 8 ф╕кхнЧшКВя╝Мч╝ЦшпСхЩиф╣Яф╝Ъч╗ЩхоГхИЖщЕН 8 ф╕кхнЧшКВуАВ</p> <p>ф╕║ф║ЖцЦ╣ф╛┐ф╜ачРЖшзгя╝МцИСч╗Щф╜аф╕╛ф╕кф╛ЛхнРуАВхБЗшо╛цИСхоЪф╣Йф║Жф╕Аф╕кч╗УцЮДф╜У s1я╝МхоГцЬЙф╕дф╕кцИРхСШхПШщЗПя╝Мч▒╗хЮЛхИЖхИлцШп char хТМ intя╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code>  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
  <span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">struct</span> <span class="token class-name">s1</span> <span class="token punctuation">{</span>
        <span class="token keyword">char</span> a<span class="token punctuation">;</span>
        <span class="token keyword">int</span> b<span class="token punctuation">;</span>
     <span class="token punctuation">}</span> ts1<span class="token punctuation">;</span>
     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%lu\n&quot;</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ts1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>шЩ╜чД╢ char ч▒╗хЮЛхНачФи 1 ф╕кхнЧшКВя╝Мint ч▒╗хЮЛхНачФи 4 ф╕кхнЧшКВя╝Мф╜ЖцШпхжВцЮЬф╜аш┐РшбМш┐Щцо╡ф╗гчаБя╝Мх░▒ф╝ЪхПСчО░цЙУхН░хЗ║цЭечЪДч╗УцЮЬцШп 8уАВш┐Щх░▒цШпхЫаф╕║хЬищ╗ШшодцГЕхЖ╡ф╕Ля╝Мч╝ЦшпСхЩиф╝Ъч╗Щ s1 ч╗УцЮДф╜УхИЖщЕН 8 ф╕кхнЧшКВчЪДчй║щЧ┤я╝МшАМш┐Щца╖хЕ╢ф╕нх░▒цЬЙ 3 ф╕кхнЧшКВшвлц╡кш┤╣цОЙф║ЖуАВ</p> <p>ф╕║ф║ЖшКВчЬБхЖЕхнШя╝МRedis хЬиш┐ЩцЦ╣щЭвчЪДшо╛шобф╕КхПпф╗ешп┤цШпч▓╛цЙУч╗ЖчоЧчЪДуАВцЙАф╗ея╝МRedis щЗЗчФиф║Ж<strong>attribute</strong> ((<strong>packed</strong>))х▒ЮцАзхоЪф╣Йч╗УцЮДф╜Уя╝Мш┐Щца╖ф╕АцЭея╝Мч╗УцЮДф╜УхоЮщЩЕхНачФихдЪх░СхЖЕхнШчй║щЧ┤я╝Мч╝ЦшпСхЩих░▒хИЖщЕНхдЪх░Счй║щЧ┤уАВ</p> <p>цпФхжВя╝МцИСчФи<strong>attribute</strong> ((<strong>packed</strong>))х▒ЮцАзхоЪф╣Йч╗УцЮДф╜У s2я╝МхРМца╖хМЕхРл char хТМ int ф╕дф╕кч▒╗хЮЛчЪДцИРхСШхПШщЗПя╝Мф╗гчаБхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code>  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
  <span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">struct</span> <span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>packed<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token class-name">s2</span><span class="token punctuation">{</span>
        <span class="token keyword">char</span> a<span class="token punctuation">;</span>
        <span class="token keyword">int</span> b<span class="token punctuation">;</span>
     <span class="token punctuation">}</span> ts2<span class="token punctuation">;</span>
     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%lu\n&quot;</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ts2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>х╜Уф╜аш┐РшбМш┐Щцо╡ф╗гчаБцЧ╢я╝Мф╜ахПпф╗ечЬЛхИ░я╝МцЙУхН░чЪДч╗УцЮЬцШп 5я╝Мшбичд║ч╝ЦшпСхЩичФиф║Жч┤зхЗСхЮЛхЖЕхнШхИЖщЕНя╝Мs2 ч╗УцЮДф╜УхПкхНачФи 5 ф╕кхнЧшКВчЪДчй║щЧ┤уАВ</p> <p>хе╜ф║Жя╝МцА╗шАМшиАф╣Ля╝МхжВцЮЬф╜ахЬих╝АхПСчиЛх║ПцЧ╢я╝Мх╕МцЬЫшГ╜шКВчЬБцХ░цНоч╗УцЮДчЪДхЖЕхнШх╝АщФАя╝Мх░▒хПпф╗ецКК<strong>attribute</strong> ((<strong>packed</strong>))ш┐Щф╕кч╝ЦчиЛцЦ╣ц│ХчФиш╡╖цЭеуАВ</p> <h2 id="цА╗ч╗У"><a href="#цА╗ч╗У" class="header-anchor">#</a> цА╗ч╗У</h2> <p>ш┐ЩшКВшп╛цИСф╕╗шжБч╗Щф╜аф╗Лч╗Нф║Ж Redis ф╕нхнЧчмжф╕▓чЪДшо╛шобф╕ОхоЮчО░уАВф╜ашжБчЯещБУя╝МхнЧчмжф╕▓чЪДхоЮчО░щЬАшжБшАГшЩСцУНф╜ЬщлШцХИуАБшГ╜ф┐ЭхнШф╗╗цДПф║Мш┐ЫхИ╢цХ░цНоя╝Мф╗ехПКшКВчЬБхЖЕхнШчЪДщЬАц▒ВуАВшАМ Redis ф╕ншо╛шобхоЮчО░хнЧчмжф╕▓чЪДцЦ╣х╝Пя╝Мх░▒щЭЮх╕╕хА╝х╛Чф╜ахнжф╣ахТМхАЯщЙ┤уАВ</p> <p>хЫацндш┐ЩшКВшп╛я╝Мф╜ащЬАшжБщЗНчВ╣хЕ│ц│иф╕Йф╕кшжБчВ╣я╝МхИЖхИлцШпя╝Ъ</p> <ul><li>C шпншиАф╕нф╜┐чФи char* хоЮчО░хнЧчмжф╕▓чЪДф╕Нш╢│я╝Мф╕╗шжБцШпхЫаф╕║ф╜┐чФитАЬ\0тАЭшбичд║хнЧчмжф╕▓ч╗УцЭЯя╝МцУНф╜ЬцЧ╢щЬАщБНхОЖхнЧчмжф╕▓я╝МцХИчОЗф╕НщлШя╝Мх╣╢ф╕ФцЧац│ХхоМцХ┤шбичд║хМЕхРлтАЬ\0тАЭчЪДцХ░цНоя╝МхЫашАМш┐Щх░▒цЧац│Хц╗бш╢│ Redis чЪДщЬАц▒ВуАВ</li> <li>Redis ф╕нхнЧчмжф╕▓чЪДшо╛шобцАЭцГ│ф╕ОхоЮчО░цЦ╣ц│ХуАВRedis ф╕УщЧишо╛шобф║Ж SDS цХ░цНоч╗УцЮДя╝МхЬихнЧчмжцХ░ч╗ДчЪДхЯ║чбАф╕Кя╝МхвЮхКаф║ЖхнЧчмжцХ░ч╗ДщХ┐х║жхТМхИЖщЕНчй║щЧ┤хдзх░ПчнЙхЕГцХ░цНоуАВш┐Щца╖ф╕АцЭея╝МщЬАшжБхЯ║ф║ОхнЧчмжф╕▓щХ┐х║жш┐ЫшбМчЪДш┐╜хКауАБхдНхИ╢уАБцпФш╛ГчнЙцУНф╜Ья╝Мх░▒хПпф╗ечЫ┤цОешп╗хПЦхЕГцХ░цНоя╝МцХИчОЗф╣Ях░▒цПРхНЗф║ЖуАВшАМф╕Фя╝МSDS ф╕НщАЪш┐ЗхнЧчмжф╕▓ф╕нчЪДтАЬ\0тАЭхнЧчмжхИдцЦнхнЧчмжф╕▓ч╗УцЭЯя╝МшАМцШпчЫ┤цОех░ЖхЕ╢ф╜Ьф╕║ф║Мш┐ЫхИ╢цХ░цНохдДчРЖя╝МхПпф╗ечФицЭеф┐ЭхнШхЫ╛чЙЗчнЙф║Мш┐ЫхИ╢цХ░цНоуАВ</li> <li>SDS ф╕нцШпщАЪш┐Зшо╛шобф╕НхРМ SDS ч▒╗хЮЛцЭешбичд║ф╕НхРМхдзх░ПчЪДхнЧчмжф╕▓я╝Мх╣╢ф╜┐чФи<strong>attribute</strong> ((<strong>packed</strong>))ш┐Щф╕кч╝ЦчиЛх░ПцКАх╖зя╝МцЭехоЮчО░ч┤зхЗСхЮЛхЖЕхнШх╕Гх▒Ая╝Мш╛╛хИ░шКВчЬБхЖЕхнШчЪДчЫочЪДуАВ</li></ul> <p>хнЧчмжф╕▓чЬЛш╡╖цЭечоАхНХя╝Мф╜ЖщАЪш┐Зф╗Кхдйш┐ЩшКВшп╛чЪДхнжф╣ая╝Мф╜ахПпф╗ечЬЛхИ░хоЮчО░хнЧчмжф╕▓цЬЙх╛ИхдЪщЬАшжБч▓╛х╖зшо╛шобчЪДхЬ░цЦ╣уАВC шпншиАхнЧчмжф╕▓чЪДхоЮчО░цЦ╣ц│ХхТМ SDS чЪДшБФч│╗ф╕ОхМ║хИля╝Мф╣ЯцШп Redis щЭвшпХцЧ╢ч╗Пх╕╕ф╝ЪшвлщЧохИ░чЪДщЧощвШя╝МцЙАф╗ецИСф╣Ях╕МцЬЫф╜ашГ╜щАЪш┐Зф╗Кхдйш┐ЩшКВшп╛я╝МцОМцПбхе╜хоГф┐йчЪДхМ║хИлуАВ</p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/echo-lxy/echo-system-design/edit/master/docs/01.Redis ч│╗ч╗Яшо╛шоб/02.хЯ║чбА/01.String.md" target="_blank" rel="noopener noreferrer">ч╝Цш╛С</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">ф╕КцмбцЫ┤цЦ░:</span> <span class="time">2024/09/16, 10:01:40</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:lixinyang2002@163.com" title="хПСщВоф╗╢" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/echo-lxy" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="хРмщЯ│ф╣Р" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="цЬмчлЩф╕╗щвШ">Vdoing</a> 
    | Copyright ┬й 2024-2024
    <span>Xinyang Li | MIT License</span></div> <div class="buttons"><div title="ш┐ФхЫЮщб╢щГи" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="хО╗шпДшо║" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ф╕╗щвШцибх╝П" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          ш╖ЯщЪПч│╗ч╗Я
        </li><li class="iconfont icon-rijianmoshi">
          ц╡ЕшЙ▓цибх╝П
        </li><li class="iconfont icon-yejianmoshi">
          ц╖▒шЙ▓цибх╝П
        </li><li class="iconfont icon-yuedu">
          щШЕшп╗цибх╝П
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e6c7c0bc.js" defer></script><script src="/assets/js/2.c1dbdf51.js" defer></script><script src="/assets/js/8.f8705c03.js" defer></script>
  </body>
</html>
