<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ZSet | Echo ч│╗ч╗Яшо╛шобф╣Лч╛О</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="ц░┤ц╗┤чЯ│чй┐я╝Мшо╛шобцЧащУ╢х╝╣">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.3b389ff4.css" as="style"><link rel="preload" href="/assets/js/app.e6c7c0bc.js" as="script"><link rel="preload" href="/assets/js/2.c1dbdf51.js" as="script"><link rel="preload" href="/assets/js/11.4b96b543.js" as="script"><link rel="prefetch" href="/assets/js/10.ce9e2824.js"><link rel="prefetch" href="/assets/js/12.2feff802.js"><link rel="prefetch" href="/assets/js/13.4332a769.js"><link rel="prefetch" href="/assets/js/14.464e0155.js"><link rel="prefetch" href="/assets/js/15.0d61cf57.js"><link rel="prefetch" href="/assets/js/16.506c965c.js"><link rel="prefetch" href="/assets/js/17.0b9e4b65.js"><link rel="prefetch" href="/assets/js/18.c7917c05.js"><link rel="prefetch" href="/assets/js/19.fad48692.js"><link rel="prefetch" href="/assets/js/20.ff68a659.js"><link rel="prefetch" href="/assets/js/21.93b2e430.js"><link rel="prefetch" href="/assets/js/22.e8989777.js"><link rel="prefetch" href="/assets/js/23.de5a9e3c.js"><link rel="prefetch" href="/assets/js/24.914d458e.js"><link rel="prefetch" href="/assets/js/25.b6565a06.js"><link rel="prefetch" href="/assets/js/26.977f0fd3.js"><link rel="prefetch" href="/assets/js/27.7bde72bc.js"><link rel="prefetch" href="/assets/js/28.e34d1ee9.js"><link rel="prefetch" href="/assets/js/29.b4c0912f.js"><link rel="prefetch" href="/assets/js/3.d5abcf7b.js"><link rel="prefetch" href="/assets/js/30.662f616d.js"><link rel="prefetch" href="/assets/js/31.8a8e803f.js"><link rel="prefetch" href="/assets/js/32.b41ef25a.js"><link rel="prefetch" href="/assets/js/33.24569bcc.js"><link rel="prefetch" href="/assets/js/34.dac446b7.js"><link rel="prefetch" href="/assets/js/35.f6fabb4e.js"><link rel="prefetch" href="/assets/js/36.85b2b5dc.js"><link rel="prefetch" href="/assets/js/37.da59a00f.js"><link rel="prefetch" href="/assets/js/38.655f6ff9.js"><link rel="prefetch" href="/assets/js/39.b0056866.js"><link rel="prefetch" href="/assets/js/4.d946b097.js"><link rel="prefetch" href="/assets/js/40.3ddc2c59.js"><link rel="prefetch" href="/assets/js/41.16557a6f.js"><link rel="prefetch" href="/assets/js/42.0e64221c.js"><link rel="prefetch" href="/assets/js/43.7976c385.js"><link rel="prefetch" href="/assets/js/44.71553edf.js"><link rel="prefetch" href="/assets/js/45.1313072b.js"><link rel="prefetch" href="/assets/js/46.c2baf55f.js"><link rel="prefetch" href="/assets/js/47.635abf6e.js"><link rel="prefetch" href="/assets/js/48.c68ae1bc.js"><link rel="prefetch" href="/assets/js/49.0ded727d.js"><link rel="prefetch" href="/assets/js/5.39afb5af.js"><link rel="prefetch" href="/assets/js/50.e00d3a7e.js"><link rel="prefetch" href="/assets/js/51.9da875f4.js"><link rel="prefetch" href="/assets/js/52.d552ff92.js"><link rel="prefetch" href="/assets/js/53.dffecfdc.js"><link rel="prefetch" href="/assets/js/54.e64b0f07.js"><link rel="prefetch" href="/assets/js/55.bf7710d3.js"><link rel="prefetch" href="/assets/js/56.2d336989.js"><link rel="prefetch" href="/assets/js/6.7a2f25e5.js"><link rel="prefetch" href="/assets/js/7.a5188780.js"><link rel="prefetch" href="/assets/js/8.f8705c03.js"><link rel="prefetch" href="/assets/js/9.b279253b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3b389ff4.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="чЫох╜Х" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Echo ч│╗ч╗Яшо╛шобф╣Лч╛О" class="logo"> <span class="site-name can-hide">Echo ч│╗ч╗Яшо╛шобф╣Лч╛О</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">ЁЯПащжЦщб╡</a></div><div class="nav-item"><a href="/pages/fccd91/" class="nav-link">тЬТя╕ПчГнщЧичоЧц│Х</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕" class="dropdown-title"><!----> <span class="title" style="display:;">ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/252196/" class="nav-link">Redis ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/pages/b9733b/" class="nav-link">Kafka ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/pages/4601ca/" class="nav-link">Nginx ч│╗ч╗Яшо╛шоб</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ЁЯзСтАНЁЯТ╗хоЮцИШч│╗ч╗Яшо╛шоб" class="dropdown-title"><!----> <span class="title" style="display:;">ЁЯзСтАНЁЯТ╗хоЮцИШч│╗ч╗Яшо╛шоб</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/84cb49/" class="nav-link">шо╛шобхЯ║чбАшо╛цЦ╜</a></li><li class="dropdown-item"><!----> <a href="/pages/a95d7d/" class="nav-link">шо╛шобчГнщЧих║ФчФи</a></li><li class="dropdown-item"><!----> <a href="/pages/def08a/" class="nav-link">хЬ║цЩпшо╛шоб</a></li></ul></div></div><div class="nav-item"><a href="/pages/92b2ee/" class="nav-link">тЭУщЧочнФ</a></div><div class="nav-item"><a href="/pages/52ebd8/" class="nav-link">ЁЯСАхКицАБ</a></div> <a href="https://github.com/echo-lxy/echo-system-design" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">ЁЯПащжЦщб╡</a></div><div class="nav-item"><a href="/pages/fccd91/" class="nav-link">тЬТя╕ПчГнщЧичоЧц│Х</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕" class="dropdown-title"><!----> <span class="title" style="display:;">ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/252196/" class="nav-link">Redis ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/pages/b9733b/" class="nav-link">Kafka ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/pages/4601ca/" class="nav-link">Nginx ч│╗ч╗Яшо╛шоб</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ЁЯзСтАНЁЯТ╗хоЮцИШч│╗ч╗Яшо╛шоб" class="dropdown-title"><!----> <span class="title" style="display:;">ЁЯзСтАНЁЯТ╗хоЮцИШч│╗ч╗Яшо╛шоб</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/84cb49/" class="nav-link">шо╛шобхЯ║чбАшо╛цЦ╜</a></li><li class="dropdown-item"><!----> <a href="/pages/a95d7d/" class="nav-link">шо╛шобчГнщЧих║ФчФи</a></li><li class="dropdown-item"><!----> <a href="/pages/def08a/" class="nav-link">хЬ║цЩпшо╛шоб</a></li></ul></div></div><div class="nav-item"><a href="/pages/92b2ee/" class="nav-link">тЭУщЧочнФ</a></div><div class="nav-item"><a href="/pages/52ebd8/" class="nav-link">ЁЯСАхКицАБ</a></div> <a href="https://github.com/echo-lxy/echo-system-design" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>цМЗхНЧ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/252196/" class="sidebar-link">ф╗Лч╗Н</a></li><li><a href="/pages/69fbd7/" class="sidebar-link">Redis ф╝кчаБшУЭхЫ╛уАРх┐ЕчЬЛуАС</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>хЯ║чбА</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/ee2b16/" class="sidebar-link">list</a></li><li><a href="/pages/2d4311/" class="sidebar-link">Hash</a></li><li><a href="/pages/c7cf4a/" aria-current="page" class="active sidebar-link">ZSet</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/c7cf4a/#хЙНшиА" class="sidebar-link">хЙНшиА</a></li><li class="sidebar-sub-header level2"><a href="/pages/c7cf4a/#sorted-set-хЯ║цЬмч╗УцЮД" class="sidebar-link">Sorted Set хЯ║цЬмч╗УцЮД</a></li><li class="sidebar-sub-header level2"><a href="/pages/c7cf4a/#ш╖│шбичЪДшо╛шобф╕ОхоЮчО░" class="sidebar-link">ш╖│шбичЪДшо╛шобф╕ОхоЮчО░</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/c7cf4a/#ш╖│шбицХ░цНоч╗УцЮД" class="sidebar-link">ш╖│шбицХ░цНоч╗УцЮД</a></li><li class="sidebar-sub-header level3"><a href="/pages/c7cf4a/#ш╖│шбич╗УчВ╣цЯешпв" class="sidebar-link">ш╖│шбич╗УчВ╣цЯешпв</a></li><li class="sidebar-sub-header level3"><a href="/pages/c7cf4a/#ш╖│шбич╗УчВ╣х▒ВцХ░шо╛ч╜о" class="sidebar-link">ш╖│шбич╗УчВ╣х▒ВцХ░шо╛ч╜о</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/c7cf4a/#хУИх╕МшбихТМш╖│шбичЪДч╗ДхРИф╜┐чФи" class="sidebar-link">хУИх╕МшбихТМш╖│шбичЪДч╗ДхРИф╜┐чФи</a></li><li class="sidebar-sub-header level2"><a href="/pages/c7cf4a/#цА╗ч╗У" class="sidebar-link">цА╗ч╗У</a></li></ul></li><li><a href="/pages/2ab65e/" class="sidebar-link">хЖЕхнШхПЛхе╜чЪДцХ░цНоч╗УцЮДшпехжВф╜Хч╗ЖхМЦшо╛шобя╝Я</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ф╕╗ч║┐</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/d4ecb9/" class="sidebar-link">Redis Server хИЭхзЛхМЦ</a></li><li><a href="/pages/34fa27/" class="sidebar-link">Linux ф╕нчЪД IO хдЪш╖пхдНчФи</a></li><li><a href="/pages/d6b00d/" class="sidebar-link">Redis чЪД Reactor цибхЮЛ</a></li><li><a href="/pages/264b06/" class="sidebar-link">ц╖▒хЕе Redis ф║Лф╗╢щй▒хКицбЖцЮ╢</a></li><li><a href="/pages/e6d8ef/" class="sidebar-link">Redis чЪДцЙзшбМцибх╝П</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>цФпч║┐</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/b43a19/" class="sidebar-link">LRU чнЦчХе</a></li><li><a href="/pages/b43a89/" class="sidebar-link">LFU чнЦчХе</a></li><li><a href="/pages/f44fbe/" class="sidebar-link">Redis ш┐ЗцЬЯчнЦчХе</a></li><li><a href="/pages/9b17a6/" class="sidebar-link">RDB цМБф╣ЕхМЦ</a></li><li><a href="/pages/9b17a7/" class="sidebar-link">AOF цМБф╣ЕхМЦ</a></li><li><a href="/pages/aa75e9/" class="sidebar-link">Redis ф╕нчЪДх╗╢ш┐ЯчЫСцОз</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>щЫЖч╛д</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/ebc8dc/" class="sidebar-link">ф╕╗ф╗ОхдНхИ╢</a></li><li><a href="/pages/af8752/" class="sidebar-link">хУихЕ╡</a></li><li><a href="/pages/040403/" class="sidebar-link">cluster</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="щжЦщб╡" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>Redis ч│╗ч╗Яшо╛шоб</span></li><li data-v-06225672><span data-v-06225672>хЯ║чбА</span></li></ul> <div class="info" data-v-06225672><div title="ф╜ЬшАЕ" class="author iconfont icon-touxiang" data-v-06225672><a href="https://gitee.com/brother-one" target="_blank" title="ф╜ЬшАЕ" class="beLink" data-v-06225672>echo</a></div> <div title="хИЫх╗║цЧ╢щЧ┤" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-09-16</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">чЫох╜Х</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">ZSet<!----></h1> <div class="page-slot page-slot-top">
    <div class="wwads-cn wwads-horizontal page-wwads" data-id="136"></div>
    <style>
      .page-wwads{
        width:100%!important;
        min-height: 0;
        margin: 0;
      }
      .page-wwads .wwads-img img{
        width:80px!important;
      }
      .page-wwads .wwads-poweredby{
        width: 40px;
        position: absolute;
        right: 25px;
        bottom: 3px;
      }
      .wwads-content .wwads-text, .page-wwads .wwads-text{
        height: 100%;
        padding-top: 5px;
        display: block;
      }
  </style>
  </div> <div class="theme-vdoing-content content__default"><h2 id="хЙНшиА"><a href="#хЙНшиА" class="header-anchor">#</a> хЙНшиА</h2> <p>цЬЙх║ПщЫЖхРИя╝ИSorted Setя╝ЙцШп Redis ф╕нф╕АчзНщЗНшжБчЪДцХ░цНоч▒╗хЮЛя╝МхоГцЬмш║лцШпщЫЖхРИч▒╗хЮЛя╝МхРМцЧ╢ф╣ЯхПпф╗ецФпцМБщЫЖхРИф╕нчЪДхЕГч┤ах╕жцЬЙцЭГщЗНя╝Мх╣╢цМЙцЭГщЗНцОТх║ПуАВ</p> <p>шАМцЫ╛ч╗Пх░▒цЬЙф╕Аф╜Нф╗Оф║Л Redis х╝АхПСчЪДхРМхнжщЧоцИСя╝Ъф╕║ф╗Аф╣И Sorted Set шГ╜хРМцЧ╢цПРф╛Ыф╗еф╕Лф╕дчзНцУНф╜ЬцОехПгя╝Мф╗ехПКхоГф╗мчЪДхдНцЭВх║жхИЖхИлцШп O(logN)+M хТМ O(1) хСвя╝Я</p> <ul><li>ZRANGEBYSCOREя╝ЪцМЙчЕзхЕГч┤ацЭГщЗНш┐ФхЫЮф╕Аф╕кшМГхЫ┤хЖЕчЪДхЕГч┤ауАВ</li> <li>ZSCOREя╝Ъш┐ФхЫЮцЯРф╕кхЕГч┤ачЪДцЭГщЗНхА╝уАВ</li></ul> <p>хоЮщЩЕф╕Кя╝Мш┐Щф╕кщЧощвШшГМхРОчЪДцЬмш┤ицШпя╝Ъ<strong>ф╕║ф╗Аф╣И Sorted Set цЧвшГ╜цФпцМБщлШцХИчЪДшМГхЫ┤цЯешпвя╝МхРМцЧ╢ш┐ШшГ╜ф╗е O(1) хдНцЭВх║жшО╖хПЦхЕГч┤ацЭГщЗНхА╝я╝Я</strong></p> <p>ш┐ЩхЕ╢хоЮх░▒хТМ Sorted Set х║Хх▒ВчЪДшо╛шобхоЮчО░цЬЙхЕ│ф║ЖуАВSorted Set шГ╜цФпцМБшМГхЫ┤цЯешпвя╝Мш┐ЩцШпхЫаф╕║хоГчЪДца╕х┐ГцХ░цНоч╗УцЮДшо╛шобщЗЗчФиф║Жш╖│шбия╝МшАМхоГхПИшГ╜ф╗ех╕╕цХ░хдНцЭВх║жшО╖хПЦхЕГч┤ацЭГщЗНя╝Мш┐ЩцШпхЫаф╕║хоГхРМцЧ╢щЗЗчФиф║ЖхУИх╕Мшбиш┐ЫшбМч┤вх╝ХуАВ</p> <p>щВгф╣Ия╝Мф╜ацШпф╕НцШпх╛Ихе╜хеЗя╝МSorted Set цШпхжВф╜ХцККш┐Щф╕дчзНцХ░цНоч╗УцЮДч╗УхРИхЬиф╕Аш╡╖чЪДя╝ЯхоГф╗мхПИцШпхжВф╜Хш┐ЫшбМхНПф╜ЬчЪДхСвя╝Яф╗Кхдйш┐ЩшКВшп╛я╝МцИСх░▒цЭеч╗Щф╜аф╗Лч╗Нф╕Л Sorted Set щЗЗчФичЪДхПМч┤вх╝ХчЪДшо╛шобцАЭцГ│хТМхоЮчО░уАВчРЖшзгхТМцОМцПбш┐ЩчзНхПМч┤вх╝ХчЪДшо╛шобцАЭцГ│я╝Мхп╣ф║ОцИСф╗мхоЮчО░цХ░цНох║Уч│╗ч╗ЯцШпхЕ╖цЬЙщЭЮх╕╕щЗНшжБчЪДхПВшАГф╗╖хА╝чЪДуАВ</p> <p>хе╜я╝МцОеф╕ЛцЭея╝МцИСф╗мх░▒хЕИцЭечЬЛчЬЛ Sorted Set чЪДхЯ║цЬмч╗УцЮДуАВ</p> <h2 id="sorted-set-хЯ║цЬмч╗УцЮД"><a href="#sorted-set-хЯ║цЬмч╗УцЮД" class="header-anchor">#</a> Sorted Set хЯ║цЬмч╗УцЮД</h2> <p>шжБцГ│ф║Жшзг Sorted Set чЪДч╗УцЮДя╝Мх░▒щЬАшжБщШЕшп╗хоГчЪДф╗гчаБцЦЗф╗╢уАВш┐ЩщЗМф╜ащЬАшжБц│ицДПчЪДцШпя╝МхЬи Redis ц║РчаБф╕ня╝МSorted Set чЪДф╗гчаБцЦЗф╗╢хТМхЕ╢ф╗ЦцХ░цНоч▒╗хЮЛф╕Нхдкф╕Аца╖я╝МхоГх╣╢ф╕НхГПхУИх╕МшбичЪД dict.c/dict.hя╝МцИЦцШпхОЛч╝йхИЧшбичЪД ziplist.c/ziplist.hя╝МхЕ╖цЬЙф╕УщЧичЪДцХ░цНоч╗УцЮДхоЮчО░хТМхоЪф╣ЙцЦЗф╗╢уАВ</p> <p>Sorted Set чЪД<strong>хоЮчО░ф╗гчаБхЬи</strong><a href="https://github.com/redis/redis/blob/5.0/src/t_zset.c" target="_blank" rel="noopener noreferrer">t_zset.c<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><strong>цЦЗф╗╢ф╕н</strong>я╝МхМЕцЛм Sorted Set чЪДхРДчзНцУНф╜ЬхоЮчО░я╝МхРМцЧ╢ Sorted Set чЫ╕хЕ│чЪД<strong>ч╗УцЮДхоЪф╣ЙхЬи</strong><a href="https://github.com/redis/redis/blob/5.0/src/server.h" target="_blank" rel="noopener noreferrer">server.h<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><strong>цЦЗф╗╢ф╕н</strong>уАВхжВцЮЬф╜ацГ│шжБф║Жшзгхнжф╣а Sorted Set чЪДцибхЭЧхТМцУНф╜Ья╝Мц│ицДПшжБф╗О t_zset.c хТМ server.h ш┐Щф╕дф╕кцЦЗф╗╢ф╕нцЯецЙ╛уАВ</p> <p>хе╜я╝МхЬичЯещБУф║Ж Sorted Set цЙАхЬичЪДф╗гчаБцЦЗф╗╢ф╣ЛхРОя╝МцИСф╗мхПпф╗ехЕИцЭечЬЛф╕ЛхоГчЪДч╗УцЮДхоЪф╣ЙуАВSorted Set ч╗УцЮДф╜УчЪДхРНчз░ф╕║ zsetя╝МхЕ╢ф╕нхМЕхРлф║Жф╕дф╕кцИРхСШя╝МхИЖхИлцШпхУИх╕Мшби dict хТМш╖│шби zslя╝МхжВф╕ЛцЙАчд║уАВ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">zset</span> <span class="token punctuation">{</span>
    dict <span class="token operator">*</span>dict<span class="token punctuation">;</span>
    zskiplist <span class="token operator">*</span>zsl<span class="token punctuation">;</span>
<span class="token punctuation">}</span> zset<span class="token punctuation">;</span>
</code></pre></div><p>хЬиш┐ЩшКВшп╛ф╕Ах╝АхзЛя╝МцИСх░▒шп┤ш┐З Sorted Set ш┐ЩчзНхРМцЧ╢щЗЗчФиш╖│шбихТМхУИх╕Мшбиф╕дф╕кч┤вх╝Хч╗УцЮДчЪДшо╛шобцАЭцГ│я╝МцШпщЭЮх╕╕хА╝х╛Чхнжф╣ачЪДуАВхЫаф╕║ш┐ЩчзНшо╛шобцАЭцГ│хЕЕхИЖхИйчФиф║Жш╖│шбищлШцХИцФпцМБшМГхЫ┤цЯешпвя╝ИхжВ ZRANGEBYSCORE цУНф╜Ья╝Йя╝Мф╗ехПКхУИх╕МшбищлШцХИцФпцМБхНХчВ╣цЯешпвя╝ИхжВ ZSCORE цУНф╜Ья╝ЙчЪДчЙ╣х╛БуАВш┐Щца╖ф╕АцЭея╝МцИСф╗мх░▒хПпф╗ехЬиф╕Аф╕кцХ░цНоч╗УцЮДф╕ня╝МхРМцЧ╢щлШцХИцФпцМБшМГхЫ┤цЯешпвхТМхНХчВ╣цЯешпвя╝Мш┐ЩцШпхНХф╕Ач┤вх╝Хч╗УцЮДцпФш╛ГщЪ╛ш╛╛хИ░чЪДцХИцЮЬуАВ</p> <p>ф╕Нш┐Зя╝МцЧвчД╢ Sorted Set щЗЗчФиф║Жш╖│шбихТМхУИх╕Мшбиф╕дчзНч┤вх╝Хч╗УцЮДцЭеч╗Дч╗ЗцХ░цНоя╝МцИСф╗мхЬихоЮчО░ Sorted Set цЧ╢х░▒ф╝ЪщЭвф╕┤ф╗еф╕Лф╕дф╕кщЧощвШя╝Ъ</p> <ul><li><strong>ш╖│шбицИЦцШпхУИх╕Мшбиф╕ня╝МхРДшЗкф┐ЭхнШф║Жф╗Аф╣Ица╖чЪДцХ░цНоя╝Я</strong></li> <li><strong>ш╖│шбихТМхУИх╕Мшбиф┐ЭхнШчЪДцХ░цНоцШпхжВф╜Хф┐ЭцМБф╕АшЗ┤чЪДя╝Я</strong></li></ul> <p>хЫаф╕║цИСх╖▓ч╗ПхЬиуАРчмм 3 шо▓уАСф╕нч╗Щф╜аф╗Лч╗Нф║Ж Redis ф╕нхУИх╕МшбичЪДхоЮчО░цАЭш╖пя╝МцЙАф╗ецОеф╕ЛцЭея╝МцИСф╕╗шжБцШпч╗Щф╜аф╗Лч╗Нф╕Лш╖│шбичЪДшо╛шобхТМхоЮчО░уАВщАЪш┐Зхнжф╣аш╖│шбия╝Мф╜ахПпф╗еф║ЖшзгхИ░ш╖│шбиф╕нф┐ЭхнШчЪДцХ░цНоя╝Мф╗ехПКш╖│шбичЪДх╕╕шзБцУНф╜ЬуАВчД╢хРОя╝МцИСхЖНх╕жф╜ацЭецОвчй╢ф╕Л Sorted Set хжВф╜Хх░ЖхУИх╕МшбихТМш╖│шбич╗ДхРИш╡╖цЭеф╜┐чФичЪДя╝Мф╗ехПКш┐Щф╕дф╕кч┤вх╝Хч╗УцЮДф╕нчЪДцХ░цНоцШпхжВф╜Хф┐ЭцМБф╕АшЗ┤чЪДуАВ</p> <h2 id="ш╖│шбичЪДшо╛шобф╕ОхоЮчО░"><a href="#ш╖│шбичЪДшо╛шобф╕ОхоЮчО░" class="header-anchor">#</a> ш╖│шбичЪДшо╛шобф╕ОхоЮчО░</h2> <p>щжЦхЕИя╝МцИСф╗мцЭеф║Жшзгф╕Лф╗Аф╣ИцШпш╖│шбия╝Иskiplistя╝ЙуАВ</p> <p>ш╖│шбихЕ╢хоЮцШпф╕АчзНхдЪх▒ВчЪДцЬЙх║ПщУ╛шбиуАВхЬишп╛чиЛф╕ня╝Мф╕║ф║Жф╛┐ф║Ошп┤цШОя╝МцИСцККш╖│шбиф╕нчЪДх▒Вцмбф╗Оф╜ОхИ░щлШцОТф╕кх║Пя╝МцЬАх║Хф╕Лф╕Ах▒Вчз░ф╕║ level0я╝Мф╛Эцмбх╛Аф╕КцШп level1уАБlevel2 чнЙуАВ</p> <p>ф╕ЛхЫ╛х▒Хчд║чЪДцШпф╕Аф╕к 3 х▒ВчЪДш╖│шбиуАВхЕ╢ф╕ня╝Мхд┤ч╗УчВ╣ф╕нхМЕхРлф║Жф╕Йф╕кцМЗщТИя╝МхИЖхИлф╜Ьф╕║ leve0 хИ░ level2 ф╕КчЪДхд┤цМЗщТИуАВ</p> <p>![img](https://learn.lianglianglee.com/ф╕УцаП/Redis ц║РчаБхЙЦцЮРф╕ОхоЮцИШ/assets/35b2c22120952e1fac46147664e75b23-20221013234921-42s0bzg.jpg)</p> <p>хПпф╗ечЬЛхИ░я╝МхЬи level 0 ф╕Кф╕АхЕ▒цЬЙ 7 ф╕кч╗УчВ╣я╝МхИЖхИлцШп 3уАБ11уАБ23уАБ33уАБ42уАБ51уАБ62я╝Мш┐Щф║Ыч╗УчВ╣ф╝ЪщАЪш┐ЗцМЗщТИш┐ЮцОеш╡╖цЭея╝МхРМцЧ╢хд┤ч╗УчВ╣ф╕нчЪД level0 цМЗщТИф╝ЪцМЗхРСч╗УчВ╣ 3уАВчД╢хРОя╝МхЬиш┐Щ 7 ф╕кч╗УчВ╣ф╕ня╝Мч╗УчВ╣ 11уАБ33 хТМ 51 хПИщГ╜хМЕхРлф║Жф╕Аф╕кцМЗщТИя╝МхРМца╖ф╣Яф╛Эцмбш┐ЮцОеш╡╖цЭея╝Мф╕Фхд┤ч╗УчВ╣чЪД level 1 цМЗщТИф╝ЪцМЗхРСч╗УчВ╣ 11уАВш┐Щца╖ф╕АцЭея╝Мш┐Щ 3 ф╕кч╗УчВ╣х░▒ч╗ДцИРф║Ж level 1 ф╕КчЪДцЙАцЬЙч╗УчВ╣уАВ</p> <p>цЬАхРОя╝Мч╗УчВ╣ 33 ф╕нш┐ШхМЕхРлф║Жф╕Аф╕кцМЗщТИя╝Мш┐Щф╕кцМЗщТИф╝ЪцМЗхРСх░╛ч╗УчВ╣я╝МхРМцЧ╢я╝Мхд┤ч╗УчВ╣чЪД level 2 цМЗщТИф╝ЪцМЗхРСч╗УчВ╣ 33я╝Мш┐Щх░▒х╜вцИРф║Ж level 2я╝МхПкф╕Нш┐З level 2 ф╕КхПкцЬЙ 1 ф╕кч╗УчВ╣ 33уАВ</p> <p>хе╜я╝МхЬихп╣ш╖│шбицЬЙф║ЖчЫ┤шзВхН░ш▒бхРОя╝МцИСф╗мхЖНцЭечЬЛчЬЛш╖│шбихоЮчО░чЪДхЕ╖ф╜УцХ░цНоч╗УцЮДуАВ</p> <h3 id="ш╖│шбицХ░цНоч╗УцЮД"><a href="#ш╖│шбицХ░цНоч╗УцЮД" class="header-anchor">#</a> ш╖│шбицХ░цНоч╗УцЮД</h3> <p>цИСф╗мхЕИцЭечЬЛф╕Лш╖│шбич╗УчВ╣чЪДч╗УцЮДхоЪф╣Йя╝МхжВф╕ЛцЙАчд║уАВ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">zskiplistNode</span> <span class="token punctuation">{</span>
    <span class="token comment">//Sorted Setф╕нчЪДхЕГч┤а</span>
    sds ele<span class="token punctuation">;</span>
    <span class="token comment">//хЕГч┤ацЭГщЗНхА╝</span>
    <span class="token keyword">double</span> score<span class="token punctuation">;</span>
    <span class="token comment">//хРОхРСцМЗщТИ</span>
    <span class="token keyword">struct</span> <span class="token class-name">zskiplistNode</span> <span class="token operator">*</span>backward<span class="token punctuation">;</span>
    <span class="token comment">//шКВчВ╣чЪДlevelцХ░ч╗Дя╝Мф┐ЭхнШцпПх▒Вф╕КчЪДхЙНхРСцМЗщТИхТМш╖их║ж</span>
    <span class="token keyword">struct</span> <span class="token class-name">zskiplistLevel</span> <span class="token punctuation">{</span>
        <span class="token keyword">struct</span> <span class="token class-name">zskiplistNode</span> <span class="token operator">*</span>forward<span class="token punctuation">;</span>
        <span class="token keyword">unsigned</span> <span class="token keyword">long</span> span<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> level<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> zskiplistNode<span class="token punctuation">;</span>
</code></pre></div><p>щжЦхЕИя╝МхЫаф╕║ Sorted Set ф╕нцЧвшжБф┐ЭхнШхЕГч┤ая╝Мф╣ЯшжБф┐ЭхнШхЕГч┤ачЪДцЭГщЗНя╝МцЙАф╗ехп╣х║ФхИ░ш╖│шбич╗УчВ╣чЪДч╗УцЮДхоЪф╣Йф╕ня╝Мх░▒хп╣х║Фф║Ж sds ч▒╗хЮЛчЪДхПШщЗП eleя╝Мф╗ехПК double ч▒╗хЮЛчЪДхПШщЗП scoreуАВцндхдЦя╝Мф╕║ф║Жф╛┐ф║Оф╗Ош╖│шбичЪДх░╛ч╗УчВ╣ш┐ЫшбМхАТх║ПцЯецЙ╛я╝МцпПф╕кш╖│шбич╗УчВ╣ф╕нш┐Шф┐ЭхнШф║Жф╕Аф╕кхРОхРСцМЗщТИя╝И*backwardя╝Йя╝МцМЗхРСшпеч╗УчВ╣чЪДхЙНф╕Аф╕кч╗УчВ╣уАВ</p> <p>чД╢хРОя╝МхЫаф╕║ш╖│шбицШпф╕Аф╕кхдЪх▒ВчЪДцЬЙх║ПщУ╛шбия╝МцпПф╕Ах▒Вф╣ЯцШпчФ▒хдЪф╕кч╗УчВ╣щАЪш┐ЗцМЗщТИш┐ЮцОеш╡╖цЭечЪДуАВхЫацндхЬиш╖│шбич╗УчВ╣чЪДч╗УцЮДхоЪф╣Йф╕ня╝Мш┐ШхМЕхРлф║Жф╕Аф╕к zskiplistLevel ч╗УцЮДф╜Уч▒╗хЮЛчЪД <strong>level цХ░ч╗Д</strong>уАВ</p> <p>level цХ░ч╗Дф╕нчЪДцпПф╕Аф╕кхЕГч┤ахп╣х║Фф║Жф╕Аф╕к zskiplistLevel ч╗УцЮДф╜Уя╝Мф╣Яхп╣х║Фф║Жш╖│шбичЪДф╕Ах▒ВуАВшАМ zskiplistLevel ч╗УцЮДф╜УхоЪф╣Йф║Жф╕Аф╕кцМЗхРСф╕Лф╕Ач╗УчВ╣чЪДхЙНхРСцМЗщТИя╝И*forwardя╝Йя╝Мш┐Щх░▒ф╜┐х╛Чч╗УчВ╣хПпф╗ехЬицЯРф╕Ах▒Вф╕КхТМхРОч╗нч╗УчВ╣ш┐ЮцОеш╡╖цЭеуАВхРМцЧ╢я╝МzskiplistLevel ч╗УцЮДф╜Уф╕нш┐ШхоЪф╣Йф║Жя╝Мш┐ЩцШпчФицЭешо░х╜Хч╗УчВ╣хЬицЯРф╕Ах▒Вф╕КчЪД****ш╖их║ж***forward цМЗщТИхТМшпецМЗщТИцМЗхРСчЪДч╗УчВ╣ф╣ЛщЧ┤я╝Мш╖иш╢Кф║Ж level0 ф╕КчЪДхЗаф╕кч╗УчВ╣уАВ</p> <p>цИСф╗мцЭечЬЛф╕ЛщЭвш┐Щх╝ахЫ╛я╝МхЕ╢ф╕нх░▒х▒Хчд║ф║Ж 33 ч╗УчВ╣чЪД level цХ░ч╗ДхТМш╖их║жцГЕхЖ╡уАВхПпф╗ечЬЛхИ░я╝М33 ч╗УчВ╣чЪД level цХ░ч╗ДцЬЙф╕Йф╕кхЕГч┤ая╝МхИЖхИлхп╣х║Фф║Жф╕Йх▒В level ф╕КчЪДцМЗщТИуАВцндхдЦя╝МхЬи level цХ░ч╗Дф╕ня╝Мlevel 2уАБlevel1 хТМ level 0 чЪДш╖их║ж span хА╝ф╛ЭцмбцШп 3уАБ2уАБ1уАВ</p> <p>![img](https://learn.lianglianglee.com/ф╕УцаП/Redis ц║РчаБхЙЦцЮРф╕ОхоЮцИШ/assets/fb90e5eb40d39ced5d5896b3e10640e7-20221013234921-hhtfin9.jpg)</p> <p>цЬАхРОя╝МхЫаф╕║ш╖│шбиф╕нчЪДч╗УчВ╣щГ╜цШпцМЙх║ПцОТхИЧчЪДя╝МцЙАф╗ея╝Мхп╣ф║Ош╖│шбиф╕нчЪДцЯРф╕кч╗УчВ╣я╝МцИСф╗мхПпф╗ецККф╗Охд┤ч╗УчВ╣хИ░шпеч╗УчВ╣чЪДцЯешпвш╖пх╛Дф╕Кя╝МхРДф╕кч╗УчВ╣хЬицЙАцЯешпвх▒Вцмбф╕КчЪД*forward цМЗщТИш╖их║жя╝МхБЪф╕Аф╕кч┤пхКауАВш┐Щф╕кч┤пхКахА╝х░▒хПпф╗ечФицЭешобчоЧшпеч╗УчВ╣хЬицХ┤ф╕кш╖│шбиф╕нчЪДщб║х║Пя╝МхПжхдЦш┐Щф╕кч╗УцЮДчЙ╣чВ╣ш┐ШхПпф╗ечФицЭехоЮчО░ Sorted Set чЪД rank цУНф╜Ья╝МцпФхжВ ZRANKуАБZREVRANK чнЙуАВ</p> <p>хе╜я╝Мф║Жшзгф║Жш╖│шбич╗УчВ╣чЪДхоЪф╣ЙхРОя╝МцИСф╗мхПпф╗ецЭечЬЛчЬЛш╖│шбичЪДхоЪф╣ЙуАВхЬиш╖│шбичЪДч╗УцЮДф╕ня╝МхоЪф╣Йф║Жш╖│шбичЪДхд┤ч╗УчВ╣хТМх░╛ч╗УчВ╣уАБш╖│шбичЪДщХ┐х║жя╝Мф╗ехПКш╖│шбичЪДцЬАхдзх▒ВцХ░я╝МхжВф╕ЛцЙАчд║уАВ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">zskiplist</span> <span class="token punctuation">{</span>
    <span class="token keyword">struct</span> <span class="token class-name">zskiplistNode</span> <span class="token operator">*</span>header<span class="token punctuation">,</span> <span class="token operator">*</span>tail<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> length<span class="token punctuation">;</span>
    <span class="token keyword">int</span> level<span class="token punctuation">;</span>
<span class="token punctuation">}</span> zskiplist<span class="token punctuation">;</span>
</code></pre></div><p>хЫаф╕║ш╖│шбичЪДцпПф╕кч╗УчВ╣щГ╜цШпщАЪш┐ЗцМЗщТИш┐ЮцОеш╡╖цЭечЪДя╝МцЙАф╗ецИСф╗мхЬиф╜┐чФиш╖│шбицЧ╢я╝МхПкщЬАшжБф╗Ош╖│шбич╗УцЮДф╜Уф╕ншО╖х╛Чхд┤ч╗УчВ╣цИЦх░╛ч╗УчВ╣я╝Мх░▒хПпф╗ещАЪш┐Зч╗УчВ╣цМЗщТИшо┐щЧохИ░ш╖│шбиф╕нчЪДхРДф╕кч╗УчВ╣уАВ</p> <p>щВгф╣Ия╝Мх╜УцИСф╗мхЬи Sorted Set ф╕нцЯецЙ╛хЕГч┤ацЧ╢я╝Мх░▒хп╣х║ФхИ░ф║Ж Redis хЬиш╖│шбиф╕нцЯецЙ╛ч╗УчВ╣я╝МшАМцндцЧ╢я╝МцЯешпвф╗гчаБцШпхРжщЬАшжБхГПцЯешпвх╕╕шзДщУ╛шбищВгца╖я╝МщАРф╕Ащб║х║ПцЯешпвцпФш╛ГщУ╛шбиф╕нчЪДцпПф╕кч╗УчВ╣хСвя╝Я</p> <p>хЕ╢хоЮцШпф╕НчФичЪДя╝МхЫаф╕║ш┐ЩщЗМчЪДцЯешпвф╗гчаБя╝МхПпф╗еф╜┐чФиш╖│шбич╗УчВ╣ф╕нчЪД level цХ░ч╗ДцЭехКащАЯцЯешпвуАВ</p> <h3 id="ш╖│шбич╗УчВ╣цЯешпв"><a href="#ш╖│шбич╗УчВ╣цЯешпв" class="header-anchor">#</a> ш╖│шбич╗УчВ╣цЯешпв</h3> <p>ф║ЛхоЮф╕Кя╝Мх╜УцЯешпвф╕Аф╕кч╗УчВ╣цЧ╢я╝Мш╖│шбиф╝ЪхЕИф╗Охд┤ч╗УчВ╣чЪДцЬАщлШх▒Вх╝АхзЛя╝МцЯецЙ╛ф╕Лф╕Аф╕кч╗УчВ╣уАВшАМчФ▒ф║Ош╖│шбич╗УчВ╣хРМцЧ╢ф┐ЭхнШф║ЖхЕГч┤ахТМцЭГщЗНя╝МцЙАф╗еш╖│шбихЬицпФш╛Гч╗УчВ╣цЧ╢я╝МчЫ╕х║ФхЬ░цЬЙ<strong>ф╕дф╕кхИдцЦнцЭбф╗╢</strong>я╝Ъ</p> <ol><li>х╜УцЯецЙ╛хИ░чЪДч╗УчВ╣ф┐ЭхнШчЪДхЕГч┤ацЭГщЗНя╝МцпФшжБцЯецЙ╛чЪДцЭГщЗНх░ПцЧ╢я╝Мш╖│шбих░▒ф╝Ъч╗зч╗ншо┐щЧошпех▒Вф╕КчЪДф╕Лф╕Аф╕кч╗УчВ╣уАВ</li> <li>х╜УцЯецЙ╛хИ░чЪДч╗УчВ╣ф┐ЭхнШчЪДхЕГч┤ацЭГщЗНя╝МчнЙф║ОшжБцЯецЙ╛чЪДцЭГщЗНцЧ╢я╝Мш╖│шбиф╝ЪхЖНцгАцЯешпеч╗УчВ╣ф┐ЭхнШчЪД SDS ч▒╗хЮЛцХ░цНоя╝МцШпхРжцпФшжБцЯецЙ╛чЪД SDS цХ░цНох░ПуАВхжВцЮЬч╗УчВ╣цХ░цНох░Пф║ОшжБцЯецЙ╛чЪДцХ░цНоцЧ╢я╝Мш╖│шбиф╗НчД╢ф╝Ъч╗зч╗ншо┐щЧошпех▒Вф╕КчЪДф╕Лф╕Аф╕кч╗УчВ╣уАВ</li></ol> <p>ф╜ЖцШпя╝Мх╜Уф╕Кш┐░ф╕дф╕кцЭбф╗╢щГ╜ф╕Нц╗бш╢│цЧ╢я╝Мш╖│шбих░▒ф╝ЪчФихИ░х╜УхЙНцЯецЙ╛хИ░чЪДч╗УчВ╣чЪД level цХ░ч╗Дф║ЖуАВш╖│шбиф╝Ъф╜┐чФих╜УхЙНч╗УчВ╣ level цХ░ч╗ДщЗМчЪДф╕Лф╕Ах▒ВцМЗщТИя╝МчД╢хРОц▓┐чЭАф╕Лф╕Ах▒ВцМЗщТИч╗зч╗нцЯецЙ╛я╝Мш┐Щх░▒чЫ╕х╜Уф║Ош╖│хИ░ф║Жф╕Лф╕Ах▒ВцОечЭАцЯецЙ╛уАВ</p> <p>ш┐ЩщГихИЖчЪДф╗гчаБщА╗ш╛СхжВф╕ЛцЙАчд║я╝МхЫаф╕║хЬиш╖│шбиф╕нш┐ЫшбМцЯецЙ╛уАБцПТхЕеуАБцЫ┤цЦ░цИЦхИащЩдцУНф╜ЬцЧ╢я╝МщГ╜щЬАшжБчФихИ░цЯешпвчЪДхКЯшГ╜я╝Мф╜ахПпф╗ещЗНчВ╣ф║Жшзгф╕ЛуАВ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//шО╖хПЦш╖│шбичЪДшбихд┤</span>
x <span class="token operator">=</span> zsl<span class="token operator">-&gt;</span>header<span class="token punctuation">;</span>
<span class="token comment">//ф╗ОцЬАхдзх▒ВцХ░х╝АхзЛщАРф╕АщБНхОЖ</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> zsl<span class="token operator">-&gt;</span>level<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
   <span class="token keyword">while</span> <span class="token punctuation">(</span>x<span class="token operator">-&gt;</span>level<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>forward <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>x<span class="token operator">-&gt;</span>level<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>forward<span class="token operator">-&gt;</span>score <span class="token operator">&lt;</span> score <span class="token operator">||</span> <span class="token punctuation">(</span>x<span class="token operator">-&gt;</span>level<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>forward<span class="token operator">-&gt;</span>score <span class="token operator">==</span> score
    <span class="token operator">&amp;&amp;</span> <span class="token function">sdscmp</span><span class="token punctuation">(</span>x<span class="token operator">-&gt;</span>level<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>forward<span class="token operator">-&gt;</span>ele<span class="token punctuation">,</span>ele<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
      x <span class="token operator">=</span> x<span class="token operator">-&gt;</span>level<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>forward<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ш╖│шбич╗УчВ╣х▒ВцХ░шо╛ч╜о"><a href="#ш╖│шбич╗УчВ╣х▒ВцХ░шо╛ч╜о" class="header-anchor">#</a> ш╖│шбич╗УчВ╣х▒ВцХ░шо╛ч╜о</h3> <p>ш┐Щца╖ф╕АцЭея╝МцЬЙф║Ж level цХ░ч╗Дф╣ЛхРОя╝Мф╕Аф╕кш╖│шбич╗УчВ╣х░▒хПпф╗ехЬихдЪх▒Вф╕Кшвлшо┐щЧохИ░ф║ЖуАВшАМф╕Аф╕кч╗УчВ╣чЪД level цХ░ч╗ДчЪДх▒ВцХ░ф╣Ях░▒хЖ│хоЪф║Жя╝Мшпеч╗УчВ╣хПпф╗ехЬихЗах▒Вф╕Кшвлшо┐щЧохИ░уАВ</p> <p>цЙАф╗ея╝Мх╜УцИСф╗мшжБхЖ│хоЪч╗УчВ╣х▒ВцХ░цЧ╢я╝МхоЮщЩЕф╕КцШпшжБхЖ│хоЪ level цХ░ч╗ДхЕ╖ф╜УцЬЙхЗах▒ВуАВ</p> <p>ф╕АчзНшо╛шобцЦ╣ц│ХцШпя╝МшойцпПф╕Ах▒Вф╕КчЪДч╗УчВ╣цХ░ч║жцШпф╕Лф╕Ах▒Вф╕Кч╗УчВ╣цХ░чЪДф╕АхНКя╝Мх░▒хГПф╕ЛщЭвш┐Щх╝ахЫ╛х▒Хчд║чЪДуАВчмм 0 х▒Вф╕КчЪДч╗УчВ╣цХ░цШп 7я╝Мчмм 1 х▒Вф╕КчЪДч╗УчВ╣цХ░цШп 3я╝Мч║жцШпчмм 0 х▒Вф╕Кч╗УчВ╣цХ░чЪДф╕АхНКуАВшАМчмм 2 х▒Вф╕КчЪДч╗УчВ╣х░▒ 33 ф╕Аф╕кя╝Мч║жцШпчмм 1 х▒Вч╗УчВ╣цХ░чЪДф╕АхНКуАВ</p> <p>![img](https://learn.lianglianglee.com/ф╕УцаП/Redis ц║РчаБхЙЦцЮРф╕ОхоЮцИШ/assets/4ed4fce0d36bd4c4d2ec99cd2e4bb9b3-20221013234921-we682vd.jpg)</p> <p>ш┐ЩчзНшо╛шобцЦ╣ц│Хх╕жцЭечЪДхе╜хдДцШпя╝Мх╜Уш╖│шбиф╗ОцЬАщлШх▒Вх╝АхзЛш┐ЫшбМцЯецЙ╛цЧ╢я╝МчФ▒ф║ОцпПф╕Ах▒Вч╗УчВ╣цХ░щГ╜ч║жцШпф╕Лф╕Ах▒Вч╗УчВ╣цХ░чЪДф╕АхНКя╝Мш┐ЩчзНцЯецЙ╛ш┐ЗчиЛх░▒ч▒╗ф╝╝ф║Оф║МхИЖцЯецЙ╛я╝М<strong>цЯецЙ╛хдНцЭВх║жхПпф╗ещЩНф╜ОхИ░ O(logN)</strong>уАВ</p> <p>ф╜Жш┐ЩчзНшо╛шобцЦ╣ц│Хф╣Яф╝Ъх╕жцЭеш┤ЯщЭвх╜▒хУНя╝МщВгх░▒цШпф╕║ф║Жч╗┤цМБчЫ╕щВ╗ф╕дх▒Вф╕Кч╗УчВ╣цХ░чЪДцпФф╛Лф╕║ 2:1я╝Мф╕АцЧжцЬЙцЦ░чЪДч╗УчВ╣цПТхЕецИЦцШпцЬЙч╗УчВ╣швлхИащЩдя╝МщВгф╣ИцПТхЕецИЦхИащЩдхдДчЪДч╗УчВ╣я╝МхПКхЕ╢хРОч╗нч╗УчВ╣чЪДх▒ВцХ░щГ╜щЬАшжБш┐ЫшбМш░ГцХ┤я╝МшАМш┐Щца╖х░▒х╕жцЭеф║ЖщвЭхдЦчЪДх╝АщФАуАВ</p> <p>цИСхЕИцЭеч╗Щф╜аф╕╛ф╕кф╛ЛхнРя╝МчЬЛф╕Лф╕Нч╗┤цМБч╗УчВ╣цХ░цпФф╛ЛчЪДх╜▒хУНя╝Мш┐Щца╖шЩ╜чД╢хПпф╗еф╕Нш░ГцХ┤х▒ВцХ░я╝Мф╜ЖцШпф╝ЪхвЮхКацЯешпвхдНцЭВх║жуАВ</p> <p>щжЦхЕИя╝МхБЗшо╛х╜УхЙНш╖│шбицЬЙ 3 ф╕кч╗УчВ╣я╝МхЕ╢цХ░хА╝хИЖхИлцШп 3уАБ11уАБ23я╝МхжВф╕ЛхЫ╛цЙАчд║уАВ</p> <p>![img](https://learn.lianglianglee.com/ф╕УцаП/Redis ц║РчаБхЙЦцЮРф╕ОхоЮцИШ/assets/e86e7ac5938a17120bd84c158a5f8fbf-20221013234921-nn6robj.jpg)</p> <p>цОечЭАя╝МхБЗшо╛чО░хЬишжБцПТхЕеф╕Аф╕кч╗УчВ╣ 15я╝МхжВцЮЬцИСф╗мф╕Нш░ГцХ┤хЕ╢ф╗Цч╗УчВ╣чЪДх▒ВцХ░я╝МшАМцШпчЫ┤цОецПТхЕеч╗УчВ╣ 15 чЪДшпЭя╝МщВгф╣ИцПТхЕехРОя╝Мш╖│шби level 0 хТМ level 1 ф╕дх▒Вф╕КчЪДч╗УчВ╣цХ░цпФф╛Лх░▒хПШцИРф║Жф╕║ 4:1я╝МхжВф╕ЛхЫ╛цЙАчд║уАВ</p> <p>![img](https://learn.lianglianglee.com/ф╕УцаП/Redis ц║РчаБхЙЦцЮРф╕ОхоЮцИШ/assets/4ba3e67fd4c66a0b79fcd87bf918e2a4-20221013234921-srnneu0.jpg)</p> <p>шАМхБЗшо╛цИСф╗мцМБч╗нцПТхЕехдЪф╕кч╗УчВ╣я╝Мф╜ЖцШпф╗НчД╢ф╕Нш░ГцХ┤хЕ╢ф╗Цч╗УчВ╣чЪДх▒ВцХ░я╝Мш┐Щца╖ф╕АцЭея╝Мlevel0 ф╕КчЪДч╗УчВ╣цХ░х░▒ф╝Ъш╢КцЭеш╢КхдЪя╝МхжВф╕ЛхЫ╛цЙАчд║уАВ</p> <p>![img](https://learn.lianglianglee.com/ф╕УцаП/Redis ц║РчаБхЙЦцЮРф╕ОхоЮцИШ/assets/54745b8f90ac9872fa3f5ca947df20eb-20221013234921-4xascu9.jpg)</p> <p>чЫ╕х║ФчЪДя╝МхжВцЮЬцИСф╗мшжБцЯецЙ╛хдзф║О 11 чЪДч╗УчВ╣я╝Мх░▒щЬАшжБхЬи level 0 чЪДч╗УчВ╣ф╕нф╛Эцмбщб║х║ПцЯецЙ╛я╝МхдНцЭВх║жх░▒цШп O(N) ф║ЖуАВцЙАф╗ея╝Мф╕║ф║ЖщЩНф╜ОцЯешпвхдНцЭВх║жя╝МцИСф╗мх░▒щЬАшжБч╗┤цМБчЫ╕щВ╗х▒Вч╗УчВ╣цХ░щЧ┤чЪДхЕ│ч│╗уАВ</p> <p>хе╜я╝МцОеф╕ЛцЭея╝МцИСф╗мхЖНцЭечЬЛф╕Лч╗┤цМБчЫ╕щВ╗х▒Вч╗УчВ╣цХ░ф╕║ 2:1 цЧ╢чЪДх╜▒хУНуАВ</p> <p>цпФхжВя╝МцИСф╗мхПпф╗ецККч╗УчВ╣ 23 чЪД level цХ░ч╗Дф╕нхвЮхКаф╕Ах▒ВцМЗщТИя╝МхжВф╕ЛхЫ╛цЙАчд║уАВш┐Щца╖ф╕АцЭея╝Мlevel 0 хТМ level 1 ф╕КчЪДч╗УчВ╣цХ░х░▒ч╗┤цМБхЬиф║Ж 2:1уАВф╜ЖчЫ╕х║ФчЪДф╗гф╗╖х░▒цШпя╝МцИСф╗мф╣ЯщЬАшжБч╗Щ level цХ░ч╗ДщЗНцЦ░хИЖщЕНчй║щЧ┤я╝Мф╗еф╛┐хвЮхКаф╕Ах▒ВцМЗщТИуАВ</p> <p>![img](https://learn.lianglianglee.com/ф╕УцаП/Redis ц║РчаБхЙЦцЮРф╕ОхоЮцИШ/assets/ea55df10ae9c88a0bbafca8d4af509e1-20221013234921-30bhjzn.jpg)</p> <p>ч▒╗ф╝╝чЪДя╝МхжВцЮЬцИСф╗мшжБхЬицЬЙ 7 ф╕кч╗УчВ╣чЪДш╖│шбиф╕нхИащЩдч╗УчВ╣ 33я╝МщВгф╣Ич╗УчВ╣ 33 хРОщЭвчЪДцЙАцЬЙч╗УчВ╣щГ╜шжБш┐ЫшбМш░ГцХ┤я╝Ъ</p> <p>![img](https://learn.lianglianglee.com/ф╕УцаП/Redis ц║РчаБхЙЦцЮРф╕ОхоЮцИШ/assets/e8e2ae100c81fcf2dc9bc66d3b3cc51a-20221013234921-ca9rre0.jpg)</p> <p>ш░ГцХ┤хРОчЪДш╖│шбихжВф╕ЛхЫ╛цЙАчд║уАВф╜ахПпф╗ечЬЛхИ░я╝Мч╗УчВ╣ 42 хТМ 62 щГ╜шжБцЦ░хвЮ level цХ░ч╗Дчй║щЧ┤я╝Мш┐Щца╖шГ╜хИЖхИлф┐ЭхнШ 3 х▒ВчЪДцМЗщТИхТМ 2 х▒ВчЪДцМЗщТИя╝МшАМч╗УчВ╣ 51 чЪД level цХ░ч╗ДхИЩщЬАшжБхЗПх░Сф╕Ах▒ВуАВф╣Ях░▒цШпшп┤я╝Мш┐Щца╖чЪДш░ГцХ┤ф╝Ъх╕жцЭещвЭхдЦчЪДцУНф╜Ьх╝АщФАуАВ</p> <p>![img](https://learn.lianglianglee.com/ф╕УцаП/Redis ц║РчаБхЙЦцЮРф╕ОхоЮцИШ/assets/cdf7eb5543d757399c6edd18385ebf75-20221013234921-7rrgbbn.jpg)</p> <p>хЫацндя╝Мф╕║ф║ЖщБ┐хЕНф╕Кш┐░щЧощвШя╝Мш╖│шбихЬихИЫх╗║ч╗УчВ╣цЧ╢я╝МщЗЗчФичЪДцШпхПжф╕АчзНшо╛шобцЦ╣ц│Хя╝МхН│<strong>щЪПцЬ║чФЯцИРцпПф╕кч╗УчВ╣чЪДх▒ВцХ░</strong>уАВцндцЧ╢я╝МчЫ╕щВ╗ф╕дх▒ВщУ╛шбиф╕КчЪДч╗УчВ╣цХ░х╣╢ф╕НщЬАшжБч╗┤цМБхЬиф╕еца╝чЪД 2:1 хЕ│ч│╗уАВш┐Щца╖ф╕АцЭея╝Мх╜УцЦ░цПТхЕеф╕Аф╕кч╗УчВ╣цЧ╢я╝МхПкщЬАшжБф┐оцФ╣хЙНхРОч╗УчВ╣чЪДцМЗщТИя╝МшАМхЕ╢ф╗Цч╗УчВ╣чЪДх▒ВцХ░х░▒ф╕НщЬАшжБщЪПф╣ЛцФ╣хПШф║Жя╝Мш┐Щх░▒щЩНф╜Оф║ЖцПТхЕецУНф╜ЬчЪДхдНцЭВх║жуАВ</p> <p>хЬи Redis ц║РчаБф╕ня╝Мш╖│шбич╗УчВ╣х▒ВцХ░цШпчФ▒ <strong>zslRandomLevel хЗ╜цХ░</strong>хЖ│хоЪуАВzslRandomLevel хЗ╜цХ░ф╝ЪцККх▒ВцХ░хИЭхзЛхМЦф╕║ 1я╝Мш┐Щф╣ЯцШпч╗УчВ╣чЪДцЬАх░Пх▒ВцХ░уАВчД╢хРОя╝МшпехЗ╜цХ░ф╝ЪчФЯцИРщЪПцЬ║цХ░я╝МхжВцЮЬщЪПцЬ║цХ░чЪДхА╝х░Пф║О ZSKIPLIST_Pя╝ИцМЗш╖│шбич╗УчВ╣хвЮхКах▒ВцХ░чЪДцжВчОЗя╝МхА╝ф╕║ 0.25я╝Йя╝МщВгф╣Их▒ВцХ░х░▒хвЮхКа 1 х▒ВуАВхЫаф╕║щЪПцЬ║цХ░хПЦхА╝хИ░[0,0.25) шМГхЫ┤хЖЕчЪДцжВчОЗф╕Нш╢Еш┐З 25%я╝МцЙАф╗еш┐Щф╣Ях░▒шбицШОф║Жя╝МцпПхвЮхКаф╕Ах▒ВчЪДцжВчОЗф╕Нш╢Еш┐З 25%уАВф╕ЛщЭвчЪДф╗гчаБх▒Хчд║ф║Ж zslRandomLevel хЗ╜цХ░чЪДцЙзшбМщА╗ш╛Ся╝Мф╜ахПпф╗ечЬЛф╕ЛуАВ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ZSKIPLIST_MAXLEVEL</span> <span class="token expression"><span class="token number">64</span>  </span><span class="token comment">//цЬАхдзх▒ВцХ░ф╕║64</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ZSKIPLIST_P</span> <span class="token expression"><span class="token number">0.25</span>       </span><span class="token comment">//щЪПцЬ║цХ░чЪДхА╝ф╕║0.25</span></span>
<span class="token keyword">int</span> <span class="token function">zslRandomLevel</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//хИЭхзЛхМЦх▒Вф╕║1</span>
    <span class="token keyword">int</span> level <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xFFFF</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>ZSKIPLIST_P <span class="token operator">*</span> <span class="token number">0xFFFF</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        level <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>level<span class="token operator">&lt;</span>ZSKIPLIST_MAXLEVEL<span class="token punctuation">)</span> <span class="token operator">?</span> level <span class="token operator">:</span> ZSKIPLIST_MAXLEVEL<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>хе╜я╝МчО░хЬицИСф╗мх░▒ф║Жшзгф║Жш╖│шбичЪДхЯ║цЬмч╗УцЮДуАБцЯешпвцЦ╣х╝ПхТМч╗УчВ╣х▒ВцХ░шо╛ч╜оцЦ╣ц│Хя╝МщВгф╣Иф╕ЛщЭвцИСф╗мцОечЭАцЭехнжф╣аф╕Ля╝МSorted Set ф╕нцШпхжВф╜Хх░Жш╖│шбихТМхУИх╕Мшбич╗ДхРИш╡╖цЭеф╜┐чФичЪДя╝Мф╗ехПКцШпхжВф╜Хф┐ЭцМБш┐Щф╕дф╕кч┤вх╝Хч╗УцЮДф╕нчЪДцХ░цНоцШпф╕АшЗ┤чЪДуАВ</p> <h2 id="хУИх╕МшбихТМш╖│шбичЪДч╗ДхРИф╜┐чФи"><a href="#хУИх╕МшбихТМш╖│шбичЪДч╗ДхРИф╜┐чФи" class="header-anchor">#</a> хУИх╕МшбихТМш╖│шбичЪДч╗ДхРИф╜┐чФи</h2> <p>хЕ╢хоЮя╝МхУИх╕МшбихТМш╖│шбичЪДч╗ДхРИф╜┐чФих╣╢ф╕НхдНцЭВуАВ</p> <p>щжЦхЕИя╝МцИСф╗мф╗ОхИЪцЙНф╗Лч╗НчЪД Sorted Set ч╗УцЮДф╜Уф╕нхПпф╗ечЬЛхИ░я╝МSorted Set ф╕нх╖▓ч╗ПхРМцЧ╢хМЕхРлф║Жш┐Щф╕дчзНч┤вх╝Хч╗УцЮДя╝Мш┐Щх░▒цШпч╗ДхРИф╜┐чФиф╕дшАЕчЪДчммф╕АцнеуАВчД╢хРОя╝МцИСф╗мш┐ШхПпф╗ехЬи Sorted Set чЪДхИЫх╗║ф╗гчаБя╝И<a href="https://github.com/redis/redis/blob/5.0/src/t_zset.c" target="_blank" rel="noopener noreferrer">t_zset.c<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>цЦЗф╗╢я╝Йф╕ня╝Мш┐Ыф╕АцнечЬЛхИ░ш╖│шбихТМхУИх╕МшбишвлчЫ╕ч╗зхИЫх╗║уАВ</p> <p>х╜УхИЫх╗║ф╕Аф╕к zset цЧ╢я╝Мф╗гчаБф╕нф╝ЪчЫ╕ч╗зш░ГчФи <strong>dictCreate хЗ╜цХ░</strong>хИЫх╗║ zset ф╕нчЪДхУИх╕Мшбия╝Мф╗ехПКш░ГчФи <strong>zslCreate хЗ╜цХ░</strong>хИЫх╗║ш╖│шбия╝МхжВф╕ЛцЙАчд║уАВ</p> <div class="language-c extra-class"><pre class="language-c"><code> zs <span class="token operator">=</span> <span class="token function">zmalloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>zs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 zs<span class="token operator">-&gt;</span>dict <span class="token operator">=</span> <span class="token function">dictCreate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>zsetDictType<span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 zs<span class="token operator">-&gt;</span>zsl <span class="token operator">=</span> <span class="token function">zslCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ш┐Щца╖я╝МхЬи Sorted Set ф╕нхРМцЧ╢цЬЙф║Жш┐Щф╕дф╕кч┤вх╝Хч╗УцЮДф╗ехРОя╝МцОеф╕ЛцЭея╝МцИСф╗мшжБцГ│ч╗ДхРИф╜┐чФихоГф╗мя╝Мх░▒щЬАшжБф┐ЭцМБш┐Щф╕дф╕кч┤вх╝Хч╗УцЮДф╕нчЪДцХ░цНоф╕АшЗ┤ф║ЖуАВчоАхНХцЭешп┤я╝Мш┐Щх░▒щЬАшжБцИСф╗мхЬих╛Аш╖│шбиф╕нцПТхЕецХ░цНоцЧ╢я╝МхРМцЧ╢ф╣ЯхРСхУИх╕Мшбиф╕нцПТхЕецХ░цНоуАВ</p> <p>шАМш┐ЩчзНф┐ЭцМБф╕дф╕кч┤вх╝Хч╗УцЮДф╕АшЗ┤чЪДхБЪц│ХхЕ╢хоЮф╣Яф╕НщЪ╛я╝Мх╜Ух╛А Sorted Set ф╕нцПТхЕецХ░цНоцЧ╢я╝МzsetAdd хЗ╜цХ░х░▒ф╝Ъшвлш░ГчФиуАВцЙАф╗ея╝МцИСф╗мхПпф╗ещАЪш┐ЗщШЕшп╗ Sorted Set чЪДхЕГч┤ац╖╗хКахЗ╜цХ░ zsetAdd ф║ЖшзгхИ░уАВф╕ЛщЭвцИСф╗мх░▒цЭехИЖцЮРф╕Аф╕Л zsetAdd хЗ╜цХ░чЪДцЙзшбМш┐ЗчиЛуАВ</p> <p>**щжЦхЕИя╝МzsetAdd хЗ╜цХ░ф╝ЪхИдхоЪ Sorted Set щЗЗчФичЪДцШп ziplist ш┐ШцШп skiplist чЪДч╝ЦчаБцЦ╣х╝ПуАВ**zsetAdd хЗ╜цХ░ф╝ЪхИдхоЪ Sorted Set щЗЗчФичЪДцШп ziplist ш┐ШцШп skiplist чЪДч╝ЦчаБцЦ╣х╝ПуАВ</p> <p>ц│ицДПя╝МхЬиф╕НхРМч╝ЦчаБцЦ╣х╝Пф╕Ля╝МzsetAdd хЗ╜цХ░чЪДцЙзшбМщА╗ш╛Сф╣ЯцЬЙцЙАхМ║хИлуАВш┐Щф╕Ашо▓цИСф╗мщЗНчВ╣хЕ│ц│ичЪДцШп skiplist чЪДч╝ЦчаБцЦ╣х╝Пя╝МцЙАф╗ецОеф╕ЛцЭея╝МцИСф╗мх░▒ф╕╗шжБцЭечЬЛчЬЛх╜УщЗЗчФи skiplist ч╝ЦчаБцЦ╣х╝ПцЧ╢я╝МzsetAdd хЗ╜цХ░чЪДщА╗ш╛СцШпф╗Аф╣Ица╖чЪДуАВ</p> <p>zsetAdd хЗ╜цХ░ф╝ЪхЕИф╜┐чФихУИх╕МшбичЪД dictFind хЗ╜цХ░я╝МцЯецЙ╛шжБцПТхЕечЪДхЕГч┤ацШпхРжхнШхЬиуАВхжВцЮЬф╕НхнШхЬия╝Мх░▒чЫ┤цОеш░ГчФиш╖│шбихЕГч┤ацПТхЕехЗ╜цХ░ zslInsert хТМхУИх╕МшбихЕГч┤ацПТхЕехЗ╜цХ░ dictAddя╝Мх░ЖцЦ░хЕГч┤ахИЖхИлцПТхЕехИ░ш╖│шбихТМхУИх╕Мшбиф╕нуАВ</p> <p>ш┐ЩщЗМф╜ащЬАшжБц│ицДПчЪДцШпя╝МRedis х╣╢ц▓бцЬЙцККхУИх╕МшбичЪДцУНф╜Ьх╡МхЕехИ░ш╖│шбицЬмш║лчЪДцУНф╜ЬхЗ╜цХ░ф╕ня╝МшАМцШпхЬи zsetAdd хЗ╜цХ░ф╕нф╛ЭцмбцЙзшбМф╗еф╕Кф╕дф╕кхЗ╜цХ░уАВш┐Щца╖шо╛шобчЪДхе╜хдДцШпф┐ЭцМБф║Жш╖│шбихТМхУИх╕Мшбиф╕дшАЕцУНф╜ЬчЪДчЛмчлЛцАзуАВ</p> <ul><li><strong>чД╢хРОя╝МхжВцЮЬ zsetAdd хЗ╜цХ░щАЪш┐З dictFind хЗ╜цХ░хПСчО░шжБцПТхЕечЪДхЕГч┤ах╖▓ч╗ПхнШхЬия╝МщВгф╣И zsetAdd хЗ╜цХ░ф╝ЪхИдцЦнцШпхРжшжБхвЮхКахЕГч┤ачЪДцЭГщЗНхА╝уАВ</strong></li></ul> <p>хжВцЮЬцЭГщЗНхА╝хПСчФЯф║ЖхПШхМЦя╝МzsetAdd хЗ╜цХ░х░▒ф╝Ъш░ГчФи zslUpdateScore хЗ╜цХ░я╝МцЫ┤цЦ░ш╖│шбиф╕нчЪДхЕГч┤ацЭГщЗНхА╝уАВч┤зцОечЭАя╝МzsetAdd хЗ╜цХ░ф╝ЪцККхУИх╕Мшбиф╕ншпехЕГч┤ая╝Ихп╣х║ФхУИх╕Мшбиф╕нчЪД keyя╝ЙчЪД value цМЗхРСш╖│шбич╗УчВ╣ф╕нчЪДцЭГщЗНхА╝я╝Мш┐Щца╖ф╕АцЭея╝МхУИх╕Мшбиф╕нхЕГч┤ачЪДцЭГщЗНхА╝х░▒хПпф╗еф┐ЭцМБцЬАцЦ░хА╝ф║ЖуАВ</p> <p>ф╕ЛщЭвчЪДф╗гчаБцШ╛чд║ф║Ж zsetAdd хЗ╜цХ░чЪДцЙзшбМц╡БчиЛя╝Мф╜ахПпф╗ечЬЛф╕ЛуАВ</p> <div class="language-c extra-class"><pre class="language-c"><code> <span class="token comment">//хжВцЮЬщЗЗчФиziplistч╝ЦчаБцЦ╣х╝ПцЧ╢я╝МzsetAddхЗ╜цХ░чЪДхдДчРЖщА╗ш╛С</span>
 <span class="token keyword">if</span> <span class="token punctuation">(</span>zobj<span class="token operator">-&gt;</span>encoding <span class="token operator">==</span> OBJ_ENCODING_ZIPLIST<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
<span class="token comment">//хжВцЮЬщЗЗчФиskiplistч╝ЦчаБцЦ╣х╝ПцЧ╢я╝МzsetAddхЗ╜цХ░чЪДхдДчРЖщА╗ш╛С</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>zobj<span class="token operator">-&gt;</span>encoding <span class="token operator">==</span> OBJ_ENCODING_SKIPLIST<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        zset <span class="token operator">*</span>zs <span class="token operator">=</span> zobj<span class="token operator">-&gt;</span>ptr<span class="token punctuation">;</span>
        zskiplistNode <span class="token operator">*</span>znode<span class="token punctuation">;</span>
        dictEntry <span class="token operator">*</span>de<span class="token punctuation">;</span>
        <span class="token comment">//ф╗ОхУИх╕Мшбиф╕нцЯешпвцЦ░хвЮхЕГч┤а</span>
        de <span class="token operator">=</span> <span class="token function">dictFind</span><span class="token punctuation">(</span>zs<span class="token operator">-&gt;</span>dict<span class="token punctuation">,</span>ele<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//хжВцЮЬшГ╜цЯешпвхИ░шпехЕГч┤а</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>de <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">/* NX? Return, same element already exists. */</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>nx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token operator">*</span>flags <span class="token operator">|=</span> ZADD_NOP<span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//ф╗ОхУИх╕Мшбиф╕нцЯешпвхЕГч┤ачЪДцЭГщЗН</span>
            curscore <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">dictGetVal</span><span class="token punctuation">(</span>de<span class="token punctuation">)</span><span class="token punctuation">;</span>


            <span class="token comment">//хжВцЮЬшжБцЫ┤цЦ░хЕГч┤ацЭГщЗНхА╝</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>incr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//цЫ┤цЦ░цЭГщЗНхА╝</span>
               <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
            <span class="token punctuation">}</span>


            <span class="token comment">//хжВцЮЬцЭГщЗНхПСчФЯхПШхМЦф║Ж</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">!=</span> curscore<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//цЫ┤цЦ░ш╖│шбич╗УчВ╣</span>
                znode <span class="token operator">=</span> <span class="token function">zslUpdateScore</span><span class="token punctuation">(</span>zs<span class="token operator">-&gt;</span>zsl<span class="token punctuation">,</span>curscore<span class="token punctuation">,</span>ele<span class="token punctuation">,</span>score<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//шойхУИх╕МшбихЕГч┤ачЪДхА╝цМЗхРСш╖│шбич╗УчВ╣чЪДцЭГщЗН</span>
                <span class="token function">dictGetVal</span><span class="token punctuation">(</span>de<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>znode<span class="token operator">-&gt;</span>score<span class="token punctuation">;</span>
                <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
       <span class="token comment">//хжВцЮЬцЦ░хЕГч┤аф╕НхнШхЬи</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>xx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            ele <span class="token operator">=</span> <span class="token function">sdsdup</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//цЦ░цПТхЕеш╖│шбич╗УчВ╣</span>
            znode <span class="token operator">=</span> <span class="token function">zslInsert</span><span class="token punctuation">(</span>zs<span class="token operator">-&gt;</span>zsl<span class="token punctuation">,</span>score<span class="token punctuation">,</span>ele<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//цЦ░цПТхЕехУИх╕МшбихЕГч┤а</span>
            <span class="token function">serverAssert</span><span class="token punctuation">(</span><span class="token function">dictAdd</span><span class="token punctuation">(</span>zs<span class="token operator">-&gt;</span>dict<span class="token punctuation">,</span>ele<span class="token punctuation">,</span><span class="token operator">&amp;</span>znode<span class="token operator">-&gt;</span>score<span class="token punctuation">)</span> <span class="token operator">==</span> DICT_OK<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><p>цА╗ф╣Ля╝Мф╜ахПпф╗ешо░ф╜ПчЪДцШпя╝МSorted Set хЕИцШпщАЪш┐ЗхЬихоГчЪДцХ░цНоч╗УцЮДф╕нхРМцЧ╢хоЪф╣Йф║Жш╖│шбихТМхУИх╕Мшбия╝МцЭехоЮчО░хРМцЧ╢ф╜┐чФиш┐Щф╕дчзНч┤вх╝Хч╗УцЮДуАВчД╢хРОя╝МSorted Set хЬицЙзшбМцХ░цНоцПТхЕецИЦцШпцХ░цНоцЫ┤цЦ░чЪДш┐ЗчиЛф╕ня╝Мф╝Ъф╛ЭцмбхЬиш╖│шбихТМхУИх╕Мшбиф╕нцПТхЕецИЦцЫ┤цЦ░чЫ╕х║ФчЪДцХ░цНоя╝Мф╗ОшАМф┐ЭшпБф║Жш╖│шбихТМхУИх╕Мшбиф╕ншо░х╜ХчЪДф┐бцБпф╕АшЗ┤уАВ</p> <p>ш┐Щца╖ф╕АцЭея╝МSorted Set цЧвхПпф╗еф╜┐чФиш╖│шбицФпцМБцХ░цНочЪДшМГхЫ┤цЯешпвя╝Мш┐ШшГ╜ф╜┐чФихУИх╕МшбицФпцМБца╣цНохЕГч┤ачЫ┤цОецЯешпвхоГчЪДцЭГщЗНуАВ</p> <h2 id="цА╗ч╗У"><a href="#цА╗ч╗У" class="header-anchor">#</a> цА╗ч╗У</h2> <p>ш┐ЩшКВшп╛я╝МцИСч╗Щф╜аф╗Лч╗Нф║Ж Sorted Set цХ░цНоч▒╗хЮЛчЪДх║Хх▒ВхоЮчО░уАВSorted Set ф╕║ф║ЖшГ╜хРМцЧ╢цФпцМБцМЙчЕзцЭГщЗНчЪДшМГхЫ┤цЯешпвя╝Мф╗ехПКщТИхп╣хЕГч┤ацЭГщЗНчЪДхНХчВ╣цЯешпвя╝МхЬих║Хх▒ВцХ░цНоч╗УцЮДф╕Кшо╛шобф║Ж<strong>ч╗ДхРИф╜┐чФиш╖│шбихТМхУИх╕Мшби</strong>чЪДцЦ╣ц│ХуАВ</p> <p>ш╖│шбицШпф╕Аф╕кхдЪх▒ВчЪДцЬЙх║ПщУ╛шбия╝МхЬиш╖│шбиф╕нш┐ЫшбМцЯешпвцУНф╜ЬцЧ╢я╝МцЯешпвф╗гчаБхПпф╗еф╗ОцЬАщлШх▒Вх╝АхзЛцЯешпвуАВх▒ВцХ░ш╢КщлШя╝Мч╗УчВ╣цХ░ш╢Кх░Ся╝МхРМцЧ╢щлШх▒Вч╗УчВ╣чЪДш╖их║жф╝ЪцпФш╛ГхдзуАВхЫацндя╝МхЬищлШх▒ВцЯешпвч╗УчВ╣цЧ╢я╝МцЯешпвф╕Аф╕кч╗УчВ╣хПпшГ╜х░▒х╖▓ч╗ПцЯехИ░ф║ЖщУ╛шбичЪДф╕нщЧ┤ф╜Нч╜оф║ЖуАВ</p> <p>ш┐Щца╖ф╕АцЭея╝Мш╖│шбих░▒ф╝ЪхЕИцЯещлШх▒Вя╝МхжВцЮЬщлШх▒ВчЫ┤цОецЯехИ░ф║ЖчнЙф║Ох╛ЕцЯехЕГч┤ачЪДч╗УчВ╣я╝МщВгф╣Их░▒хПпф╗ечЫ┤цОеш┐ФхЫЮуАВхжВцЮЬцЯехИ░чммф╕Аф╕кхдзф║Ох╛ЕцЯехЕГч┤ачЪДч╗УчВ╣хРОя╝Мх░▒ш╜мхРСф╕Лф╕Ах▒ВцЯешпвуАВф╕Лх▒Вф╕КчЪДч╗УчВ╣цХ░хдЪф║Оф╕Кх▒Вя╝МцЙАф╗еш┐Щца╖хПпф╗ехЬицЫ┤хдЪчЪДч╗УчВ╣ф╕нш┐Ыф╕АцнецЯецЙ╛х╛ЕцЯехЕГч┤ацШпхРжхнШхЬиуАВ</p> <p>ш╖│шбичЪДш┐ЩчзНшо╛шобцЦ╣ц│Хх░▒хПпф╗ешКВчЬБцЯешпвх╝АщФАя╝МхРМцЧ╢я╝Мш╖│шбишо╛шобщЗЗчФищЪПцЬ║чЪДцЦ╣ц│ХцЭечбохоЪцпПф╕кч╗УчВ╣чЪДх▒ВцХ░я╝Мш┐Щца╖х░▒хПпф╗ещБ┐хЕНцЦ░хвЮч╗УчВ╣цЧ╢я╝Мх╝Хш╡╖ч╗УчВ╣ш┐ЮщФБцЫ┤цЦ░щЧощвШуАВ</p> <p>цндхдЦя╝МSorted Set ф╕нш┐Шх░ЖхЕГч┤аф┐ЭхнШхЬиф║ЖхУИх╕Мшбиф╕ня╝Мф╜Ьф╕║хУИх╕МшбичЪД keyя╝МхРМцЧ╢х░Ж value цМЗхРСхЕГч┤ахЬиш╖│шбиф╕нчЪДцЭГщЗНуАВф╜┐чФиф║ЖхУИх╕МшбихРОя╝МSorted Set хПпф╗ещАЪш┐ЗхУИх╕МшобчоЧчЫ┤цОецЯецЙ╛хИ░цЯРф╕кхЕГч┤ахПКхЕ╢цЭГщЗНхА╝я╝МчЫ╕ш╛Гф║ОщАЪш┐Зш╖│шбицЯецЙ╛хНХф╕кхЕГч┤ая╝Мф╜┐чФихУИх╕Мшбих░▒цЬЙцХИцПРхНЗф║ЖцЯешпвцХИчОЗуАВ</p> <p>цА╗ф╣Ля╝Мч╗ДхРИф╜┐чФиф╕дчзНч┤вх╝Хч╗УцЮДцЭехп╣цХ░цНош┐ЫшбМчобчРЖя╝МцпФхжВ Sorted Set ф╕нч╗ДхРИф╜┐чФиш╖│шбихТМхУИх╕Мшбия╝Мш┐ЩцШпф╕Аф╕кх╛Ихе╜чЪДшо╛шобцАЭш╖пя╝Мх╕МцЬЫф╜аф╣ЯшГ╜х║ФчФихЬицЧех╕╕чЪДч│╗ч╗Ях╝АхПСф╕нуАВ</p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/echo-lxy/echo-system-design/edit/master/docs/01.Redis ч│╗ч╗Яшо╛шоб/02.хЯ║чбА/10.ZSet.md" target="_blank" rel="noopener noreferrer">ч╝Цш╛С</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">ф╕КцмбцЫ┤цЦ░:</span> <span class="time">2024/09/16, 10:01:40</span></div></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><span class="prev">
        тЖР
        <a href="/pages/2d4311/" class="prev">Hash</a></span> <span class="next"><a href="/pages/2ab65e/">хЖЕхнШхПЛхе╜чЪДцХ░цНоч╗УцЮДшпехжВф╜Хч╗ЖхМЦшо╛шобя╝Я</a>тЖТ
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:lixinyang2002@163.com" title="хПСщВоф╗╢" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/echo-lxy" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="хРмщЯ│ф╣Р" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="цЬмчлЩф╕╗щвШ">Vdoing</a> 
    | Copyright ┬й 2024-2024
    <span>Xinyang Li | MIT License</span></div> <div class="buttons"><div title="ш┐ФхЫЮщб╢щГи" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="хО╗шпДшо║" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ф╕╗щвШцибх╝П" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          ш╖ЯщЪПч│╗ч╗Я
        </li><li class="iconfont icon-rijianmoshi">
          ц╡ЕшЙ▓цибх╝П
        </li><li class="iconfont icon-yejianmoshi">
          ц╖▒шЙ▓цибх╝П
        </li><li class="iconfont icon-yuedu">
          щШЕшп╗цибх╝П
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e6c7c0bc.js" defer></script><script src="/assets/js/2.c1dbdf51.js" defer></script><script src="/assets/js/11.4b96b543.js" defer></script>
  </body>
</html>
