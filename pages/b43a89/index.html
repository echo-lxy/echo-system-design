<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>LFU чнЦчХе | EchoDesign</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/echo-system-design/img/favicon.ico">
    <meta name="description" content="ч│╗ч╗Яшо╛шобф╣ЛуАМшо▓шзг + щЭвшпХцМЗхНЧуАНя╝Мц░┤ц╗┤чЯ│чй┐я╝Мшо╛шобцЧащУ╢х╝╣я╝Б">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/echo-system-design/assets/css/0.styles.744b3760.css" as="style"><link rel="preload" href="/echo-system-design/assets/js/app.29ec2c17.js" as="script"><link rel="preload" href="/echo-system-design/assets/js/2.933750c6.js" as="script"><link rel="preload" href="/echo-system-design/assets/js/72.44c999da.js" as="script"><link rel="preload" href="/echo-system-design/assets/js/7.7eb70372.js" as="script"><link rel="prefetch" href="/echo-system-design/assets/js/10.2cc95be8.js"><link rel="prefetch" href="/echo-system-design/assets/js/100.2b21dce5.js"><link rel="prefetch" href="/echo-system-design/assets/js/101.09d5e594.js"><link rel="prefetch" href="/echo-system-design/assets/js/11.ddc7ccf4.js"><link rel="prefetch" href="/echo-system-design/assets/js/12.915fdd22.js"><link rel="prefetch" href="/echo-system-design/assets/js/13.d9d26d25.js"><link rel="prefetch" href="/echo-system-design/assets/js/14.ae63dfd6.js"><link rel="prefetch" href="/echo-system-design/assets/js/15.d5a34c66.js"><link rel="prefetch" href="/echo-system-design/assets/js/16.5a9b32ee.js"><link rel="prefetch" href="/echo-system-design/assets/js/17.bad7d194.js"><link rel="prefetch" href="/echo-system-design/assets/js/18.4e49fa9b.js"><link rel="prefetch" href="/echo-system-design/assets/js/19.daf31819.js"><link rel="prefetch" href="/echo-system-design/assets/js/20.cb4a5c13.js"><link rel="prefetch" href="/echo-system-design/assets/js/21.24c0f101.js"><link rel="prefetch" href="/echo-system-design/assets/js/22.dd779f94.js"><link rel="prefetch" href="/echo-system-design/assets/js/23.4d814163.js"><link rel="prefetch" href="/echo-system-design/assets/js/24.891fe6fb.js"><link rel="prefetch" href="/echo-system-design/assets/js/25.41dca26b.js"><link rel="prefetch" href="/echo-system-design/assets/js/26.6337eac0.js"><link rel="prefetch" href="/echo-system-design/assets/js/27.97a0cc13.js"><link rel="prefetch" href="/echo-system-design/assets/js/28.95a1fb6b.js"><link rel="prefetch" href="/echo-system-design/assets/js/29.2b39f61a.js"><link rel="prefetch" href="/echo-system-design/assets/js/3.5c09ac9d.js"><link rel="prefetch" href="/echo-system-design/assets/js/30.e32f6b31.js"><link rel="prefetch" href="/echo-system-design/assets/js/31.a532917f.js"><link rel="prefetch" href="/echo-system-design/assets/js/32.13b70e91.js"><link rel="prefetch" href="/echo-system-design/assets/js/33.d10d51bb.js"><link rel="prefetch" href="/echo-system-design/assets/js/34.6671ead6.js"><link rel="prefetch" href="/echo-system-design/assets/js/35.2760ed8d.js"><link rel="prefetch" href="/echo-system-design/assets/js/36.be98cc35.js"><link rel="prefetch" href="/echo-system-design/assets/js/37.82be3556.js"><link rel="prefetch" href="/echo-system-design/assets/js/38.40fe2658.js"><link rel="prefetch" href="/echo-system-design/assets/js/39.84b6e82e.js"><link rel="prefetch" href="/echo-system-design/assets/js/4.73518a0f.js"><link rel="prefetch" href="/echo-system-design/assets/js/40.591baf2a.js"><link rel="prefetch" href="/echo-system-design/assets/js/41.f961e422.js"><link rel="prefetch" href="/echo-system-design/assets/js/42.8046590d.js"><link rel="prefetch" href="/echo-system-design/assets/js/43.d1865983.js"><link rel="prefetch" href="/echo-system-design/assets/js/44.abab45ac.js"><link rel="prefetch" href="/echo-system-design/assets/js/45.685623ac.js"><link rel="prefetch" href="/echo-system-design/assets/js/46.7624d38c.js"><link rel="prefetch" href="/echo-system-design/assets/js/47.5646b068.js"><link rel="prefetch" href="/echo-system-design/assets/js/48.a1b270df.js"><link rel="prefetch" href="/echo-system-design/assets/js/49.ee9681bc.js"><link rel="prefetch" href="/echo-system-design/assets/js/5.94727770.js"><link rel="prefetch" href="/echo-system-design/assets/js/50.b424b2c0.js"><link rel="prefetch" href="/echo-system-design/assets/js/51.98ad3d82.js"><link rel="prefetch" href="/echo-system-design/assets/js/52.2bb763f1.js"><link rel="prefetch" href="/echo-system-design/assets/js/53.f76e624c.js"><link rel="prefetch" href="/echo-system-design/assets/js/54.3098ec9f.js"><link rel="prefetch" href="/echo-system-design/assets/js/55.01c7393b.js"><link rel="prefetch" href="/echo-system-design/assets/js/56.13fd4db7.js"><link rel="prefetch" href="/echo-system-design/assets/js/57.6175a0b4.js"><link rel="prefetch" href="/echo-system-design/assets/js/58.24008d78.js"><link rel="prefetch" href="/echo-system-design/assets/js/59.7b7e3faf.js"><link rel="prefetch" href="/echo-system-design/assets/js/6.0b558b79.js"><link rel="prefetch" href="/echo-system-design/assets/js/60.cf282dab.js"><link rel="prefetch" href="/echo-system-design/assets/js/61.11238a6f.js"><link rel="prefetch" href="/echo-system-design/assets/js/62.cc8fdced.js"><link rel="prefetch" href="/echo-system-design/assets/js/63.55fc09a9.js"><link rel="prefetch" href="/echo-system-design/assets/js/64.9b3def35.js"><link rel="prefetch" href="/echo-system-design/assets/js/65.0b2ab47d.js"><link rel="prefetch" href="/echo-system-design/assets/js/66.2ae7a107.js"><link rel="prefetch" href="/echo-system-design/assets/js/67.8e1dbb45.js"><link rel="prefetch" href="/echo-system-design/assets/js/68.cab1ea3b.js"><link rel="prefetch" href="/echo-system-design/assets/js/69.5f61d937.js"><link rel="prefetch" href="/echo-system-design/assets/js/70.b920a5f7.js"><link rel="prefetch" href="/echo-system-design/assets/js/71.c3c29d34.js"><link rel="prefetch" href="/echo-system-design/assets/js/73.526febf1.js"><link rel="prefetch" href="/echo-system-design/assets/js/74.26f8d9a5.js"><link rel="prefetch" href="/echo-system-design/assets/js/75.dc7fdd0f.js"><link rel="prefetch" href="/echo-system-design/assets/js/76.32858593.js"><link rel="prefetch" href="/echo-system-design/assets/js/77.7b3f6980.js"><link rel="prefetch" href="/echo-system-design/assets/js/78.09407d20.js"><link rel="prefetch" href="/echo-system-design/assets/js/79.a0d29bfa.js"><link rel="prefetch" href="/echo-system-design/assets/js/8.0ec7f6e8.js"><link rel="prefetch" href="/echo-system-design/assets/js/80.ddcb5191.js"><link rel="prefetch" href="/echo-system-design/assets/js/81.d124398a.js"><link rel="prefetch" href="/echo-system-design/assets/js/82.3b90a7cc.js"><link rel="prefetch" href="/echo-system-design/assets/js/83.f3a9ee0c.js"><link rel="prefetch" href="/echo-system-design/assets/js/84.eeb423e8.js"><link rel="prefetch" href="/echo-system-design/assets/js/85.4cd3a775.js"><link rel="prefetch" href="/echo-system-design/assets/js/86.931cbb70.js"><link rel="prefetch" href="/echo-system-design/assets/js/87.47ba635a.js"><link rel="prefetch" href="/echo-system-design/assets/js/88.93192130.js"><link rel="prefetch" href="/echo-system-design/assets/js/89.b5690031.js"><link rel="prefetch" href="/echo-system-design/assets/js/9.6e274fca.js"><link rel="prefetch" href="/echo-system-design/assets/js/90.cdc8eb8f.js"><link rel="prefetch" href="/echo-system-design/assets/js/91.8ad18b18.js"><link rel="prefetch" href="/echo-system-design/assets/js/92.ec3a28ed.js"><link rel="prefetch" href="/echo-system-design/assets/js/93.f8975bc4.js"><link rel="prefetch" href="/echo-system-design/assets/js/94.1eade7f0.js"><link rel="prefetch" href="/echo-system-design/assets/js/95.40b14cb6.js"><link rel="prefetch" href="/echo-system-design/assets/js/96.15d8e4f1.js"><link rel="prefetch" href="/echo-system-design/assets/js/97.280e8dd8.js"><link rel="prefetch" href="/echo-system-design/assets/js/98.b46fd254.js"><link rel="prefetch" href="/echo-system-design/assets/js/99.d1ca4fc0.js">
    <link rel="stylesheet" href="/echo-system-design/assets/css/0.styles.744b3760.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="чЫох╜Х" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/echo-system-design/" class="home-link router-link-active"><img src="/echo-system-design/img/logo.png" alt="EchoDesign" class="logo"> <span class="site-name can-hide">EchoDesign</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/echo-system-design/" class="nav-link">ЁЯПащжЦщб╡</a></div><div class="nav-item"><a href="/echo-system-design/pages/fccd91/" class="nav-link">тЬТя╕ПчГнщЧичоЧц│Х</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕шо╛шоб" class="dropdown-title"><!----> <span class="title" style="display:;">ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕шо╛шоб</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/echo-system-design/pages/252196/" class="nav-link">Redis ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/echo-system-design/pages/b9733b/" class="nav-link">Kafka ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/echo-system-design/pages/bfab10/" class="nav-link">Netty ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/echo-system-design/pages/4601ca/" class="nav-link">Nginx ч│╗ч╗Яшо╛шоб</a></li></ul></div></div><div class="nav-item"><a href="/echo-system-design/pages/84cb49/" class="nav-link">ЁЯзСтАНЁЯТ╗хоЮцИШч│╗ч╗Яшо╛шоб</a></div><div class="nav-item"><a href="/echo-system-design/pages/92b2ee/" class="nav-link">тЭУщЧочнФ</a></div><div class="nav-item"><a href="/echo-system-design/pages/52ebd8/" class="nav-link">ЁЯСАхКицАБ</a></div> <a href="https://github.com/echo-lxy/echo-system-design" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/echo-system-design/" class="nav-link">ЁЯПащжЦщб╡</a></div><div class="nav-item"><a href="/echo-system-design/pages/fccd91/" class="nav-link">тЬТя╕ПчГнщЧичоЧц│Х</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕шо╛шоб" class="dropdown-title"><!----> <span class="title" style="display:;">ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕шо╛шоб</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/echo-system-design/pages/252196/" class="nav-link">Redis ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/echo-system-design/pages/b9733b/" class="nav-link">Kafka ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/echo-system-design/pages/bfab10/" class="nav-link">Netty ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/echo-system-design/pages/4601ca/" class="nav-link">Nginx ч│╗ч╗Яшо╛шоб</a></li></ul></div></div><div class="nav-item"><a href="/echo-system-design/pages/84cb49/" class="nav-link">ЁЯзСтАНЁЯТ╗хоЮцИШч│╗ч╗Яшо╛шоб</a></div><div class="nav-item"><a href="/echo-system-design/pages/92b2ee/" class="nav-link">тЭУщЧочнФ</a></div><div class="nav-item"><a href="/echo-system-design/pages/52ebd8/" class="nav-link">ЁЯСАхКицАБ</a></div> <a href="https://github.com/echo-lxy/echo-system-design" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ф╕АуАБхЙНшиА</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ф║МуАБхЯ║чбАчЯешпЖ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ф╕ЙуАБф╕╗ч║┐ф╗╗хКб</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>хЫЫуАБцФпч║┐ф╗╗хКб</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/echo-system-design/pages/b43a19/" class="sidebar-link">LRU чнЦчХе</a></li><li><a href="/echo-system-design/pages/b43a89/" aria-current="page" class="active sidebar-link">LFU чнЦчХе</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/echo-system-design/pages/b43a89/#хЙНшиА" class="sidebar-link">хЙНшиА</a></li><li class="sidebar-sub-header level2"><a href="/echo-system-design/pages/b43a89/#цжВш┐░" class="sidebar-link">цжВш┐░</a></li><li class="sidebar-sub-header level2"><a href="/echo-system-design/pages/b43a89/#lfu-чоЧц│ХчЪДхоЮчО░" class="sidebar-link">LFU чоЧц│ХчЪДхоЮчО░</a></li><li class="sidebar-sub-header level2"><a href="/echo-system-design/pages/b43a89/#цА╗ч╗У" class="sidebar-link">цА╗ч╗У</a></li><li class="sidebar-sub-header level2"><a href="/echo-system-design/pages/b43a89/#хПВшАГш╡ДцЦЩ" class="sidebar-link">хПВшАГш╡ДцЦЩ</a></li></ul></li><li><a href="/echo-system-design/pages/f44fbe/" class="sidebar-link">Redis ш┐ЗцЬЯчнЦчХе</a></li><li><a href="/echo-system-design/pages/9b17a6/" class="sidebar-link">RDB цМБф╣ЕхМЦ</a></li><li><a href="/echo-system-design/pages/9b17a7/" class="sidebar-link">AOF цМБф╣ЕхМЦ</a></li><li><a href="/echo-system-design/pages/aa75e9/" class="sidebar-link">Redis ф╕нчЪДх╗╢ш┐ЯчЫСцОз</a></li><li><a href="/echo-system-design/pages/61d908/" class="sidebar-link">хПСх╕Гф╕ОшовщШЕ</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ф║ФуАБщЫЖч╛д</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/echo-system-design/" title="щжЦщб╡" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>Redis ч│╗ч╗Яшо╛шоб</span></li><li data-v-06225672><span data-v-06225672>хЫЫуАБцФпч║┐ф╗╗хКб</span></li></ul> <div class="info" data-v-06225672><div title="ф╜ЬшАЕ" class="author iconfont icon-touxiang" data-v-06225672><a href="https://gitee.com/brother-one" target="_blank" title="ф╜ЬшАЕ" class="beLink" data-v-06225672>echo</a></div> <div title="хИЫх╗║цЧ╢щЧ┤" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-09-15</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">чЫох╜Х</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">LFU чнЦчХе<!----></h1> <div class="page-slot page-slot-top">
    <div class="wwads-cn wwads-horizontal page-wwads" data-id="136"></div>
    <style>
      .page-wwads{
        width:100%!important;
        min-height: 0;
        margin: 0;
      }
      .page-wwads .wwads-img img{
        width:80px!important;
      }
      .page-wwads .wwads-poweredby{
        width: 40px;
        position: absolute;
        right: 25px;
        bottom: 3px;
      }
      .wwads-content .wwads-text, .page-wwads .wwads-text{
        height: 100%;
        padding-top: 5px;
        display: block;
      }
  </style>
  </div> <div class="theme-vdoing-content content__default"><div class="custom-block note"><p class="custom-block-title">цПРхЗ║щЧощвШцШпф╕АхИЗцЩ║цЕзчЪДх╝Ачлп</p> <ol><li>хЬищлШщвСшо┐щЧоф╕Оф╜ОщвСшо┐щЧочЪДцХ░цНоф╕ня╝МхжВф╜ХцЬЙцХИхЖ│хоЪхУкф╕кцХ░цНох║Фшпеф╝ШхЕИц╖Шц▒░я╝Я</li> <li>ф╕║ф╗Аф╣И LFU чоЧц│ХцпФ LRU цЫ┤щАВхРИхдДчРЖщВгф║ЫхБ╢х░ФшвлщвСч╣Бшо┐щЧочЪДцХ░цНоя╝Я</li> <li>LFU чоЧц│ХхжВф╜ХхЬич╝УхнШц╖Шц▒░ф╕нцЧвшАГшЩСшо┐щЧощвСчОЗя╝МхПИщБ┐хЕНхНХч║пчЪДшо┐щЧоцмбцХ░ч╗Яшобя╝Я</li> <li>х╜Уч╝УхнШхо╣щЗПф╕Нш╢│цЧ╢я╝МRedis чЪД LFU чоЧц│ХцШпхжВф╜ХхКицАБш░ГцХ┤хТМхЗПх░СцХ░цНошппхИдчЪДя╝Я</li> <li>хжВф╜ХхЬи Redis ф╕нщАЪш┐З LFU чоЧц│Хшо░х╜Хшо┐щЧощвСчОЗя╝Мх╣╢щБ┐хЕНшо┐щЧоцмбцХ░цЧащЩРхвЮщХ┐я╝Я</li> <li>хжВф╜ХщАЪш┐Зш░ГцХ┤ LFU чЪДшб░хЗПцЬ║хИ╢цЭех╣│шббщвСч╣Бшо┐щЧохТМщХ┐цЧ╢щЧ┤цЬкшо┐щЧочЪДцХ░цНоц╖Шц▒░я╝Я</li> <li>Redis цШпхжВф╜ХхИйчФи LFU чоЧц│ХхоЮчО░ч╝УхнШц╖Шц▒░чЪДхРМцЧ╢я╝Мчбоф┐Эч│╗ч╗ЯцАзшГ╜хТМхЖЕхнШчЪДщлШцХИф╜┐чФия╝Я</li></ol></div> <h2 id="хЙНшиА"><a href="#хЙНшиА" class="header-anchor">#</a> хЙНшиА</h2> <p>Redis хЬи 4.0 чЙИцЬмхРОя╝Мш┐Шх╝ХхЕеф║Ж LFU чоЧц│Хя╝Мф╣Ях░▒цШпя╝МцЬАф╕НщвСч╣Бф╜┐чФия╝ИLeast Frequently Usedя╝МLFUя╝Й</p> <ul><li>LFU чоЧц│ХхЬиш┐ЫшбМцХ░цНоц╖Шц▒░цЧ╢я╝Мф╝ЪцКК<strong>цЬАф╕НщвСч╣Бшо┐щЧо</strong>чЪДцХ░цНоц╖Шц▒░цОЙ</li> <li>шАМ LRU чоЧц│ХцШпцКК<strong>цЬАш┐СцЬАх░Сф╜┐чФи</strong>чЪДцХ░цНоц╖Шц▒░цОЙя╝МчЬЛш╡╖цЭеф╣ЯцШпц╖Шц▒░ф╕НщвСч╣Бшо┐щЧочЪДцХ░цНоуАВ</li></ul> <p><strong>LFU чоЧц│ХхТМ LRU чоЧц│ХчЪДхМ║хИлхИ░х║ХцЬЙхУкф║ЫхСвя╝ЯцИСф╗мхЬихоЮщЩЕхЬ║цЩпф╕ня╝МщЬАшжБф╜┐чФи LFU чоЧц│ХхРЧя╝Я</strong></p> <h2 id="цжВш┐░"><a href="#цжВш┐░" class="header-anchor">#</a> цжВш┐░</h2> <p>хЫаф╕║ LFU чоЧц│ХцШпца╣цНо <strong>цХ░цНошо┐щЧочЪДщвСчОЗ</strong> цЭещАЙцЛйшвлц╖Шц▒░цХ░цНочЪДя╝МцЙАф╗е LFU чоЧц│Хф╝Ъ <strong>шо░х╜ХцпПф╕кцХ░цНочЪДшо┐щЧоцмбцХ░</strong>уАВх╜Уф╕Аф╕кцХ░цНошвлхЖНцмбшо┐щЧоцЧ╢я╝Мх░▒ф╝ЪхвЮхКашпецХ░цНочЪДшо┐щЧоцмбцХ░уАВ</p> <p>ф╕Нш┐Зя╝Мшо┐щЧоцмбцХ░хТМшо┐щЧощвСчОЗш┐Шф╕НшГ╜хоМхЕичнЙхРМуАВ</p> <p>шо┐щЧощвСчОЗцШпцМЗхЬиф╕АхоЪцЧ╢щЧ┤хЖЕчЪДшо┐щЧоцмбцХ░я╝Мф╣Ях░▒цШпшп┤я╝МхЬишобчоЧшо┐щЧощвСчОЗцЧ╢я╝МцИСф╗мф╕Нф╗ЕщЬАшжБшо░х╜Хшо┐щЧоцмбцХ░я╝Мш┐ШшжБшо░х╜Хш┐Щф║Ышо┐щЧоцШпхЬихдЪщХ┐цЧ╢щЧ┤хЖЕцЙзшбМчЪДуАВхРжхИЩя╝МхжВцЮЬхПкшо░х╜Хшо┐щЧоцмбцХ░чЪДшпЭя╝Мх░▒<strong>ч╝║х░Сф║ЖцЧ╢щЧ┤ч╗┤х║ж</strong>чЪДф┐бцБпя╝Мш┐ЫшАМх░▒цЧац│ХцМЙчЕзщвСчОЗцЭец╖Шц▒░цХ░цНоф║Ж</p> <blockquote><p>цИСцЭеч╗Щф╜аф╕╛ф╕кф╛ЛхнРя╝МхБЗшо╛цХ░цНо A хЬи 15 хИЖщТЯхЖЕшо┐щЧоф║Ж 15 цмбя╝МцХ░цНо B хЬи 5 хИЖщТЯхЖЕшо┐щЧоф║Ж 10 цмбуАВхжВцЮЬхПкцШпцМЙшо┐щЧоцмбцХ░цЭеч╗ЯшобчЪДшпЭя╝МцХ░цНо A чЪДшо┐щЧоцмбцХ░хдзф║ОцХ░цНо Bя╝МцЙАф╗ец╖Шц▒░цХ░цНоцЧ╢ф╝Ъф╝ШхЕИц╖Шц▒░цХ░цНо BуАВф╕Нш┐Зя╝МхжВцЮЬцМЙчЕзшо┐щЧощвСчОЗцЭеч╗ЯшобчЪДшпЭя╝МцХ░цНо A чЪДшо┐щЧощвСчОЗцШп 1 хИЖщТЯшо┐щЧо 1 цмбя╝МшАМцХ░цНо B чЪДшо┐щЧощвСчОЗцШп 1 хИЖщТЯшо┐щЧо 2 цмбя╝МцЙАф╗ецМЙшо┐щЧощвСчОЗц╖Шц▒░цХ░цНочЪДшпЭя╝МцХ░цНо A х║Фшпешвлц╖Шц▒░цОЙуАВ
цЙАф╗ешп┤я╝Мх╜УшжБхоЮчО░ LFU чоЧц│ХцЧ╢я╝МцИСф╗мщЬАшжБшГ╜ч╗ЯшобхИ░цХ░цНочЪДшо┐щЧощвСчОЗя╝МшАМф╕НцШпчоАхНХхЬ░шо░х╜ХцХ░цНошо┐щЧоцмбцХ░х░▒шбМуАВ</p></blockquote> <p>щВгф╣ИцОеф╕ЛцЭея╝МцИСф╗мх░▒цЭехнжф╣аф╕Л Redis цШпхжВф╜ХхоЮчО░ LFU чоЧц│ХчЪД</p> <h2 id="lfu-чоЧц│ХчЪДхоЮчО░"><a href="#lfu-чоЧц│ХчЪДхоЮчО░" class="header-anchor">#</a> LFU чоЧц│ХчЪДхоЮчО░</h2> <p>щжЦхЕИя╝МLFU чоЧц│ХчЪДхРпчФия╝МцШпщАЪш┐Зшо╛ч╜о Redis щЕНч╜оцЦЗф╗╢ redis.conf ф╕нчЪД <code>maxmemory</code> хТМ <code>maxmemory-policy</code>уАВ</p> <ul><li><code>maxmemory</code> шо╛ч╜оф╕║ Redis ф╝ЪчФичЪДцЬАхдзхЖЕхнШхо╣щЗП</li> <li><code>maxmemory-policy</code> хПпф╗ешо╛ч╜оф╕║ <code>allkeys-lfu</code> цИЦцШп <code>volatile-lfu</code>я╝Мшбичд║ц╖Шц▒░чЪДщФохА╝хп╣ф╝ЪхИЖхИлф╗ОцЙАцЬЙщФохА╝хп╣цИЦцШпшо╛ч╜оф║Жш┐ЗцЬЯцЧ╢щЧ┤чЪДщФохА╝хп╣ф╕нчнЫщАЙ</li></ul> <p>LFU чоЧц│ХчЪДхоЮчО░хПпф╗ехИЖцИРф╕ЙщГихИЖхЖЕхо╣я╝МхИЖхИлцШп</p> <ol><li>щФохА╝хп╣шо┐щЧощвСчОЗшо░х╜Х</li> <li>щФохА╝хп╣шо┐щЧощвСчОЗхИЭхзЛхМЦхТМцЫ┤цЦ░</li> <li>LFU чоЧц│Хц╖Шц▒░цХ░цНо</li></ol> <h3 id="щФохА╝хп╣шо┐щЧощвСчОЗшо░х╜Х"><a href="#щФохА╝хп╣шо┐щЧощвСчОЗшо░х╜Х" class="header-anchor">#</a> щФохА╝хп╣шо┐щЧощвСчОЗшо░х╜Х</h3> <p>цпПф╕кщФохА╝хп╣чЪДхА╝щГ╜хп╣х║Фф║Жф╕Аф╕к<strong>redisObject</strong>ч╗УцЮДф╜Уя╝МхЕ╢ф╕нцЬЙф╕Аф╕к <strong>24 bits</strong> чЪД lru хПШщЗПуАВ</p> <p>lru хПШщЗПхЬи LRU чоЧц│ХхоЮчО░цЧ╢я╝МцШпчФицЭешо░х╜ХцХ░цНочЪДшо┐щЧоцЧ╢щЧ┤цИ│уАВхЫаф╕║ Redis server цпПцмбш┐РшбМцЧ╢я╝МхПкшГ╜х░Ж maxmemory-policy щЕНч╜ощб╣шо╛ч╜оф╕║ф╜┐чФиф╕АчзНц╖Шц▒░чнЦчХея╝МцЙАф╗ея╝М<strong>LRU чоЧц│ХхТМ LFU чоЧц│Хх╣╢ф╕Нф╝ЪхРМцЧ╢ф╜┐чФиуАВ<strong>шАМф╕║ф║ЖшКВчЬБхЖЕхнШх╝АщФАя╝МRedis ц║РчаБх░▒</strong>хдНчФи</strong>ф║Ж lru хПШщЗПцЭешо░х╜Х LFU чоЧц│ХцЙАщЬАчЪДшо┐щЧощвСчОЗф┐бцБпуАВ</p> <p><strong>ф╜ЖцШпхжВф╜ХхЬиLRUхп╣шо┐щЧоцЧ╢щЧ┤чЪДшо░х╜Хф╣Лф╕Кя╝МхЖНшо░х╜ХхЕ╢шо┐щЧощвСчОЗхСвя╝Я</strong></p> <p>хЕ╖ф╜УцЭешп┤я╝Мх╜У lru хПШщЗПчФицЭешо░х╜Х LFU чоЧц│ХчЪДцЙАщЬАф┐бцБпцЧ╢я╝МхоГф╝Ъш┐Щца╖ф╜┐чФиш┐ЩчПНш┤╡чЪД 24 bits</p> <ul><li>ф╜О 8 bitsя╝Ъф╜Ьф╕║шобцХ░хЩия╝МцЭешо░х╜ХщФохА╝хп╣чЪДшо┐щЧоцмбцХ░</li> <li>щлШ 16 bitsя╝Ъшо░х╜Хшо┐щЧочЪДцЧ╢щЧ┤цИ│</li></ul> <img src="https://echo798.oss-cn-shenzhen.aliyuncs.com/img/202409160003313.png" alt="image-20240914182346114" style="zoom:50%;"> <p>хе╜я╝Мф║Жшзгф║Ж LFU чоЧц│ХцЙАщЬАчЪДшо┐щЧощвСчОЗцШпхжВф╜Хшо░х╜ХчЪДя╝МцОеф╕ЛцЭея╝МцИСф╗мхЖНцЭечЬЛф╕ЛщФохА╝хп╣чЪДшо┐щЧощвСчОЗцШпхжВф╜ХхИЭхзЛхМЦхТМцЫ┤цЦ░чЪДуАВ</p> <h3 id="щФохА╝хп╣шо┐щЧощвСчОЗчЪДхИЭхзЛхМЦф╕ОцЫ┤цЦ░"><a href="#щФохА╝хп╣шо┐щЧощвСчОЗчЪДхИЭхзЛхМЦф╕ОцЫ┤цЦ░" class="header-anchor">#</a> щФохА╝хп╣шо┐щЧощвСчОЗчЪДхИЭхзЛхМЦф╕ОцЫ┤цЦ░</h3> <p>щжЦхЕИя╝МцИСф╗мшжБчЯещБУя╝МLFU чоЧц│ХхТМ LRU чоЧц│ХчЪДхЯ║цЬмцнещкдя╝МхоЮщЩЕф╕КцШпхЬичЫ╕хРМчЪДхЕехПгхЗ╜цХ░ф╕нцЙзшбМчЪДуАВхЫ┤ч╗Х LRU чоЧц│ХчЪДхоЮчО░я╝МцИСф╗мх╖▓ч╗Пф║ЖшзгхИ░ш┐Щф║ЫхЯ║цЬмцнещкдхМЕцЛмцХ░цНошо┐щЧоф┐бцБпчЪДхИЭхзЛхМЦуАБшо┐щЧоф┐бцБпцЫ┤цЦ░я╝Мф╗ехПКхоЮщЩЕц╖Шц▒░цХ░цНоуАВш┐Щф║Ыцнещкдхп╣х║ФчЪДхЕехПгхЗ╜цХ░хжВф╕ЛшбицЙАчд║я╝Мф╜аф╣ЯхПпф╗ехЖНхО╗хЫЮщб╛ф╕ЛхЖЕхо╣уАВ</p> <img src="https://echo798.oss-cn-shenzhen.aliyuncs.com/img/202409160003303.png" alt="image-20240914182459060" style="zoom:50%;"> <p>ф║Жшзгф║Жш┐Щф║ЫхЕехПгхЗ╜цХ░хРОя╝МцИСф╗мхЖНхО╗хИЖцЮР LFU чоЧц│ХчЪДхоЮчО░я╝Мх░▒хо╣цШУцЙ╛хИ░хп╣х║ФчЪДхЗ╜цХ░ф║ЖуАВ</p> <p>хп╣ф║ОщФохА╝хп╣шо┐щЧощвСчОЗчЪДхИЭхзЛхМЦцЭешп┤я╝Мх╜Уф╕Аф╕кщФохА╝хп╣швлхИЫх╗║хРОя╝МcreateObject хЗ╜цХ░х░▒ф╝Ъшвлш░ГчФия╝МчФицЭехИЖщЕН redisObject ч╗УцЮДф╜УчЪДчй║щЧ┤хТМшо╛ч╜охИЭхзЛхМЦхА╝уАВхжВцЮЬ Redis х░Ж maxmemory-policy шо╛ч╜оф╕║ LFU чоЧц│Хя╝МщВгф╣Ия╝МщФохА╝хп╣ redisObject ч╗УцЮДф╜Уф╕нчЪД lru хПШщЗПхИЭхзЛхМЦхА╝я╝Мф╝ЪчФ▒ф╕дщГихИЖч╗ДцИРя╝Ъ</p> <ul><li>чммф╕АщГихИЖцШп lru хПШщЗПчЪДщлШ 16 ф╜Ня╝МцШпф╗е 1 хИЖщТЯф╕║ч▓╛х║жчЪД UNIX цЧ╢щЧ┤цИ│уАВш┐ЩцШпщАЪш┐Зш░ГчФи LFUGetTimeInMinutes хЗ╜цХ░я╝ИхЬи evict.c цЦЗф╗╢ф╕ня╝ЙшобчоЧх╛ЧхИ░чЪДуАВ</li> <li>чммф║МщГихИЖцШп lru хПШщЗПчЪДф╜О 8 ф╜Ня╝Мшвлшо╛ч╜оф╕║хоПхоЪф╣Й LFU_INIT_VALя╝ИхЬи server.h цЦЗф╗╢ф╕ня╝Йя╝Мщ╗ШшодхА╝ф╕║ 5уАВ</li></ul> <p>ф╜аф╝ЪхПСчО░я╝Мш┐ЩхТМцИСхИЪцЙНч╗Щф╜аф╗Лч╗НчЪДщФохА╝хп╣шо┐щЧощвСчОЗшо░х╜ХцШпф╕АшЗ┤чЪДя╝Мф╣Ях░▒цШпшп┤я╝Мх╜Уф╜┐чФи LFU чоЧц│ХцЧ╢я╝Мlru хПШщЗПхМЕцЛмф║Ж<strong>щФохА╝хп╣чЪДшо┐щЧоцЧ╢щЧ┤цИ│хТМшо┐щЧоцмбцХ░</strong>уАВф╗еф╕Лф╗гчаБф╣Ях▒Хчд║ф║Жш┐ЩщГихИЖчЪДцЙзшбМщА╗ш╛Ся╝Мф╜ахПпф╗ечЬЛф╕ЛуАВ</p> <div class="language-c extra-class"><pre class="language-c"><code>robj <span class="token operator">*</span><span class="token function">createObject</span><span class="token punctuation">(</span><span class="token keyword">int</span> type<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    robj <span class="token operator">*</span>o <span class="token operator">=</span> <span class="token function">zmalloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>o<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    o<span class="token operator">-&gt;</span>type <span class="token operator">=</span> type<span class="token punctuation">;</span>
    o<span class="token operator">-&gt;</span>encoding <span class="token operator">=</span> OBJ_ENCODING_RAW<span class="token punctuation">;</span>
    o<span class="token operator">-&gt;</span>ptr <span class="token operator">=</span> ptr<span class="token punctuation">;</span>
    o<span class="token operator">-&gt;</span>refcount <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token comment">/* Set the LRU to the current lruclock (minutes resolution), or
     * alternatively the LFU counter. */</span>
    <span class="token comment">// ф╜┐чФиLFUчоЧц│ХцЧ╢я╝МlruхПШщЗПхМЕцЛмф╗ехИЖщТЯф╕║ч▓╛х║жчЪДUNIXцЧ╢щЧ┤цИ│хТМшо┐щЧоцмбцХ░5</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>server<span class="token punctuation">.</span>maxmemory_policy <span class="token operator">&amp;</span> MAXMEMORY_FLAG_LFU<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        o<span class="token operator">-&gt;</span>lru <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">LFUGetTimeInMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> LFU_INIT_VAL<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        o<span class="token operator">-&gt;</span>lru <span class="token operator">=</span> <span class="token function">LRU_CLOCK</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> o<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/* Return the current time in minutes, just taking the least significant
 * 16 bits. The returned time is suitable to be stored as LDT (last decrement
 * time) for the LFU implementation. */</span>
<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">LFUGetTimeInMinutes</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>server<span class="token punctuation">.</span>unixtime<span class="token operator">/</span><span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">65535</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">LFU_INIT_VAL</span> <span class="token expression"><span class="token number">5</span></span></span>
</code></pre></div><p>ф╕ЛщЭвя╝МцИСф╗мхЖНцЭечЬЛф╕ЛщФохА╝хп╣шо┐щЧощвСчОЗчЪДцЫ┤цЦ░уАВ</p> <p>х╜Уф╕Аф╕кщФохА╝хп╣швлшо┐щЧоцЧ╢я╝МRedis ф╝Ъш░ГчФи lookupKey хЗ╜цХ░ш┐ЫшбМцЯецЙ╛уАВх╜У maxmemory-policy шо╛ч╜оф╜┐чФи LFU чоЧц│ХцЧ╢я╝МlookupKey хЗ╜цХ░ф╝Ъш░ГчФи updateLFU хЗ╜цХ░цЭецЫ┤цЦ░щФохА╝хп╣чЪДшо┐щЧощвСчОЗя╝Мф╣Ях░▒цШп lru хПШщЗПхА╝я╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/* Low level key lookup API, not actually called directly from commands
 * implementations that should instead rely on lookupKeyRead(),
 * lookupKeyWrite() and lookupKeyReadWithFlags(). */</span>
robj <span class="token operator">*</span><span class="token function">lookupKey</span><span class="token punctuation">(</span>redisDb <span class="token operator">*</span>db<span class="token punctuation">,</span> robj <span class="token operator">*</span>key<span class="token punctuation">,</span> <span class="token keyword">int</span> flags<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    dictEntry <span class="token operator">*</span>de <span class="token operator">=</span> <span class="token function">dictFind</span><span class="token punctuation">(</span>db<span class="token operator">-&gt;</span>dict<span class="token punctuation">,</span>key<span class="token operator">-&gt;</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>de<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        robj <span class="token operator">*</span>val <span class="token operator">=</span> <span class="token function">dictGetVal</span><span class="token punctuation">(</span>de<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/* Update the access time for the ageing algorithm.
         * Don't do it if we have a saving child, as this will trigger
         * a copy on write madness. */</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">hasActiveChildProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span>flags <span class="token operator">&amp;</span> LOOKUP_NOTOUCH<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">// ф╜┐чФиLFUчоЧц│ХцЧ╢я╝Мш░ГчФиupdateLFUхЗ╜цХ░цЫ┤цЦ░шо┐щЧощвСчОЗ</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>server<span class="token punctuation">.</span>maxmemory_policy <span class="token operator">&amp;</span> MAXMEMORY_FLAG_LFU<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">updateLFU</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token comment">// ф╜┐чФиLRUчоЧц│ХцЧ╢я╝Мш░ГчФиLRU_CLOCK</span>
                val<span class="token operator">-&gt;</span>lru <span class="token operator">=</span> <span class="token function">LRU_CLOCK</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>updateLFU хЗ╜цХ░цШпхЬи db.c цЦЗф╗╢ф╕нхоЮчО░чЪДя╝МхоГчЪДцЙзшбМщА╗ш╛СцпФш╛ГцШОчбоя╝Мф╕АхЕ▒хИЖцИРф╕ЙцнеуАВ</p> <h4 id="чммф╕Ацне-шб░хЗПшо┐щЧоцмбцХ░"><a href="#чммф╕Ацне-шб░хЗПшо┐щЧоцмбцХ░" class="header-anchor">#</a> <strong>чммф╕Ацнея╝Мшб░хЗПшо┐щЧоцмбцХ░</strong></h4> <p>updateLFU хЗ╜цХ░щжЦхЕИф╝Ъш░ГчФи LFUDecrAndReturn хЗ╜цХ░я╝ИхЬи evict.c цЦЗф╗╢ф╕ня╝Йя╝Мхп╣щФохА╝хп╣чЪДшо┐щЧоцмбцХ░ш┐ЫшбМшб░хЗПцУНф╜Ья╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/* Update LFU when an object is accessed.
 * Firstly, decrement the counter if the decrement time is reached.
 * Then logarithmically increment the counter, and update the access time. */</span>
<span class="token keyword">void</span> <span class="token function">updateLFU</span><span class="token punctuation">(</span>robj <span class="token operator">*</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// щжЦхЕИя╝МщАТхЗПшобцХ░хЩи</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> counter <span class="token operator">=</span> <span class="token function">LFUDecrAndReturn</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// чД╢хРОф╗еlogNч║зхИлщАТхвЮшобцХ░хЩия╝Мх╣╢цЫ┤цЦ░шо┐щЧоцмбцХ░уАВ</span>
    counter <span class="token operator">=</span> <span class="token function">LFULogIncr</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">;</span>
    val<span class="token operator">-&gt;</span>lru <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">LFUGetTimeInMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> counter<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>чЬЛхИ░ш┐ЩщЗМя╝Мф╜ахПпшГ╜ф╝ЪцЬЙчЦСщЧоя╝Ъ<strong>шо┐щЧощФохА╝хп╣цЧ╢ф╕НцШпшжБхвЮхКащФохА╝хп╣чЪДшо┐щЧоцмбцХ░хРЧя╝Мф╕║ф╗Аф╣ИшжБхЕИшб░хЗПшо┐щЧоцмбцХ░хСвя╝Я</strong></p> <p>хЕ╢хоЮя╝Мш┐Щх░▒цШпцИСхЬихЙНщЭвф╕Ах╝АхзЛхТМф╜аф╗Лч╗НчЪДя╝МLFU чоЧц│ХцШпца╣цНошо┐щЧощвСчОЗцЭец╖Шц▒░цХ░цНочЪДя╝МшАМф╕НхПкцШпшо┐щЧоцмбцХ░уАВшо┐щЧощвСчОЗщЬАшжБшАГшЩСщФохА╝хп╣чЪДшо┐щЧоцШпхдЪщХ┐цЧ╢щЧ┤цо╡хЖЕхПСчФЯчЪДуАВ<strong>щФохА╝хп╣чЪДхЕИхЙНшо┐щЧош╖Эчж╗х╜УхЙНцЧ╢щЧ┤ш╢КщХ┐я╝МщВгф╣Иш┐Щф╕кщФохА╝хп╣чЪДшо┐щЧощвСчОЗчЫ╕х║ФхЬ░ф╣Ях░▒ф╝ЪщЩНф╜О</strong>уАВ</p> <p>цИСч╗Щф╜аф╕╛ф╕кф╛ЛхнРя╝МхБЗшо╛цХ░цНо A хЬицЧ╢хИ╗ T хИ░ T+10 хИЖщТЯш┐Щцо╡цЧ╢щЧ┤хЖЕя╝Мшвлшо┐щЧоф║Ж 30 цмбя╝МщВгф╣Ия╝Мш┐Щцо╡цЧ╢щЧ┤хЖЕцХ░цНо A чЪДшо┐щЧощвСчОЗхПпф╗ешобчоЧф╕║ 3 цмб / хИЖщТЯя╝И30 цмб /10 хИЖщТЯ = 3 цмб / хИЖщТЯя╝ЙуАВ</p> <p>ч┤зцОечЭАя╝МхЬи T+10 хИЖщТЯхИ░ T+20 хИЖщТЯш┐Щцо╡цЧ╢щЧ┤хЖЕя╝МцХ░цНо A ц▓бцЬЙхЖНшвлшо┐щЧоя╝МщВгф╣ИцндцЧ╢я╝МхжВцЮЬцИСф╗мшобчоЧцХ░цНо A хЬи T хИ░ T+20 хИЖщТЯш┐Щцо╡цЧ╢щЧ┤хЖЕчЪДшо┐щЧощвСчОЗя╝МхоГчЪДшо┐щЧощвСчОЗх░▒ф╝ЪщЩНф╕║ 1.5 цмб / хИЖщТЯя╝И30 цмб /20 хИЖщТЯ = 1.5 цмб / хИЖщТЯя╝ЙуАВф╗ецндч▒╗цОия╝МщЪПчЭАцЧ╢щЧ┤чЪДцОичз╗я╝МхжВцЮЬцХ░цНо A хЬи T+10 хИЖщТЯхРОф╕АчЫ┤ц▓бцЬЙцЦ░чЪДшо┐щЧоя╝МщВгф╣ИхоГчЪДшо┐щЧощвСчОЗх░▒ф╝ЪщАРцнещЩНф╜ОуАВш┐Щх░▒цШпцЙАш░УчЪДшо┐щЧощвСчОЗшб░хЗПуАВ</p> <p>хЫаф╕║ Redis цШпф╜┐чФи lru хПШщЗПф╕нчЪДшо┐щЧоцмбцХ░цЭешбичд║шо┐щЧощвСчОЗя╝МцЙАф╗ехЬицпПцмбцЫ┤цЦ░щФохА╝хп╣чЪДшо┐щЧощвСчОЗцЧ╢я╝Мх░▒ф╝ЪщАЪш┐З LFUDecrAndReturn хЗ╜цХ░хп╣шо┐щЧоцмбцХ░ш┐ЫшбМшб░хЗПуАВ</p> <p>хЕ╖ф╜УцЭешп┤я╝МLFUDecrAndReturn хЗ╜цХ░ф╝ЪщжЦхЕИшО╖хПЦх╜УхЙНщФохА╝хп╣чЪДф╕Кф╕Ацмбшо┐щЧоцЧ╢щЧ┤я╝Мш┐ЩцШпф┐ЭхнШхЬи lru хПШщЗПщлШ 16 ф╜Нф╕КчЪДхА╝уАВчД╢хРОя╝МLFUDecrAndReturn хЗ╜цХ░ф╝Ъца╣цНохЕих▒АхПШщЗП server чЪД lru_decay_time цИРхСШхПШщЗПчЪДхПЦхА╝я╝МцЭешобчоЧшб░хЗПчЪДхдзх░П num_periodуАВ</p> <p>ш┐Щф╕кшобчоЧш┐ЗчиЛф╝ЪхИдцЦн lfu_decay_time чЪДхА╝цШпхРжф╕║ 0уАВхжВцЮЬ lfu_decay_time хА╝ф╕║ 0я╝МщВгф╣Ишб░хЗПхдзх░Пф╣Яф╕║ 0уАВцндцЧ╢я╝Мшо┐щЧоцмбцХ░ф╕Нш┐ЫшбМшб░хЗПуАВ</p> <p>хРжхИЩчЪДшпЭя╝МLFUDecrAndReturn хЗ╜цХ░ф╝Ъш░ГчФи LFUTimeElapsed хЗ╜цХ░я╝ИхЬи evict.c цЦЗф╗╢ф╕ня╝Йя╝М<strong>шобчоЧш╖Эчж╗щФохА╝хп╣чЪДф╕Кф╕Ацмбшо┐щЧох╖▓ч╗Пш┐ЗхО╗чЪДцЧ╢щХ┐</strong>уАВш┐Щф╕кцЧ╢щХ┐ф╣ЯцШпф╗е 1 хИЖщТЯф╕║ч▓╛х║жцЭешобчоЧчЪДуАВцЬЙф║Жш╖Эчж╗ф╕Кцмбшо┐щЧочЪДцЧ╢щХ┐хРОя╝МLFUDecrAndReturn хЗ╜цХ░ф╝ЪцККш┐Щф╕кцЧ╢щХ┐щЩдф╗е lfu_decay_time чЪДхА╝я╝Мх╣╢цККч╗УцЮЬф╜Ьф╕║шо┐щЧоцмбцХ░чЪДшб░хЗПхдзх░ПуАВ</p> <p>ш┐ЩщЗМя╝Мф╜ащЬАшжБц│ицДПчЪДцШпя╝Мlfu_decay_time хПШщЗПхА╝я╝МцШпчФ▒ redis.conf цЦЗф╗╢ф╕нчЪДщЕНч╜ощб╣ lfu-decay-time цЭехЖ│хоЪчЪДуАВRedis хЬихИЭхзЛхМЦцЧ╢я╝Мф╝ЪщАЪш┐З initServerConfig хЗ╜цХ░цЭешо╛ч╜о lfu_decay_time хПШщЗПчЪДхА╝я╝Мщ╗ШшодхА╝ф╕║ 1уАВцЙАф╗ея╝МхЬищ╗ШшодцГЕхЖ╡ф╕Ля╝М<strong>шо┐щЧоцмбцХ░чЪДшб░хЗПхдзх░Пх░▒цШпчнЙф║Оф╕Кф╕Ацмбшо┐щЧош╖Эчж╗х╜УхЙНчЪДхИЖщТЯцХ░</strong>уАВцпФхжВя╝МхБЗшо╛ф╕Кф╕Ацмбшо┐щЧоцШп 10 хИЖщТЯхЙНя╝МщВгф╣ИхЬищ╗ШшодцГЕхЖ╡ф╕Ля╝Мшо┐щЧоцмбцХ░чЪДшб░хЗПхдзх░Пх░▒чнЙф║О 10уАВ</p> <p>х╜УчД╢я╝МхжВцЮЬф╕Кф╕Ацмбшо┐щЧош╖Эчж╗х╜УхЙНчЪДхИЖщТЯцХ░я╝Мх╖▓ч╗Пш╢Еш┐Зшо┐щЧоцмбцХ░чЪДхА╝ф║Жя╝МщВгф╣Ишо┐щЧоцмбцХ░х░▒ф╝Ъшвлшо╛ч╜оф╕║ 0я╝Мш┐Щх░▒шбичд║щФохА╝хп╣х╖▓ч╗Пх╛ИщХ┐цЧ╢щЧ┤ц▓бцЬЙшвлшо┐щЧоф║ЖуАВ</p> <p>ф╕ЛщЭвчЪДф╗гчаБх▒Хчд║ф║Ж LFUDecrAndReturn хЗ╜цХ░чЪДцЙзшбМщА╗ш╛Ся╝Мф╜ахПпф╗ечЬЛф╕ЛуАВ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/* If the object decrement time is reached decrement the LFU counter but
 * do not update LFU fields of the object, we update the access time
 * and counter in an explicit way when the object is really accessed.
 * And we will times halve the counter according to the times of
 * elapsed time than server.lfu_decay_time.
 * Return the object frequency counter.
 *
 * This function is used in order to scan the dataset for the best object
 * to fit: as we check for the candidate, we incrementally decrement the
 * counter of the scanned objects if needed. */</span>
<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">LFUDecrAndReturn</span><span class="token punctuation">(</span>robj <span class="token operator">*</span>o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// шО╖хПЦх╜УхЙНщФохА╝хп╣чЪДф╕Кф╕Ацмбшо┐щЧоцЧ╢щЧ┤я╝МlruхП│чз╗8ф╜Ня╝МчЫ╕х╜Уф║Оф┐ЭчХЩчЪДцШпхЙНщЭв16ф╜НчЪДцЧ╢щЧ┤цИ│</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> ldt <span class="token operator">=</span> o<span class="token operator">-&gt;</span>lru <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token comment">// шО╖хПЦх╜УхЙНчЪДшо┐щЧоцмбцХ░я╝МчЫ╕х╜Уф║ОхРО8ф╜Нф╕О255хБЪф╕Ош┐РчоЧя╝МхН│х╛ЧхИ░шобцХ░хЩи</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> counter <span class="token operator">=</span> o<span class="token operator">-&gt;</span>lru <span class="token operator">&amp;</span> <span class="token number">255</span><span class="token punctuation">;</span>
    <span class="token comment">// шобчоЧшб░хЗПхдзх░П</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> num_periods <span class="token operator">=</span> server<span class="token punctuation">.</span>lfu_decay_time <span class="token operator">?</span> <span class="token function">LFUTimeElapsed</span><span class="token punctuation">(</span>ldt<span class="token punctuation">)</span> <span class="token operator">/</span> server<span class="token punctuation">.</span>lfu_decay_time <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">// хжВцЮЬшб░хЗПхдзх░Пф╕Нф╕║0</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>num_periods<span class="token punctuation">)</span>
        <span class="token comment">// хжВцЮЬшб░хЗПхдзх░Пх░Пф║Ох╜УхЙНшо┐щЧоцмбцХ░я╝МщВгф╣Ия╝Мшб░хЗПхРОчЪДшо┐щЧоцмбцХ░цШпх╜УхЙНшо┐щЧоцмбцХ░хЗПхО╗шб░хЗПхдзх░Пя╝ЫхРжхИЩя╝Мшб░хЗПхРОчЪДшо┐щЧоцмбцХ░чнЙф║О0</span>
        counter <span class="token operator">=</span> <span class="token punctuation">(</span>num_periods <span class="token operator">&gt;</span> counter<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> counter <span class="token operator">-</span> num_periods<span class="token punctuation">;</span>
    <span class="token comment">// хжВцЮЬшб░хЗПхдзх░Пф╕║0я╝МхИЩш┐ФхЫЮхОЯцЭечЪДшо┐щЧоцмбцХ░</span>
    <span class="token keyword">return</span> counter<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>хе╜ф║Жя╝МхИ░ш┐ЩщЗМя╝МupdateLFU хЗ╜цХ░х░▒щАЪш┐З LFUDecrAndReturn хЗ╜цХ░я╝МхоМцИРф║ЖщФохА╝хп╣шо┐щЧоцмбцХ░чЪДшб░хЗПуАВч┤зцОечЭАя╝МupdateLFU хЗ╜цХ░ш┐ШцШпф╝ЪхЯ║ф║ОщФохА╝хп╣х╜УхЙНчЪДш┐Щцмбшо┐щЧоя╝МцЭецЫ┤цЦ░хоГчЪДшо┐щЧоцмбцХ░уАВ</p> <h4 id="чммф║Мцне-ца╣цНох╜УхЙНшо┐щЧоцЫ┤цЦ░шо┐щЧоцмбцХ░"><a href="#чммф║Мцне-ца╣цНох╜УхЙНшо┐щЧоцЫ┤цЦ░шо┐щЧоцмбцХ░" class="header-anchor">#</a> чммф║Мцнея╝Мца╣цНох╜УхЙНшо┐щЧоцЫ┤цЦ░шо┐щЧоцмбцХ░</h4> <p>хЬиш┐Щф╕Ацнеф╕ня╝МupdateLFU хЗ╜цХ░ф╝Ъш░ГчФи LFULogIncr хЗ╜цХ░я╝МцЭехвЮхКащФохА╝хп╣чЪДшо┐щЧоцмбцХ░я╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/* Logarithmically increment a counter. The greater is the current counter value
 * the less likely is that it gets really implemented. Saturate it at 255. */</span>
<span class="token comment">// хп╣цХ░щАТхвЮшобцХ░хА╝</span>
<span class="token comment">//ца╕х┐Гх░▒цШпшо┐щЧоцмбцХ░ш╢Кхдзя╝Мшо┐щЧоцмбцХ░швлщАТхвЮчЪДхПпшГ╜цАзш╢Кх░Пя╝МцЬАхдз 255я╝МцндхдЦф╜ахПпф╗ехЬищЕНч╜о redis.conf ф╕нхЖЩцШОшо┐щЧохдЪх░СцмбщАТхвЮхдЪх░СуАВ</span>
<span class="token class-name">uint8_t</span> <span class="token function">LFULogIncr</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> counter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// хИ░цЬАхдзхА╝ф║Жя╝Мф╕НшГ╜хЬихвЮхКаф║Ж</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>counter <span class="token operator">==</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">255</span><span class="token punctuation">;</span>
    <span class="token comment">//    rand()ф║зчФЯф╕Аф╕к0-0x7fffчЪДщЪПцЬ║цХ░,ф╕Аф╕кщЪПцЬ║цХ░хО╗щЩдф╗е RAND_MAXф╣Ях░▒цШпOx7FFFя╝Мф╣Ях░▒цШпщЪПцЬ║цжВчОЗ</span>
    <span class="token keyword">double</span> r <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>RAND_MAX<span class="token punctuation">;</span>
    <span class="token comment">// хЗПхО╗цЦ░хп╣ш▒бхИЭхзЛхМЦчЪДхЯ║цХ░хА╝ (LFU_INIT_VAL щ╗ШшодцШп 5)</span>
    <span class="token keyword">double</span> baseval <span class="token operator">=</span> counter <span class="token operator">-</span> LFU_INIT_VAL<span class="token punctuation">;</span>
    <span class="token comment">// baseval хжВцЮЬх░Пф║ОщЫ╢я╝Мшп┤цШОш┐Щф╕кхп╣ш▒бх┐лф╕НшбМф║Жя╝Мф╕Нш┐ЗцЬмцмб incr х░Жф╝Ъх╗╢щХ┐хоГчЪДхп┐хС╜</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>baseval <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> baseval <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">// baseval * LFU хп╣цХ░шобцХ░хЩихЫахнР + 1ф┐ЭшпБхИЖцпНхдзф║О1</span>
    <span class="token comment">// х╜У baseval чЙ╣хИлхдзцЧ╢я╝МцЬАхдзцШп (255-5)я╝Мp хА╝ф╝ЪщЭЮх╕╕х░Пя╝Мх╛ИщЪ╛ф╝Ъш╡░хИ░ counter++ ш┐Щф╕Ацне</span>
    <span class="token comment">// p х░▒цШп counter щАЪх╛А [+1] цЭГхКЫчЪДщЧич╝Эя╝Мbaseval ш╢Кхдзя╝Мш┐Щф╕кщЧич╝Эш╢КчкДя╝МщАЪш┐Зх░▒ш╢КшЙ░щЪ╛</span>
    <span class="token keyword">double</span> p <span class="token operator">=</span> <span class="token number">1.0</span><span class="token operator">/</span><span class="token punctuation">(</span>baseval<span class="token operator">*</span>server<span class="token punctuation">.</span>lfu_log_factor<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// хжВцЮЬщЪПцЬ║цжВчОЗх░Пф║Ох╜УхЙНшобчоЧчЪДшо┐щЧоцжВчОЗя╝МщВгф╣Ишо┐щЧоцмбцХ░хКа1</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token operator">&lt;</span> p<span class="token punctuation">)</span> counter<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> counter<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><p>чммф╕Аф╕кхИЖцФпхп╣х║Фф║Жх╜УхЙНшо┐щЧоцмбцХ░чнЙф║ОцЬАхдзхА╝ 255 чЪДцГЕхЖ╡уАВцндцЧ╢я╝МLFULogIncr хЗ╜цХ░ф╕НхЖНхвЮхКашо┐щЧоцмбцХ░уАВ</p></li> <li><p>чммф║Мф╕кхИЖцФпхп╣х║Фф║Жх╜УхЙНшо┐щЧоцмбцХ░х░Пф║О 255 чЪДцГЕхЖ╡уАВцндцЧ╢я╝МLFULogIncr хЗ╜цХ░ф╝ЪшобчоЧф╕Аф╕кщШИхА╝ pя╝Мф╗ехПКф╕Аф╕кхПЦхА╝ф╕║ 0 хИ░ 1 ф╣ЛщЧ┤чЪДщЪПцЬ║цжВчОЗхА╝ rуАВхжВцЮЬцжВчОЗ r х░Пф║ОщШИхА╝ pя╝МщВгф╣И LFULogIncr хЗ╜цХ░цЙНф╝Ъх░Жшо┐щЧоцмбцХ░хКа 1уАВхРжхИЩчЪДшпЭя╝МLFULogIncr хЗ╜цХ░ф╝Ъш┐ФхЫЮх╜УхЙНчЪДшо┐щЧоцмбцХ░я╝Мф╕НхБЪцЫ┤цЦ░уАВ</p></li></ul> <p>ф╗Ош┐ЩщЗМф╜ахПпф╗ечЬЛхИ░я╝МхЫаф╕║цжВчОЗхА╝ r цШпщЪПцЬ║хоЪчЪДя╝МцЙАф╗ея╝МщШИхА╝ p чЪДхдзх░Пх░▒хЖ│хоЪф║Жшо┐щЧоцмбцХ░хвЮхКачЪДщЪ╛х║жуАВщШИхА╝ p ш╢Кх░Пя╝МцжВчОЗхА╝ r х░Пф║О p чЪДхПпшГ╜цАзф╣Яш╢Кх░Пя╝МцндцЧ╢я╝Мшо┐щЧоцмбцХ░ф╣Яш╢КщЪ╛хвЮхКая╝ЫчЫ╕хПНя╝МхжВцЮЬщШИхА╝ p ш╢Кхдзя╝МцжВчОЗхА╝ r х░Пф║О p чЪДхПпшГ╜цАзх░▒ш╢Кхдзя╝Мшо┐щЧоцмбцХ░х░▒ш╢Кхо╣цШУхвЮхКауАВ</p> <p>шАМщШИхА╝ p чЪДхА╝хдзх░Пя╝МхЕ╢хоЮцШпчФ▒ф╕дф╕кхЫач┤ахЖ│хоЪчЪДуАВф╕Аф╕кцШпх╜УхЙНшо┐щЧоцмбцХ░хТМхоПхоЪф╣Й LFU_INIT_VAL чЪДх╖охА╝ basevalя╝МхПжф╕Аф╕кцШп reids.conf цЦЗф╗╢ф╕нхоЪф╣ЙчЪДщЕНч╜ощб╣ lfu-log-factorуАВ</p> <p>х╜УшобчоЧщШИхА╝ p цЧ╢я╝МцИСф╗мцШпцКК baseval хТМ lfu-log-factor ф╣ШчзпхРОя╝МхКаф╕К 1я╝МчД╢хРОхЖНхПЦхЕ╢хАТцХ░уАВцЙАф╗ея╝Мbaseval цИЦшАЕ lfu-log-factor ш╢Кхдзя╝МщВгф╣ИхЕ╢хАТцХ░х░▒ш╢Кх░Пя╝Мф╣Ях░▒цШпщШИхА╝ p х░▒ш╢Кх░Пя╝ЫхПНф╣Ля╝МщШИхА╝ p х░▒ш╢КхдзуАВф╣Ях░▒цШпшп┤я╝Мш┐ЩщЗМхЕ╢хоЮх░▒хп╣х║Фф║Жф╕дчзНх╜▒хУНхЫач┤ауАВ</p> <ul><li>baseval чЪДхдзх░Пя╝Ъш┐ЩхПНцШаф║Жх╜УхЙНшо┐щЧоцмбцХ░чЪДхдЪх░СуАВцпФхжВя╝Мшо┐щЧоцмбцХ░ш╢КхдЪчЪДщФохА╝хп╣я╝МхоГчЪДшо┐щЧоцмбцХ░хЖНхвЮхКачЪДщЪ╛х║жх░▒ф╝Ъш╢Кхдзя╝Ы(цЬЙчВ╣ч▒╗ф╝╝цМЗцХ░щААщБ┐чоЧц│Х)</li> <li>lfu-log-factor чЪДхдзх░Пя╝Ъш┐ЩцШпхПпф╗ешвлшо╛ч╜очЪДуАВф╣Ях░▒цШпшп┤я╝МRedis ц║РчаБцПРф╛Ыф║ЖшойцИСф╗мф║║ф╕║ш░ГшКВшо┐щЧоцмбцХ░хвЮхКащЪ╛х║жчЪДцЦ╣ц│ХуАВ</li></ul> <p>ш┐Щца╖я╝МчнЙхИ░ LFULogIncr хЗ╜цХ░цЙзшбМхоМцИРхРОя╝МщФохА╝хп╣чЪДшо┐щЧоцмбцХ░х░▒чоЧцЫ┤цЦ░хоМф║ЖуАВ</p> <h4 id="чммф╕Йцне-цЫ┤цЦ░-lru-хПШщЗПхА╝"><a href="#чммф╕Йцне-цЫ┤цЦ░-lru-хПШщЗПхА╝" class="header-anchor">#</a> чммф╕Йцнея╝МцЫ┤цЦ░ lru хПШщЗПхА╝</h4> <p>цЬАхРОя╝МхИ░ш┐Щф╕Ацнея╝МupdateLFU хЗ╜цХ░х╖▓ч╗ПхоМцИРф║ЖщФохА╝хп╣шо┐щЧоцмбцХ░чЪДцЫ┤цЦ░уАВцОечЭАя╝МхоГх░▒ф╝Ъш░ГчФи LFUGetTimeInMinutes хЗ╜цХ░я╝МцЭешО╖хПЦх╜УхЙНчЪДцЧ╢щЧ┤цИ│я╝Мх╣╢хТМцЫ┤цЦ░хРОчЪДшо┐щЧоцмбцХ░ч╗ДхРИя╝Мх╜вцИРцЬАцЦ░чЪДшо┐щЧощвСчОЗф┐бцБпя╝Мш╡ЛхА╝ч╗ЩщФохА╝хп╣чЪД lru хПШщЗПя╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">updateLFU</span><span class="token punctuation">(</span>robj <span class="token operator">*</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    val<span class="token operator">-&gt;</span>lru <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">LFUGetTimeInMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> counter<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>хе╜ф║Жя╝МхИ░ш┐ЩщЗМя╝Мф╜ах░▒ф║Жшзгф║Жя╝МRedis ц║РчаБхЬицЫ┤цЦ░щФохА╝хп╣шо┐щЧощвСчОЗцЧ╢я╝Мхп╣ф║Ошо┐щЧоцмбцХ░я╝МхоГцШпхЕИцМЙчЕзф╕Кцмбшо┐щЧош╖Эчж╗х╜УхЙНчЪДцЧ╢щХ┐я╝МцЭехп╣шо┐щЧоцмбцХ░ш┐ЫшбМшб░хЗПуАВчД╢хРОя╝МхЖНцМЙчЕзф╕АхоЪцжВчОЗхвЮхКашо┐щЧоцмбцХ░уАВш┐Щца╖чЪДшо╛шобцЦ╣ц│Хя╝Мх░▒цЧвхМЕхРлф║Жшо┐щЧочЪДцЧ╢щЧ┤цо╡хп╣шо┐щЧощвСчОЗчЪДх╜▒хУНя╝Мф╣ЯщБ┐хЕНф║Ж 8 bits шобцХ░хЩихп╣шо┐щЧоцмбцХ░чЪДх╜▒хУНуАВшАМхп╣ф║Ошо┐щЧоцЧ╢щЧ┤цЭешп┤я╝МRedis ш┐Шф╝ЪшО╖хПЦцЬАцЦ░шо┐щЧоцЧ╢щЧ┤цИ│х╣╢цЫ┤цЦ░хИ░ lru хПШщЗПф╕н</p> <p>щВгф╣ИцЬАхРОя╝МцИСф╗мхЖНцЭечЬЛф╕Л Redis цШпхжВф╜ХхЯ║ф║О LFU чоЧц│Хц╖Шц▒░цХ░цНочЪД</p> <h3 id="lfu-чоЧц│Хц╖Шц▒░цХ░цНо"><a href="#lfu-чоЧц│Хц╖Шц▒░цХ░цНо" class="header-anchor">#</a> LFU чоЧц│Хц╖Шц▒░цХ░цНо</h3> <p>хЬихоЮчО░ф╜┐чФи LFU чоЧц│Хц╖Шц▒░цХ░цНоцЧ╢я╝МRedis цШпщЗЗчФиф║ЖхТМхоЮчО░ш┐Сф╝╝ LRU чоЧц│ХчЫ╕хРМчЪДцЦ╣ц│ХуАВф╣Ях░▒цШпшп┤я╝МRedis ф╝Ъф╜┐чФиф╕Аф╕кхЕих▒АцХ░ч╗Д EvictionPoolLRUя╝МцЭеф┐ЭхнШх╛Ец╖Шц▒░хАЩщАЙщФохА╝хп╣щЫЖхРИуАВчД╢хРОя╝МхЬи processCommand хЗ╜цХ░хдДчРЖцпПф╕кхС╜ф╗дцЧ╢я╝МхоГф╝Ъш░ГчФи freeMemoryIfNeededAndSafe хЗ╜цХ░хТМ freeMemoryIfNeeded хЗ╜цХ░я╝МцЭецЙзшбМхЕ╖ф╜УчЪДцХ░цНоц╖Шц▒░ц╡БчиЛуАВ</p> <p>ш┐Щф╕кц╖Шц▒░ц╡БчиЛцИСхЬиф╕КчпЗцЦЗчлах╖▓ч╗Пч╗Щф╜аф╗Лч╗Нш┐Зф║Жя╝Мф╜ахПпф╗ехЖНхО╗цХ┤ф╜УхЫЮщб╛ф╕ЛуАВш┐ЩщЗМя╝МцИСф╣ЯхЖНчоАшжБцА╗ч╗Уф╕Ля╝Мф╣Ях░▒цШпхИЖцИРф╕Йф╕кцнещкдя╝Ъ</p> <ul><li>чммф╕Ацнея╝Мш░ГчФи getMaxmemoryState хЗ╜цХ░шобчоЧх╛ЕщЗКцФ╛чЪДхЖЕхнШчй║щЧ┤я╝Ы</li> <li>чммф║Мцнея╝Мш░ГчФи evictionPoolPopulate хЗ╜цХ░щЪПцЬ║щЗЗца╖щФохА╝хп╣я╝Мх╣╢цПТхЕехИ░х╛Ец╖Шц▒░щЫЖхРИ EvictionPoolLRU ф╕ня╝Ы</li> <li>чммф╕Йцнея╝МщБНхОЖх╛Ец╖Шц▒░щЫЖхРИ EvictionPoolLRUя╝МщАЙцЛйхоЮщЩЕшвлц╖Шц▒░цХ░цНоя╝Мх╣╢хИащЩдуАВ</li></ul> <p>шЩ╜чД╢ш┐Щф╕кхЯ║цЬмц╡БчиЛхТМ LRU чоЧц│ХчЫ╕хРМя╝Мф╜ЖцШпф╜ашжБц│ицДПя╝МLFU чоЧц│ХхЬиц╖Шц▒░цХ░цНоцЧ╢я╝МхЬичммф║МцнечЪД evictionPoolPopulate хЗ╜цХ░ф╕ня╝Мф╜┐чФиф║Жф╕НхРМчЪДцЦ╣ц│ХцЭешобчоЧцпПф╕кх╛Ец╖Шц▒░щФохА╝хп╣чЪДчй║щЧ▓цЧ╢щЧ┤</p> <p>хЕ╖ф╜УцЭешп┤я╝МхЬихоЮчО░ LRU чоЧц│ХцЧ╢я╝Мх╛Ец╖Шц▒░хАЩщАЙщФохА╝хп╣щЫЖхРИ EvictionPoolLRU ф╕нчЪДцпПф╕кхЕГч┤ая╝МщГ╜ф╜┐чФицИРхСШхПШщЗП idle цЭешо░х╜ХхоГш╖Эчж╗ф╕Кцмбшо┐щЧочЪДчй║щЧ▓цЧ╢щЧ┤уАВ</p> <p>шАМх╜УхоЮчО░ LFU чоЧц│ХцЧ╢я╝МхЫаф╕║ LFU чоЧц│Хф╝Ъхп╣шо┐щЧоцмбцХ░ш┐ЫшбМшб░хЗПхТМцМЙцжВчОЗхвЮхКая╝МцЙАф╗ея╝МхоГцШпф╜┐чФишо┐щЧоцмбцХ░цЭеш┐Сф╝╝шбичд║шо┐щЧощвСчОЗчЪДуАВчЫ╕х║ФчЪДя╝МLFU чоЧц│ХхЕ╢хоЮцШпчФи 255 хЗПхО╗щФохА╝хп╣чЪДшо┐щЧоцмбцХ░я╝Мш┐Щца╖цЭешобчоЧ EvictionPoolLRU цХ░ч╗Дф╕нцпПф╕кхЕГч┤ачЪД idle хПШщЗПхА╝чЪДуАВшАМф╕Фя╝МхЬишобчоЧ idle хПШщЗПхА╝хЙНя╝МLFU чоЧц│Хш┐Шф╝Ъш░ГчФи LFUDecrAndReturn хЗ╜цХ░я╝Мшб░хЗПф╕АцмбщФохА╝хп╣чЪДшо┐щЧоцмбцХ░я╝Мф╗еф╛┐шГ╜цЫ┤хКахЗЖчбохЬ░хПНцШахоЮщЩЕщАЙцЛйх╛Ец╖Шц▒░цХ░цНоцЧ╢я╝МцХ░цНочЪДшо┐щЧощвСчОЗуАВ</p> <p>ф╕ЛщЭвчЪДф╗гчаБх▒Хчд║ф║Ж LFU чоЧц│ХшобчоЧ idle хПШщЗПхА╝чЪДш┐ЗчиЛя╝Мф╜ахПпф╗ечЬЛф╕ЛуАВ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>server<span class="token punctuation">.</span>maxmemory_policy <span class="token operator">&amp;</span> MAXMEMORY_FLAG_LRU<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    idle <span class="token operator">=</span> <span class="token function">estimateObjectIdleTime</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>server<span class="token punctuation">.</span>maxmemory_policy <span class="token operator">&amp;</span> MAXMEMORY_FLAG_LFU<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    idle <span class="token operator">=</span> <span class="token number">255</span><span class="token operator">-</span><span class="token function">LFUDecrAndReturn</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>цЙАф╗ешп┤я╝Мх╜У LFU чоЧц│ХцМЙчЕзшо┐щЧощвСчОЗя╝МшобчоЧф║Жх╛Ец╖Шц▒░щФохА╝хп╣щЫЖхРИф╕нцпПф╕кхЕГч┤ачЪД idle хА╝хРОя╝МщФохА╝хп╣шо┐щЧоцмбцХ░ш╢Кхдзя╝МхоГчЪД idle хА╝х░▒ш╢Кх░Пя╝МхПНф╣Л idle хА╝ш╢КхдзуАВшАМ EvictionPoolLRU цХ░ч╗Дф╕нчЪДхЕГч┤ая╝МцШпцМЙ idle хА╝ф╗Ох░ПхИ░хдзцЭецОТх║ПчЪДуАВцЬАхРОх╜У freeMemoryIfNeeded хЗ╜цХ░цМЙчЕз idle хА╝ф╗ОхдзхИ░х░Пя╝МщБНхОЖ EvictionPoolLRU цХ░ч╗Дя╝МщАЙцЛйхоЮщЩЕшвлц╖Шц▒░чЪДщФохА╝хп╣цЧ╢я╝МхоГх░▒шГ╜щАЙхЗ║шо┐щЧоцмбцХ░х░ПчЪДщФохА╝хп╣ф║Жя╝Мф╣Ях░▒цШпцККшо┐щЧощвСчОЗф╜ОчЪДщФохА╝хп╣ц╖Шц▒░хЗ║хО╗уАВ</p> <p>ш┐Щца╖я╝МRedis х░▒хоМцИРф║ЖцМЙшо┐щЧощвСчОЗцЭец╖Шц▒░цХ░цНочЪДцУНф╜Ьф║ЖуАВ</p> <h2 id="цА╗ч╗У"><a href="#цА╗ч╗У" class="header-anchor">#</a> цА╗ч╗У</h2> <ol><li>LFU цШпхЬи Redis 4.0 цЦ░хвЮчЪДц╖Шц▒░чнЦчХея╝МхоГц╢ЙхПКчЪДх╖зхжЩф╣ЛхдДхЬиф║Оя╝МхЕ╢хдНчФиф║Ж redisObject ч╗УцЮДчЪД lru хнЧцо╡я╝МцККш┐Щф╕кхнЧцо╡уАМф╕АхИЖф╕║ф║МуАНя╝МщлШ 16 ф╜Нф┐ЭхнШцЬАхРОшо┐щЧоцЧ╢щЧ┤хТМф╜О 8 ф╜Нф┐ЭхнШшо┐щЧоцмбцХ░</li> <li>key чЪДшо┐щЧоцмбцХ░ф╕НшГ╜хПкхвЮф╕НхЗПя╝МхоГщЬАшжБца╣цНоцЧ╢щЧ┤щЧ┤щЪФцЭехБЪшб░хЗПя╝МцЙНшГ╜ш╛╛хИ░ LFU чЪДчЫочЪД</li> <li>цпПцмбхЬишо┐щЧоф╕Аф╕к key цЧ╢я╝Мф╝Ъ**уАМцЗТцГ░уАН**цЫ┤цЦ░ш┐Щф╕к key чЪДшо┐щЧоцмбцХ░я╝ЪхЕИшб░хЗПшо┐щЧоцмбцХ░я╝МхЖНцЫ┤цЦ░шо┐щЧоцмбцХ░</li> <li>шб░хЗПшо┐щЧоцмбцХ░я╝Мф╝Ъца╣цНоцЧ╢щЧ┤щЧ┤щЪФшобчоЧя╝МщЧ┤щЪФцЧ╢щЧ┤ш╢Кф╣Ея╝Мшб░хЗПш╢КхОЙхо│</li> <li>хЫаф╕║ redisObject lru хнЧцо╡хо╜х║жщЩРхИ╢я╝Мш┐Щф╕кшо┐щЧоцмбцХ░цШпцЬЙф╕КщЩРчЪДя╝И8 bit цЬАхдзхА╝ 255я╝Йя╝МцЙАф╗ещАТхвЮшо┐щЧоцмбцХ░цЧ╢я╝Мф╝Ъца╣цНоуАМх╜УхЙНуАНшо┐щЧоцмбцХ░хТМуАМцжВчОЗуАНчЪДцЦ╣х╝ПхБЪщАТхвЮя╝Мшо┐щЧоцмбцХ░ш╢Кхдзя╝МщАТхвЮхЫахнРш╢Кхдзя╝МщАТхвЮцжВчОЗш╢Кф╜О</li> <li>Redis хоЮчО░чЪД LFU чоЧц│Хф╣ЯцШп**уАМш┐Сф╝╝уАН**LFUя╝МцШпхЬицАзшГ╜хТМхЖЕхнШцЦ╣щЭвх╣│шббчЪДч╗УцЮЬ</li></ol> <h2 id="хПВшАГш╡ДцЦЩ"><a href="#хПВшАГш╡ДцЦЩ" class="header-anchor">#</a> хПВшАГш╡ДцЦЩ</h2> <ul><li><p><a href="https://time.geekbang.org/column/intro/100084301?utm_campaign=geektime_search&amp;utm_content=geektime_search&amp;utm_medium=geektime_search&amp;utm_source=geektime_search&amp;utm_term=geektime_search" target="_blank" rel="noopener noreferrer">цЮБховцЧ╢щЧ┤я╝ЪRedisц║РчаБхЙЦцЮРф╕ОхоЮцИШ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://book.douban.com/subject/25900156/" target="_blank" rel="noopener noreferrer">Redisшо╛шобф╕ОхоЮчО░ <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://github.com/redis/redis/blob/5.0/src/ae.c" target="_blank" rel="noopener noreferrer">Githubя╝Ъredis ц║РчаБ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/echo-lxy/echo-system-design/edit/master/docs/Redis ч│╗ч╗Яшо╛шоб/04.хЫЫуАБцФпч║┐ф╗╗хКб/10.LFU чнЦчХе.md" target="_blank" rel="noopener noreferrer">ч╝Цш╛С</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">ф╕КцмбцЫ┤цЦ░ф║О:</span> <span class="time">2024/09/18, 11:29:27</span></div></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><span class="prev">
        тЖР
        <a href="/echo-system-design/pages/b43a19/" class="prev">LRU чнЦчХе</a></span> <span class="next"><a href="/echo-system-design/pages/f44fbe/">Redis ш┐ЗцЬЯчнЦчХе</a>тЖТ
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:lixinyang2002@163.com" title="хПСщВоф╗╢" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/echo-lxy" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="хРмщЯ│ф╣Р" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="цЬмчлЩф╕╗щвШ">Vdoing</a> 
    | Copyright ┬й 2024-2024
    <span>Xinyang Li | MIT License</span></div> <div class="buttons"><div title="ш┐ФхЫЮщб╢щГи" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="хО╗шпДшо║" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ф╕╗щвШцибх╝П" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          ш╖ЯщЪПч│╗ч╗Я
        </li><li class="iconfont icon-rijianmoshi">
          ц╡ЕшЙ▓цибх╝П
        </li><li class="iconfont icon-yejianmoshi">
          ц╖▒шЙ▓цибх╝П
        </li><li class="iconfont icon-yuedu">
          щШЕшп╗цибх╝П
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/echo-system-design/assets/js/app.29ec2c17.js" defer></script><script src="/echo-system-design/assets/js/2.933750c6.js" defer></script><script src="/echo-system-design/assets/js/72.44c999da.js" defer></script><script src="/echo-system-design/assets/js/7.7eb70372.js" defer></script>
  </body>
</html>
