<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redis ф╕нчЪДх╗╢ш┐ЯчЫСцОз | EchoDesign</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="ч│╗ч╗Яшо╛шобф╣ЛуАМшо▓шзг + щЭвшпХцМЗхНЧуАНя╝Мц░┤ц╗┤чЯ│чй┐я╝Мшо╛шобцЧащУ╢х╝╣я╝Б">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.c76c3453.css" as="style"><link rel="preload" href="/assets/js/app.59640afe.js" as="script"><link rel="preload" href="/assets/js/2.933750c6.js" as="script"><link rel="preload" href="/assets/js/76.15d5bea9.js" as="script"><link rel="preload" href="/assets/js/7.7eb70372.js" as="script"><link rel="prefetch" href="/assets/js/10.2cc95be8.js"><link rel="prefetch" href="/assets/js/100.2b21dce5.js"><link rel="prefetch" href="/assets/js/101.96ca71f6.js"><link rel="prefetch" href="/assets/js/11.21625d3b.js"><link rel="prefetch" href="/assets/js/12.915fdd22.js"><link rel="prefetch" href="/assets/js/13.8ddd597e.js"><link rel="prefetch" href="/assets/js/14.1141ec27.js"><link rel="prefetch" href="/assets/js/15.d5a34c66.js"><link rel="prefetch" href="/assets/js/16.e52ba8b4.js"><link rel="prefetch" href="/assets/js/17.acb3bf3d.js"><link rel="prefetch" href="/assets/js/18.e491edb6.js"><link rel="prefetch" href="/assets/js/19.a22c1d8c.js"><link rel="prefetch" href="/assets/js/20.fe7d08c7.js"><link rel="prefetch" href="/assets/js/21.24c0f101.js"><link rel="prefetch" href="/assets/js/22.dd779f94.js"><link rel="prefetch" href="/assets/js/23.4d814163.js"><link rel="prefetch" href="/assets/js/24.891fe6fb.js"><link rel="prefetch" href="/assets/js/25.41dca26b.js"><link rel="prefetch" href="/assets/js/26.6337eac0.js"><link rel="prefetch" href="/assets/js/27.de80589e.js"><link rel="prefetch" href="/assets/js/28.6922a65b.js"><link rel="prefetch" href="/assets/js/29.7325b5ce.js"><link rel="prefetch" href="/assets/js/3.e62a71e4.js"><link rel="prefetch" href="/assets/js/30.e32f6b31.js"><link rel="prefetch" href="/assets/js/31.a532917f.js"><link rel="prefetch" href="/assets/js/32.13b70e91.js"><link rel="prefetch" href="/assets/js/33.d10d51bb.js"><link rel="prefetch" href="/assets/js/34.6671ead6.js"><link rel="prefetch" href="/assets/js/35.2760ed8d.js"><link rel="prefetch" href="/assets/js/36.5b9e5792.js"><link rel="prefetch" href="/assets/js/37.51145580.js"><link rel="prefetch" href="/assets/js/38.cddf1060.js"><link rel="prefetch" href="/assets/js/39.8a83e688.js"><link rel="prefetch" href="/assets/js/4.73518a0f.js"><link rel="prefetch" href="/assets/js/40.591baf2a.js"><link rel="prefetch" href="/assets/js/41.f961e422.js"><link rel="prefetch" href="/assets/js/42.b34f1599.js"><link rel="prefetch" href="/assets/js/43.5a509601.js"><link rel="prefetch" href="/assets/js/44.64fd3383.js"><link rel="prefetch" href="/assets/js/45.685623ac.js"><link rel="prefetch" href="/assets/js/46.7624d38c.js"><link rel="prefetch" href="/assets/js/47.5646b068.js"><link rel="prefetch" href="/assets/js/48.8de239a3.js"><link rel="prefetch" href="/assets/js/49.15d8e916.js"><link rel="prefetch" href="/assets/js/5.94727770.js"><link rel="prefetch" href="/assets/js/50.4fb0caa1.js"><link rel="prefetch" href="/assets/js/51.ef213b56.js"><link rel="prefetch" href="/assets/js/52.18c75eba.js"><link rel="prefetch" href="/assets/js/53.f76e624c.js"><link rel="prefetch" href="/assets/js/54.3098ec9f.js"><link rel="prefetch" href="/assets/js/55.0edcba5d.js"><link rel="prefetch" href="/assets/js/56.9df87e2e.js"><link rel="prefetch" href="/assets/js/57.be37bfce.js"><link rel="prefetch" href="/assets/js/58.ca1aa081.js"><link rel="prefetch" href="/assets/js/59.7b7e3faf.js"><link rel="prefetch" href="/assets/js/6.0b558b79.js"><link rel="prefetch" href="/assets/js/60.96815912.js"><link rel="prefetch" href="/assets/js/61.f48524d4.js"><link rel="prefetch" href="/assets/js/62.82fff0c9.js"><link rel="prefetch" href="/assets/js/63.41ff19e4.js"><link rel="prefetch" href="/assets/js/64.9b3def35.js"><link rel="prefetch" href="/assets/js/65.0b2ab47d.js"><link rel="prefetch" href="/assets/js/66.2ae7a107.js"><link rel="prefetch" href="/assets/js/67.196ec80b.js"><link rel="prefetch" href="/assets/js/68.cab1ea3b.js"><link rel="prefetch" href="/assets/js/69.5f61d937.js"><link rel="prefetch" href="/assets/js/70.7279b1df.js"><link rel="prefetch" href="/assets/js/71.4f744076.js"><link rel="prefetch" href="/assets/js/72.44c999da.js"><link rel="prefetch" href="/assets/js/73.526febf1.js"><link rel="prefetch" href="/assets/js/74.26f8d9a5.js"><link rel="prefetch" href="/assets/js/75.7c86d41a.js"><link rel="prefetch" href="/assets/js/77.7b3f6980.js"><link rel="prefetch" href="/assets/js/78.31a353ef.js"><link rel="prefetch" href="/assets/js/79.173bbc8c.js"><link rel="prefetch" href="/assets/js/8.7a3679f1.js"><link rel="prefetch" href="/assets/js/80.78a31e84.js"><link rel="prefetch" href="/assets/js/81.8d6c43d2.js"><link rel="prefetch" href="/assets/js/82.3b90a7cc.js"><link rel="prefetch" href="/assets/js/83.f3a9ee0c.js"><link rel="prefetch" href="/assets/js/84.eeb423e8.js"><link rel="prefetch" href="/assets/js/85.4cd3a775.js"><link rel="prefetch" href="/assets/js/86.931cbb70.js"><link rel="prefetch" href="/assets/js/87.47ba635a.js"><link rel="prefetch" href="/assets/js/88.93192130.js"><link rel="prefetch" href="/assets/js/89.b5690031.js"><link rel="prefetch" href="/assets/js/9.36f81190.js"><link rel="prefetch" href="/assets/js/90.cdc8eb8f.js"><link rel="prefetch" href="/assets/js/91.87a85466.js"><link rel="prefetch" href="/assets/js/92.6b777d4b.js"><link rel="prefetch" href="/assets/js/93.f8975bc4.js"><link rel="prefetch" href="/assets/js/94.1eade7f0.js"><link rel="prefetch" href="/assets/js/95.96f5db04.js"><link rel="prefetch" href="/assets/js/96.fc68b295.js"><link rel="prefetch" href="/assets/js/97.0a9a6187.js"><link rel="prefetch" href="/assets/js/98.10f4b27a.js"><link rel="prefetch" href="/assets/js/99.4a895015.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c76c3453.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="чЫох╜Х" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="EchoDesign" class="logo"> <span class="site-name can-hide">EchoDesign</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">ЁЯПащжЦщб╡</a></div><div class="nav-item"><a href="/pages/fccd91/" class="nav-link">тЬТя╕ПчГнщЧичоЧц│Х</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕шо╛шоб" class="dropdown-title"><!----> <span class="title" style="display:;">ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕шо╛шоб</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/252196/" class="nav-link">Redis ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/pages/b9733b/" class="nav-link">Kafka ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/pages/bfab10/" class="nav-link">Netty ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/pages/4601ca/" class="nav-link">Nginx ч│╗ч╗Яшо╛шоб</a></li></ul></div></div><div class="nav-item"><a href="/pages/84cb49/" class="nav-link">ЁЯзСтАНЁЯТ╗хоЮцИШч│╗ч╗Яшо╛шоб</a></div><div class="nav-item"><a href="/pages/92b2ee/" class="nav-link">тЭУщЧочнФ</a></div><div class="nav-item"><a href="/pages/52ebd8/" class="nav-link">ЁЯСАхКицАБ</a></div> <a href="https://github.com/echo-lxy/echo-system-design" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">ЁЯПащжЦщб╡</a></div><div class="nav-item"><a href="/pages/fccd91/" class="nav-link">тЬТя╕ПчГнщЧичоЧц│Х</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕шо╛шоб" class="dropdown-title"><!----> <span class="title" style="display:;">ЁЯОЦя╕Пш╡ПцЮРч╗ПхЕ╕шо╛шоб</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/252196/" class="nav-link">Redis ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/pages/b9733b/" class="nav-link">Kafka ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/pages/bfab10/" class="nav-link">Netty ч│╗ч╗Яшо╛шоб</a></li><li class="dropdown-item"><!----> <a href="/pages/4601ca/" class="nav-link">Nginx ч│╗ч╗Яшо╛шоб</a></li></ul></div></div><div class="nav-item"><a href="/pages/84cb49/" class="nav-link">ЁЯзСтАНЁЯТ╗хоЮцИШч│╗ч╗Яшо╛шоб</a></div><div class="nav-item"><a href="/pages/92b2ee/" class="nav-link">тЭУщЧочнФ</a></div><div class="nav-item"><a href="/pages/52ebd8/" class="nav-link">ЁЯСАхКицАБ</a></div> <a href="https://github.com/echo-lxy/echo-system-design" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ф╕АуАБхЙНшиА</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ф║МуАБхЯ║чбАчЯешпЖ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ф╕ЙуАБф╕╗ч║┐ф╗╗хКб</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>хЫЫуАБцФпч║┐ф╗╗хКб</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/b43a19/" class="sidebar-link">LRU чнЦчХе</a></li><li><a href="/pages/b43a89/" class="sidebar-link">LFU чнЦчХе</a></li><li><a href="/pages/f44fbe/" class="sidebar-link">Redis ш┐ЗцЬЯчнЦчХе</a></li><li><a href="/pages/9b17a6/" class="sidebar-link">RDB цМБф╣ЕхМЦ</a></li><li><a href="/pages/9b17a7/" class="sidebar-link">AOF цМБф╣ЕхМЦ</a></li><li><a href="/pages/aa75e9/" aria-current="page" class="active sidebar-link">Redis ф╕нчЪДх╗╢ш┐ЯчЫСцОз</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/aa75e9/#хЙНшиА" class="sidebar-link">хЙНшиА</a></li><li class="sidebar-sub-header level2"><a href="/pages/aa75e9/#х╗╢ш┐ЯчЫСцОзцбЖцЮ╢чЪДхоЮчО░" class="sidebar-link">х╗╢ш┐ЯчЫСцОзцбЖцЮ╢чЪДхоЮчО░</a></li><li class="sidebar-sub-header level2"><a href="/pages/aa75e9/#цЕвхС╜ф╗дцЧех┐ЧчЪДхоЮчО░" class="sidebar-link">цЕвхС╜ф╗дцЧех┐ЧчЪДхоЮчО░</a></li><li class="sidebar-sub-header level2"><a href="/pages/aa75e9/#цА╗ч╗У" class="sidebar-link">цА╗ч╗У</a></li><li class="sidebar-sub-header level2"><a href="/pages/aa75e9/#хПВшАГш╡ДцЦЩ" class="sidebar-link">хПВшАГш╡ДцЦЩ</a></li></ul></li><li><a href="/pages/61d908/" class="sidebar-link">хПСх╕Гф╕ОшовщШЕ</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ф║ФуАБщЫЖч╛д</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="щжЦщб╡" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>Redis ч│╗ч╗Яшо╛шоб</span></li><li data-v-06225672><span data-v-06225672>хЫЫуАБцФпч║┐ф╗╗хКб</span></li></ul> <div class="info" data-v-06225672><div title="ф╜ЬшАЕ" class="author iconfont icon-touxiang" data-v-06225672><a href="https://gitee.com/brother-one" target="_blank" title="ф╜ЬшАЕ" class="beLink" data-v-06225672>echo</a></div> <div title="хИЫх╗║цЧ╢щЧ┤" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-09-15</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">чЫох╜Х</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">Redis ф╕нчЪДх╗╢ш┐ЯчЫСцОз<!----></h1> <div class="page-slot page-slot-top">
    <div class="wwads-cn wwads-horizontal page-wwads" data-id="136"></div>
    <style>
      .page-wwads{
        width:100%!important;
        min-height: 0;
        margin: 0;
      }
      .page-wwads .wwads-img img{
        width:80px!important;
      }
      .page-wwads .wwads-poweredby{
        width: 40px;
        position: absolute;
        right: 25px;
        bottom: 3px;
      }
      .wwads-content .wwads-text, .page-wwads .wwads-text{
        height: 100%;
        padding-top: 5px;
        display: block;
      }
  </style>
  </div> <div class="theme-vdoing-content content__default"><div class="custom-block note"><p class="custom-block-title">цПРхЗ║щЧощвШцШпф╕АхИЗцЩ║цЕзчЪДх╝Ачлп</p> <ol><li>Redis цШпф╗еф╜Ох╗╢ш┐ЯшСЧчз░чЪДцХ░цНох║Уя╝МщВгф╣Их╜УхоГчЪДхУНх║ФщАЯх║жхПШцЕвцЧ╢я╝МхжВф╜Хх┐лщАЯшпКцЦнхЗ║щЧощвШцЙАхЬия╝Я</li> <li>ф╜ачЯещБУ Redis чЪДхУкф║Ыф║Лф╗╢хПпшГ╜хп╝шЗ┤хоГш┐РшбМч╝УцЕвхРЧя╝ЯхоГф╗мцШпхжВф╜ХшвлчЫСцОзчЪДя╝Я</li> <li>х╜У Redis чЪДцЯРф╕кхС╜ф╗дцЙзшбМхПШцЕвцЧ╢я╝МцИСф╗мхжВф╜ХцНХцНЙш┐Щф║ЫтАЬцЕвхС╜ф╗дтАЭх╣╢ш┐ЫшбМшпжч╗ЖхИЖцЮРя╝Я</li> <li>хЬи Redis х╗╢ш┐ЯчЫСцОзф╕ня╝МхжВф╜ХщАЪш┐ЗщЗЗца╖цЬ║хИ╢щлШцХИшо░х╜ХцпПч▒╗ф║Лф╗╢чЪДцЙзшбМцЧ╢щХ┐я╝Я</li> <li>ф╕║ф╗Аф╣И Redis щЬАшжБф╕║х╗╢ш┐Яф║Лф╗╢хТМцЕвхС╜ф╗дхИЖхИлшо╛шобф╕НхРМчЪДчЫСцОзхТМцЧех┐ЧцЬ║хИ╢я╝Яш┐Щф╕дшАЕчЪДца╕х┐ГхМ║хИлцШпф╗Аф╣Ия╝Я</li> <li>Redis хжВф╜ХщАЪш┐ЗтАЬцЧ╢щЧ┤х║ПхИЧтАЭчЪДцЦ╣х╝Пф┐ЭхнШхТМхИЖцЮРхдЪцмбх╗╢ш┐Яф║Лф╗╢чЪДцХ░цНоя╝Мф╗еф╛┐ф╕║хРОч╗нщЧощвШцОТцЯецПРф╛ЫцЫ┤хдЪч║┐ч┤вя╝Я</li> <li>хЬих╗╢ш┐ЯчЫСцОзф╕ня╝МRedis цШпхжВф╜ХщАЪш┐Зч╗Яшобх╗╢ш┐Яф║Лф╗╢чЪДцЬАхдзхА╝уАБцЬАх░ПхА╝уАБхЭЗхА╝чнЙцХ░цНоцЭех╕охКйчФицИ╖шпКцЦнщЧощвШчЪДя╝Я</li> <li>Redis чЪДцЕвхС╜ф╗дцЧех┐ЧшГ╜цПРф╛ЫхУкф║ЫхЕ│щФоф┐бцБпя╝ЯхжВф╜ХщАЪш┐Зш┐Щф║Ыф┐бцБпхоЪф╜НхИ░хЕ╖ф╜УчЪДцЕвхС╜ф╗дхТМхоГчЪДцЭец║Ря╝Я</li></ol></div> <h2 id="хЙНшиА"><a href="#хЙНшиА" class="header-anchor">#</a> хЙНшиА</h2> <p>RedisчЪДф╕Аф╕кцШ╛шСЧчЙ╣х╛Бх░▒цШп<strong>шГ╜цПРф╛Ыф╜Ох╗╢ш┐ЯчЪДцХ░цНошо┐щЧо</strong>уАВшАМхжВцЮЬRedisхЬиш┐РшбМш┐ЗчиЛф╕нхПШцЕвф║Жя╝МцИСф╗мх░▒щЬАшжБцЬЙцЦ╣ц│ХшГ╜чЫСцОзхИ░хУкф║ЫхС╜ф╗дцЙзшбМхПШцЕвф║ЖуАВцЫ┤ш┐Ыф╕АцнечЪДщЬАц▒Вя╝Мх░▒цШпцИСф╗мщЬАшжБцЬЙцЦ╣ц│ХчЫСцОзхИ░я╝МцШпRedisш┐РшбМш┐ЗчиЛф╕нчЪДхУкф║Ыф║Лф╗╢хп╝шЗ┤RedisхПШцЕвф║ЖуАВш┐Щца╖ф╕АцЭея╝МцИСф╗мх░▒цЧвхПпф╗ецгАцЯеш┐Щф║ЫцЕвхС╜ф╗дя╝МхИЖцЮРхоГф╗мчЪДцУНф╜Ьч▒╗хЮЛхТМшо┐щЧочЪДцХ░цНощЗПя╝Мш┐ЫшАМцПРхЗ║х║Фхп╣цЦ╣ц│Хя╝Мф╣ЯхПпф╗ецгАцЯечЫСцОзшо░х╜ХчЪДф║Лф╗╢я╝МхИЖцЮРф║Лф╗╢хПСчФЯчЪДхОЯхЫах╣╢цПРхЗ║х║Фхп╣цЦ╣ц│Х</p> <p>щВгф╣Ия╝Мф╕║ф║Жц╗бш╢│ш┐Щф║ЫщЬАц▒Вя╝МцИСф╗мх░▒щЬАшжБцЬЙф╕АхеЧчЫСцОзцбЖцЮ╢</p> <ul><li>ф╕АцЦ╣щЭвшГ╜чЫСц╡Лхп╝шЗ┤RedisхПШцЕвчЪДф║Лф╗╢</li> <li>хПжф╕АцЦ╣щЭвя╝МшГ╜чЫСцОзх╣╢шо░х╜ХхПШцЕвчЪДхС╜ф╗дуАВ</li></ul> <p>хЕ╢хоЮя╝Мш┐Щф╣ЯцШпцИСф╗мхЬих╝АхПСхРОчлпч│╗ч╗ЯцЧ╢я╝Мч╗Пх╕╕ф╝ЪщЭвф╕┤чЪДф╕Аф╕кш┐Рч╗┤х╝АхПСщЬАц▒Вя╝Мф╣Ях░▒цШп<strong>хжВф╜ХчЫСцОзхРОчлпч│╗ч╗ЯчЪДш┐РшбМчК╢цАБ</strong>уАВ</p> <p>echo цЭех╕жф╜аф║ЖшзгRedisчЪДх╗╢ш┐ЯчЫСцОзцбЖцЮ╢хТМцЕвхС╜ф╗дцЧех┐ЧчЪДшо╛шобф╕ОхоЮчО░уАВ</p> <h2 id="х╗╢ш┐ЯчЫСцОзцбЖцЮ╢чЪДхоЮчО░"><a href="#х╗╢ш┐ЯчЫСцОзцбЖцЮ╢чЪДхоЮчО░" class="header-anchor">#</a> х╗╢ш┐ЯчЫСцОзцбЖцЮ╢чЪДхоЮчО░</h2> <p>хоЮщЩЕф╕Кя╝МRedis хЬиш┐РшбМш┐ЗчиЛф╕ня╝Мф╗еф╕Лшбица╝ф╕нч╗ЩхЗ║чЪДхЗач▒╗ф║Лф╗╢щГ╜ф╝Ъхп╝шЗ┤ Redis хПШцЕвя╝МцИСф╗мщАЪх╕╕ф╣ЯцККш┐Щф║Ыф║Лф╗╢чз░ф╕║<strong>х╗╢ш┐Яф║Лф╗╢</strong>уАВф╜ахПпф╗ехПВшАГшбица╝ф╕нчЪДш┐Щф║Ыф║Лф╗╢ч▒╗хЮЛя╝Мф╗ехПКхоГф╗мхЬиц║РчаБф╕нхп╣х║ФчЪДф║Лф╗╢хРНчз░уАВ</p> <table><thead><tr><th>ф║Лф╗╢ч▒╗хЮЛ</th> <th>ц║РчаБф╕нхп╣х║ФхРНчз░</th></tr></thead> <tbody><tr><td>хС╜ф╗дф║Лф╗╢</td> <td>commandуАБfast-command</td></tr> <tr><td>AOFф║Лф╗╢</td> <td>aof-write-pending-fsync, aof-write-active-child, aof-write-alone, aof-fstat, aof-rewrite-diff-write, aof-rename</td></tr> <tr><td>forkф║Лф╗╢</td> <td>fork</td></tr> <tr><td>ш┐ЗцЬЯKeyф║Лф╗╢</td> <td>expire-cycie</td></tr> <tr><td>ч╝УхнШцЫ┐цНвф║Лф╗╢</td> <td>eviction-del, eviction-cycie</td></tr></tbody></table> <p>щВгф╣ИщТИхп╣ш┐Щф║Ыф║Лф╗╢я╝МRedisхоЮчО░ф║Жх╗╢ш┐ЯчЫСцОзцбЖцЮ╢я╝МщАЪш┐ЗщЗЗца╖чЪДцЦ╣х╝ПцЭешо░х╜ХхоГф╗мчЪДцЙзшбМцГЕхЖ╡уАВх╜УщЬАшжБцОТцЯещЧощвШцЧ╢я╝Мх╗╢ш┐ЯчЫСцОзцбЖцЮ╢цПРф╛Ыф║Ж<strong>latency historyхС╜ф╗д</strong>я╝Мф╗еф╛┐ш┐Рч╗┤ф║║хСШцгАцЯеш┐Щф║Ыф║Лф╗╢уАВ</p> <p>ф╕ЛщЭвя╝МцИСф╗мх░▒цЭечЬЛф╕Лшо░х╜Хф║Лф╗╢цЙзшбМцГЕхЖ╡чЪДцХ░цНоч╗УцЮДуАВхЫаф╕║х╗╢ш┐ЯчЫСцОзцбЖцЮ╢цШпхЬи<a href="https://github.com/redis/redis/tree/5.0/src/latency.h" target="_blank" rel="noopener noreferrer">latency.h<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>хТМ<a href="https://github.com/redis/redis/tree/5.0/src/latency.c" target="_blank" rel="noopener noreferrer">latency.c<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>цЦЗф╗╢ф╕нхоЮчО░чЪДя╝Мф╜аф╣ЯхПпф╗ехЬиш┐Щф╕дф╕кцЦЗф╗╢ф╕нцЙ╛хИ░чЫ╕х║ФчЪДцХ░цНоч╗УцЮДхТМхЗ╜цХ░уАВ</p> <h3 id="шо░х╜Хф║Лф╗╢цЙзшбМцГЕхЖ╡чЪДцХ░цНоч╗УцЮД"><a href="#шо░х╜Хф║Лф╗╢цЙзшбМцГЕхЖ╡чЪДцХ░цНоч╗УцЮД" class="header-anchor">#</a> шо░х╜Хф║Лф╗╢цЙзшбМцГЕхЖ╡чЪДцХ░цНоч╗УцЮД</h3> <p>щжЦхЕИя╝МRedisцШпф╜┐чФиф║Ж<strong>latencySampleч╗УцЮДф╜У</strong>я╝МцЭешо░х╜Хх╗╢ш┐Яф║Лф╗╢чЪДщЗЗца╖цЧ╢щЧ┤хТМф║Лф╗╢чЪДхоЮщЩЕцЙзшбМцЧ╢щХ┐я╝Мш┐Щф╕кч╗УцЮДф╜УчЪДф╗гчаБхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">latencySample</span> <span class="token punctuation">{</span>
    <span class="token class-name">int32_t</span> time<span class="token punctuation">;</span>  <span class="token comment">//ф║Лф╗╢чЪДщЗЗца╖цЧ╢щЧ┤</span>
    <span class="token class-name">uint32_t</span> latency<span class="token punctuation">;</span>  <span class="token comment">//ф║Лф╗╢чЪДцЙзшбМцЧ╢щХ┐я╝Иф╗ецплчзТф╕║хНХф╜Ня╝Й</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>шАМхЬиlatencySampleш┐Щф╕кч╗УцЮДф╜УхЯ║чбАф╕Кя╝МRedisхПИшо╛шобф║Ж<strong>latencyTimeSeriesч╗УцЮДф╜У</strong>я╝Мш┐Щф╕кч╗УцЮДф╜Уф╜┐чФиф║Жф╕Аф╕кlatencySampleч▒╗хЮЛчЪДцХ░ч╗Дя╝Мшо░х╜Хф║ЖщТИхп╣цЯРф╕Ач▒╗ф║Лф╗╢чЪДф╕Ач│╗хИЧщЗЗца╖ч╗УцЮЬя╝Мш┐Щца╖х░▒хПпф╗еф╕║хИЖцЮРRedisхПШцЕвцПРф╛ЫцЫ┤хдЪчЪДф║Лф╗╢ф┐бцБпуАВ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">latencyTimeSeries</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> idx<span class="token punctuation">;</span>  <span class="token comment">//щЗЗца╖ф║Лф╗╢цХ░ч╗ДчЪДхЖЩхЕеф╜Нч╜о</span>
    <span class="token class-name">uint32_t</span> max<span class="token punctuation">;</span>  <span class="token comment">//х╜УхЙНф║Лф╗╢чЪДцЬАхдзх╗╢ш┐Я</span>
    <span class="token keyword">struct</span> <span class="token class-name">latencySample</span> samples<span class="token punctuation">[</span>LATENCY_TS_LEN<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//щЗЗца╖ф║Лф╗╢цХ░ч╗Дя╝Мшо░х╜ХLATENCY_TS_LENф╕кщЗЗца╖ч╗УцЮЬя╝МLATENCY_TS_LENщ╗Шшодф╕║160</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>хПжхдЦя╝Мф╣ЯхЫаф╕║х╗╢ш┐ЯчЫСцОзцбЖцЮ╢шжБшо░х╜ХчЪДх╗╢ш┐Яф║Лф╗╢цЬЙх╛ИхдЪчзНя╝МцЙАф╗е Redis ш┐Шш┐Ыф╕Ацнешо╛шобф║Жф╕Аф╕к<strong>хУИх╕Мшбиlatency_events</strong>я╝Мф╜Ьф╕║хЕих▒АхПШщЗПserverчЪДф╕Аф╕кцИРхСШхПШщЗПя╝МчФицЭешо░х╜Хф╕НхРМф║Лф╗╢чЪДщЗЗца╖ч╗УцЮЬцХ░ч╗Дя╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">redisServer</span> <span class="token punctuation">{</span>
   тАж
   dict <span class="token operator">*</span>latency_events<span class="token punctuation">;</span>
   тАж
<span class="token punctuation">}</span>
</code></pre></div><p>ш┐Щф╕кхУИх╕МшбицШпхЬиRedis serverхРпхКихИЭхзЛхМЦчЪДхЗ╜цХ░initServerф╕ня╝МщАЪш┐Зш░ГчФиlatencyMonitorInitхЗ╜цХ░цЭехоМцИРхИЫх╗║чЪДя╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">initServer</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    тАж
    <span class="token function">latencyMonitorInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">void</span> <span class="token function">latencyMonitorInit</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    server<span class="token punctuation">.</span>latency_events <span class="token operator">=</span> <span class="token function">dictCreate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>latencyTimeSeriesDictType<span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>хе╜я╝Мф║Жшзгф║Жшо░х╜Хх╗╢ш┐Яф║Лф╗╢чЪДцХ░цНоч╗УцЮДхТМхИЭхзЛхМЦцУНф╜ЬхРОя╝МцИСф╗мхЖНцЭечЬЛф╕Лф║Лф╗╢щЗЗца╖цШпхжВф╜ХхоЮчО░чЪДуАВ</p> <h3 id="хжВф╜ХхоЮчО░х╗╢ш┐Яф║Лф╗╢чЪДщЗЗца╖"><a href="#хжВф╜ХхоЮчО░х╗╢ш┐Яф║Лф╗╢чЪДщЗЗца╖" class="header-anchor">#</a> хжВф╜ХхоЮчО░х╗╢ш┐Яф║Лф╗╢чЪДщЗЗца╖я╝Я</h3> <p>х╗╢ш┐Яф║Лф╗╢чЪД<strong>щЗЗца╖хЗ╜цХ░цШпlatencyAddSample</strong>я╝МхоГчЪДхЗ╜цХ░хОЯхЮЛхжВф╕ЛцЙАчд║уАВхоГчЪДхПВцХ░ф╕нхМЕхРлф║ЖшжБшо░х╜ХчЪДф║Лф╗╢хРНчз░я╝Мш┐ЩхоЮщЩЕцШпхп╣х║Фф║Жlatency_eventsхУИх╕Мшбиф╕нчЪДф╕Аф╕кхУИх╕Мщб╣уАВцндхдЦя╝МхоГчЪДхПВцХ░ф╕нш┐ШхМЕцЛмшпеф║Лф╗╢чЪДцЙзшбМцЧ╢щХ┐уАВ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">latencyAddSample</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>event<span class="token punctuation">,</span> <span class="token class-name">mstime_t</span> latency<span class="token punctuation">)</span>
</code></pre></div><p>latencyAddSampleхЗ╜цХ░чЪДцЙзшбМщА╗ш╛Сх╣╢ф╕НхдНцЭВя╝Мф╕╗шжБхПпф╗ехИЖцИРф╕ЙцнеуАВ</p> <p><strong>щжЦхЕИ</strong>я╝МхоГф╝Ъца╣цНоф╝ахЕечЪДф║Лф╗╢хРНчз░я╝МхЬиlatency_eventsхУИх╕Мшбиф╕нцЯецЙ╛шпеф║Лф╗╢уАВхжВцЮЬшпеф║Лф╗╢хп╣х║ФчЪДхУИх╕Мщб╣ш┐Шф╕НхнШхЬия╝МхоГх░▒ф╝ЪхЬихУИх╕Мшбиф╕нхКахЕешпеф║Лф╗╢я╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//цЯецЙ╛ф║Лф╗╢хп╣х║ФчЪДхУИх╕Мщб╣</span>
<span class="token keyword">struct</span> <span class="token class-name">latencyTimeSeries</span> <span class="token operator">*</span>ts <span class="token operator">=</span> <span class="token function">dictFetchValue</span><span class="token punctuation">(</span>server<span class="token punctuation">.</span>latency_events<span class="token punctuation">,</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
тАж
<span class="token keyword">if</span> <span class="token punctuation">(</span>ts <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//хжВцЮЬхУИх╕Мщб╣ф╕║чй║я╝Мх░▒цЦ░х╗║хУИх╕Мщб╣</span>
    ts <span class="token operator">=</span> <span class="token function">zmalloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>ts<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ts<span class="token operator">-&gt;</span>idx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    ts<span class="token operator">-&gt;</span>max <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>ts<span class="token operator">-&gt;</span>samples<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>ts<span class="token operator">-&gt;</span>samples<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">dictAdd</span><span class="token punctuation">(</span>server<span class="token punctuation">.</span>latency_events<span class="token punctuation">,</span><span class="token function">zstrdup</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">,</span>ts<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//хЬихУИх╕Мшбиф╕нцПТхЕехУИх╕Мщб╣</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>чД╢хРО</strong>я╝МlatencyAddSampleхЗ╜цХ░ф╝Ъца╣цНоф╝ахЕечЪДф║Лф╗╢цЙзшбМцЧ╢щЧ┤я╝МцЫ┤цЦ░х╜УхЙНшо░х╜ХчЪДшпеч▒╗ф║Лф╗╢чЪДцЬАхдзцЙзшбМцЧ╢щЧ┤я╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>latency <span class="token operator">&gt;</span> ts<span class="token operator">-&gt;</span>max<span class="token punctuation">)</span> ts<span class="token operator">-&gt;</span>max <span class="token operator">=</span> latency<span class="token punctuation">;</span>
</code></pre></div><p><strong>цЬАхРО</strong>я╝МlatencyAddSampleхЗ╜цХ░ф╝ЪхоЮщЩЕшо░х╜Хх╜УхЙНчЪДщЗЗца╖ч╗УцЮЬуАВ</p> <p>ф╕Нш┐ЗхЬиш┐Щф╕Ацнея╝МхжВцЮЬхоГхПСчО░х╜УхЙНчЪДщЗЗца╖ч╗УцЮЬя╝МхТМхЙНф╕Аф╕кщЗЗца╖ч╗УцЮЬцШпхЬихРМф╕АчзТф╕ншО╖х╛ЧчЪДя╝Мх╣╢ф╕ФхжВцЮЬх╜УхЙНщЗЗца╖ч╗УцЮЬчЪДф║Лф╗╢цЙзшбМцЧ╢щХ┐я╝Мхдзф║ОхЙНф╕Аф╕кщЗЗца╖ч╗УцЮЬчЪДшпЭя╝МщВгф╣ИlatencyAddSampleхЗ╜цХ░х░▒ф╝ЪчЫ┤цОецЫ┤цЦ░хЙНф╕Аф╕кщЗЗца╖ч╗УцЮЬф╕ншо░х╜ХчЪДцЙзшбМцЧ╢щХ┐ф║Жя╝МшАМф╕НцШпцЦ░цПТхЕеф╕Аф╕кщЗЗца╖ч╗УцЮЬуАВ</p> <p>хРжхИЩчЪДшпЭя╝МlatencyAddSampleхЗ╜цХ░цЙНф╝ЪцЦ░цПТхЕеф╕Аф╕кщЗЗца╖ч╗УцЮЬуАВш┐Щца╖шо╛шобчЪДчЫочЪДя╝Мф╣ЯцШпф╕║ф║ЖщБ┐хЕНхЬихРМф╕АчзТф╕ншо░х╜Хш┐ЗхдЪчЪДщЗЗца╖ч╗УцЮЬуАВ</p> <p>ф╕ЛщЭвчЪДф╗гчаБх▒Хчд║ф║ЖlatencyAddSampleхЗ╜цХ░хоЮщЩЕшо░х╜ХщЗЗца╖ч╗УцЮЬчЪДщА╗ш╛Ся╝Мф╜ахПпф╗ечЬЛф╕ЛуАВ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//шО╖х╛ЧхРМч▒╗ф║Лф╗╢чЪДхЙНф╕Аф╕кщЗЗца╖ч╗УцЮЬ</span>
prev <span class="token operator">=</span> <span class="token punctuation">(</span>ts<span class="token operator">-&gt;</span>idx <span class="token operator">+</span> LATENCY_TS_LEN <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> LATENCY_TS_LEN<span class="token punctuation">;</span>
<span class="token comment">//хжВцЮЬх╜УхЙНхТМхЙНф╕Аф╕кщЗЗца╖ч╗УцЮЬхЬихРМф╕АчзТф╕н</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>ts<span class="token operator">-&gt;</span>samples<span class="token punctuation">[</span>prev<span class="token punctuation">]</span><span class="token punctuation">.</span>time <span class="token operator">==</span> now<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token comment">//хжВцЮЬх╜УхЙНщЗЗчФич╗УцЮЬчЪДцЙзшбМцЧ╢щХ┐хдзф║ОхЙНф╕Аф╕кщЗЗца╖ч╗УцЮЬ</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>latency <span class="token operator">&gt;</span> ts<span class="token operator">-&gt;</span>samples<span class="token punctuation">[</span>prev<span class="token punctuation">]</span><span class="token punctuation">.</span>latency<span class="token punctuation">)</span> 
        <span class="token comment">//чЫ┤цОецЫ┤цЦ░хЙНф╕Аф╕кщЗЗца╖ч╗УцЮЬчЪДцЙзшбМцЧ╢щХ┐</span>
        ts<span class="token operator">-&gt;</span>samples<span class="token punctuation">[</span>prev<span class="token punctuation">]</span><span class="token punctuation">.</span>latency <span class="token operator">=</span> latency<span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//хРжхИЩя╝МцЦ░цПТхЕех╜УхЙНчЪДщЗЗца╖ч╗УцЮЬ</span>
ts<span class="token operator">-&gt;</span>samples<span class="token punctuation">[</span>ts<span class="token operator">-&gt;</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>time <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ts<span class="token operator">-&gt;</span>samples<span class="token punctuation">[</span>ts<span class="token operator">-&gt;</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>latency <span class="token operator">=</span> latency<span class="token punctuation">;</span>
</code></pre></div><p>шАМхЬиш┐ЩщЗМя╝Мф╜аф╣ЯшжБц│ицДПф╕АчВ╣я╝Мх░▒цШпlatencyAddSampleхЗ╜цХ░хЬишо░х╜ХщЗЗца╖ч╗УцЮЬцЧ╢я╝М<strong>ф╝ЪщЗНхдНф╜┐чФищЗЗца╖ч╗УцЮЬцХ░ч╗ДlatencyTimeSeries</strong>уАВцЙАф╗ея╝МхжВцЮЬщЗЗца╖ч╗УцЮЬцХ░щЗПш╢Еш┐ЗцХ░ч╗Дщ╗Шшодхдзх░ПцЧ╢я╝МцЧзчЪДщЗЗца╖ч╗УцЮЬцШпф╝ЪшвлшжЖчЫЦцОЙчЪДуАВхжВцЮЬф╜ашжБшо░х╜ХцЫ┤хдЪчЪДщЗЗца╖ч╗УцЮЬя╝Мх░▒щЬАшжБцЙйхдзlatencyTimeSeriesцХ░ч╗ДчЪДщХ┐х║жуАВ</p> <p>щВгф╣Ия╝МlatencyAddSampleхЗ╜цХ░цШпхЬиф╗Аф╣ИцЧ╢хАЩш░ГчФиш┐ЫшбМщЗЗца╖чЪДхСв?</p> <p>хЕ╢хоЮя╝МlatencyAddSampleхЗ╜цХ░цШпшвлх░БшгЕхЬиф║Ж<strong>latencyAddSampleIfNeededхЗ╜цХ░</strong>ф╕нуАВхЬиlatencyAddSampleIfNeededхЗ╜цХ░ф╕ня╝МхоГхПкф╝ЪхЬиф║Лф╗╢цЙзшбМцЧ╢щХ┐ш╢Еш┐Зlatency-monitor-thresholdщЕНч╜ощб╣чЪДхА╝цЧ╢я╝МцЙНш░ГчФиlatencyAddSampleхЗ╜цХ░шо░х╜ХщЗЗца╖ч╗УцЮЬуАВф╜ахПпф╗ечЬЛчЬЛф╕ЛщЭвч╗ЩхЗ║чЪДlatencyAddSampleIfNeededхЗ╜цХ░хоЪф╣ЙуАВ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token function">latencyAddSampleIfNeeded</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span>var<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>server<span class="token punctuation">.</span>latency_monitor_threshold <span class="token operator">&amp;&amp;</span>  <span class="token punctuation">(</span>var<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> server<span class="token punctuation">.</span>latency_monitor_threshold<span class="token punctuation">)</span>
          <span class="token function">latencyAddSample</span><span class="token punctuation">(</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>var<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
    
</code></pre></div><p>шАМlatencyAddSampleIfNeededхЗ╜цХ░я╝МхоЮщЩЕф╕Кф╝ЪхЬихИЪцЙНф╗Лч╗НчЪДх╗╢ш┐Яф║Лф╗╢хПСчФЯцЧ╢швлш░ГчФиуАВш┐ЩщЗМцИСцЭеч╗Щф╜аф╕╛ф╕дф╕кф╛ЛхнРуАВ</p> <p>цпФхжВя╝Мх╜УRedisхС╜ф╗дщАЪш┐ЗcallхЗ╜цХ░я╝ИхЬиserver.cцЦЗф╗╢ф╕ня╝ЙцЙзшбМцЧ╢я╝МcallхЗ╜цХ░х░▒ф╝Ъш░ГчФиlatencyAddSampleIfNeededхЗ╜цХ░ш┐ЫшбМщЗЗца╖я╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>flags <span class="token operator">&amp;</span> CMD_CALL_SLOWLOG <span class="token operator">&amp;&amp;</span> c<span class="token operator">-&gt;</span>cmd<span class="token operator">-&gt;</span>proc <span class="token operator">!=</span> execCommand<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//ца╣цНохС╜ф╗дцХ░цНоч╗УцЮДф╕нflagsчЪДCMD_FASTцаЗшо░я╝МхЖ│хоЪх╜УхЙНцШпfast-commandф║Лф╗╢ш┐ШцШпcommandф║Лф╗╢</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>latency_event <span class="token operator">=</span> <span class="token punctuation">(</span>c<span class="token operator">-&gt;</span>cmd<span class="token operator">-&gt;</span>flags <span class="token operator">&amp;</span> CMD_FAST<span class="token punctuation">)</span> <span class="token operator">?</span>
        <span class="token string">&quot;fast-command&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;command&quot;</span><span class="token punctuation">;</span>
    <span class="token function">latencyAddSampleIfNeeded</span><span class="token punctuation">(</span>latency_event<span class="token punctuation">,</span>duration<span class="token operator">/</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    тАж
<span class="token punctuation">}</span>
</code></pre></div><p>хЖНцпФхжВя╝Мх╜УRedisш░ГчФиflushAppendOnlyFileхЗ╜цХ░хЖЩAOFцЦЗф╗╢цЧ╢я╝МхжВцЮЬAOFцЦЗф╗╢хИ╖чЫШчЪДщЕНч╜ощб╣цШпAOF_FSYNC_ALWAYSя╝МщВгф╣ИflushAppendOnlyFileхЗ╜цХ░х░▒ф╝Ъш░ГчФиlatencyAddSampleIfNeededхЗ╜цХ░я╝Мшо░х╜Хaof-fsync-alwaysх╗╢ш┐Яф║Лф╗╢чЪДщЗЗца╖ч╗УцЮЬя╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">flushAppendOnlyFile</span><span class="token punctuation">(</span><span class="token keyword">int</span> force<span class="token punctuation">)</span> <span class="token punctuation">{</span>
тАж
<span class="token keyword">if</span> <span class="token punctuation">(</span>server<span class="token punctuation">.</span>aof_fsync <span class="token operator">==</span> AOF_FSYNC_ALWAYS<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token function">latencyStartMonitor</span><span class="token punctuation">(</span>latency<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ш░ГчФиlatencyStartMonitorхЗ╜цХ░х╝АхзЛшобцЧ╢</span>
<span class="token function">redis_fsync</span><span class="token punctuation">(</span>server<span class="token punctuation">.</span>aof_fd<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//хоЮщЩЕх░ЖцХ░цНохЖЩхЕечгБчЫШ</span>
        <span class="token function">latencyEndMonitor</span><span class="token punctuation">(</span>latency<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ш░ГчФиlatencyEndMonitorч╗УцЭЯшобцЧ╢я╝Мх╣╢шобчоЧцЧ╢щХ┐</span>
        <span class="token function">latencyAddSampleIfNeeded</span><span class="token punctuation">(</span><span class="token string">&quot;aof-fsync-always&quot;</span><span class="token punctuation">,</span>latency<span class="token punctuation">)</span><span class="token punctuation">;</span>
тАж<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>щВгф╣ИхЬиш┐ЩщЗМя╝Мф╜ащЬАшжБц│ицДПчЪДцШпя╝МRedisц║РчаБхЬиш░ГчФиlatencyAddSampleIfNeededхЗ╜цХ░шо░х╜ХщЗЗца╖ч╗УцЮЬцЧ╢я╝Мч╗Пх╕╕ф╝ЪхЬих╗╢ш┐Яф║Лф╗╢цЙзшбМхЙНя╝Мш░ГчФи<strong>latencyStartMonitorхЗ╜цХ░</strong>х╝АхзЛшобцЧ╢я╝Мх╣╢хЬиф║Лф╗╢цЙзшбМч╗УцЭЯхРОя╝Мш░ГчФи<strong>latencyEndMonitorхЗ╜цХ░</strong>ч╗УцЭЯшобцЧ╢хТМшобчоЧф║Лф╗╢цЙзшбМцЧ╢щХ┐уАВ</p> <p>цндхдЦя╝Мф╜аф╣ЯхПпф╗ехЬищШЕшп╗Redisц║РчаБчЪДх╖ехЕ╖ф╕ня╝МцпФхжВsublimeуАБsourceinsightчнЙя╝МщАЪш┐ЗцЯецЙ╛хЗ╜цХ░хЕ│ч│╗ш░ГчФия╝МцЙ╛хИ░latencyAddSampleIfNeededхЗ╜цХ░швлш░ГчФичЪДхЕ╢ф╗ЦхЬ░цЦ╣уАВ</p> <p>хе╜ф║Жя╝МхИ░ш┐ЩщЗМя╝МRedisх╗╢ш┐ЯчЫСцОзцбЖцЮ╢х░▒шГ╜щАЪш┐ЗlatencyAddSampleIfNeededхЗ╜цХ░я╝МцЭешо░х╜Хх╗╢ш┐Яф║Лф╗╢чЪДщЗЗца╖ч╗УцЮЬф║ЖуАВшАМхоЮщЩЕф╕Кя╝МRedisх╗╢ш┐ЯчЫСцОзцбЖцЮ╢ш┐ШхоЮчО░ф║Жх╗╢ш┐ЯхИЖцЮРя╝Мх╣╢шГ╜цПРф╛Ых║Фхп╣х╗╢ш┐ЯхПШцЕвчЪДх╗║шооя╝МцИСф╗мхЖНцЭечЬЛф╕ЛуАВ</p> <h3 id="х╗╢ш┐ЯхИЖцЮРхТМцПРф╛Ых║Фхп╣цОкцЦ╜х╗║шоо"><a href="#х╗╢ш┐ЯхИЖцЮРхТМцПРф╛Ых║Фхп╣цОкцЦ╜х╗║шоо" class="header-anchor">#</a> х╗╢ш┐ЯхИЖцЮРхТМцПРф╛Ых║Фхп╣цОкцЦ╜х╗║шоо</h3> <p>щжЦхЕИя╝МRedisцШпцПРф╛Ыф║Жlatency doctorхС╜ф╗дя╝МцЭеч╗ЩхЗ║х╗╢ш┐ЯхИЖцЮРч╗УцЮЬхТМх║Фхп╣цЦ╣ц│Хх╗║шоочЪДуАВх╜УцИСф╗мцЙзшбМш┐ЩцЭбхС╜ф╗дчЪДцЧ╢хАЩя╝МRedisх░▒ф╝Ъф╜┐чФиlatencyCommandхЗ╜цХ░цЭехдДчРЖуАВшАМхЬихдДчРЖш┐Щф╕кхС╜ф╗дцЧ╢я╝МlatencyCommandхЗ╜цХ░ф╝Ъш░ГчФи<strong>createLatencyReportхЗ╜цХ░</strong>я╝МцЭечФЯцИРх╗╢ш┐ЯхИЖцЮРцКехСКхТМх║Фхп╣цЦ╣ц│Хх╗║шооуАВ</p> <p>хЕ╖ф╜УцЭешп┤я╝МcreateLatencyReportхЗ╜цХ░ф╝ЪщТИхп╣latency_eventsхУИх╕Мшбиф╕ншо░х╜ХчЪДцпПф╕Ач▒╗ф║Лф╗╢я╝МхЕИш░ГчФиanalyzeLatencyForEventхЗ╜цХ░я╝МшобчоЧшО╖х╛ЧщЗЗца╖чЪДх╗╢ш┐Яф║Лф╗╢цЙзшбМцЧ╢щХ┐чЪДхЭЗхА╝уАБцЬАхдз/цЬАх░ПхА╝чнЙч╗Яшобч╗УцЮЬуАВхЕ╖ф╜УчЪДч╗ЯшобшобчоЧш┐ЗчиЛя╝Мф╜ахПпф╗еф╗Фч╗ЖщШЕшп╗ф╕ЛanalyzeLatencyForEventхЗ╜цХ░чЪДц║РчаБуАВ</p> <p>чД╢хРОя╝МcreateLatencyReportхЗ╜цХ░ф╝ЪщТИхп╣ш┐Щч▒╗ф║Лф╗╢я╝Мч╗УхРИRedisщЕНч╜ощб╣чнЙф┐бцБпч╗ЩхЗ║х║Фхп╣цОкцЦ╜уАВ</p> <p>хЕ╢хоЮя╝МхЬиcreateLatencyReportхЗ╜цХ░ф╕ня╝М<strong>хоГхоЪф╣Йф║ЖхдЪф╕кintхПШщЗПя╝Мх╜Уш┐Щф║ЫхПШщЗПчЪДхА╝ф╕║1цЧ╢я╝Мх░▒шбичд║х╗║шооRedisф╜┐чФишАЕщЗЗчФиф╕АчзНх║Фхп╣щлШх╗╢ш┐ЯчЪДцОкцЦ╜</strong>уАВцИСхЬиф╕ЛщЭвчЪДф╗гчаБф╕нх▒Хчд║ф║ЖщГихИЖх║Фхп╣цОкцЦ╜хп╣х║ФчЪДхПШщЗПя╝Мф╜ахПпф╗ечЬЛф╕ЛуАВхПжхдЦф╜аф╣ЯхПпф╗ещШЕшп╗createLatencyReportхЗ╜цХ░ц║РчаБя╝МхО╗ф║ЖшзгцЙАцЬЙчЪДцОкцЦ╜уАВ</p> <div class="language-c extra-class"><pre class="language-c"><code>sds <span class="token function">createLatencyReport</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    тАж
    <span class="token keyword">int</span> advise_slowlog_enabled <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//х╗║шоохРпчФиslowlog</span>
    <span class="token keyword">int</span> advise_slowlog_tuning <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">//х╗║шоощЗНцЦ░щЕНч╜оslowlogщШИхА╝</span>
    <span class="token keyword">int</span> advise_slowlog_inspect <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">//х╗║шооцгАцЯеslowlogч╗УцЮЬ</span>
    <span class="token keyword">int</span> advise_disk_contention <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">//х╗║шоохЗПх░СчгБчЫШчлЮф║Й</span>
    тАж
<span class="token punctuation">}</span>
</code></pre></div><p>цИСф╗мф╣ЯцЭечоАхНХф╕╛ф╕кф╛ЛхнРуАВцпФхжВшп┤я╝МщТИхп╣commandф║Лф╗╢я╝МcreateLatencyReportхЗ╜цХ░х░▒ф╝Ъца╣цНоslowlogчЪДшо╛ч╜оцГЕхЖ╡я╝Мч╗ЩхЗ║хРпчФиslowlogуАБш░ГцХ┤slowlogщШИхА╝уАБцгАцЯеslowlogцЧех┐Чч╗УцЮЬхТМщБ┐хЕНф╜┐чФиbigkeyчЪДх║Фхп╣х╗║шооуАВш┐ЩщГихИЖф╗гчаБхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcasecmp</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token string">&quot;command&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
   <span class="token comment">//хжВцЮЬц▓бцЬЙхРпчФиslowlogя╝МхИЩх╗║шоохРпчФиslowlog</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>server<span class="token punctuation">.</span>slowlog_log_slower_than <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       advise_slowlog_enabled <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
       advices<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>  
    <span class="token comment">//хжВцЮЬslowlogф╜┐чФичЪДхС╜ф╗дцЧ╢щХ┐щШИхА╝хдкхдзя╝Мх╗║шоош░ГцХ┤slowlogщШИхА╝</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>server<span class="token punctuation">.</span>slowlog_log_slower_than<span class="token operator">/</span><span class="token number">1000</span> <span class="token operator">&gt;</span>server<span class="token punctuation">.</span>latency_monitor_threshold<span class="token punctuation">)</span><span class="token punctuation">{</span>
        advise_slowlog_tuning <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        advices<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//х╗║шооцгАцЯеslowlogч╗УцЮЬ</span>
    advise_slowlog_inspect <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> 
    <span class="token comment">//х╗║шоощБ┐хЕНф╜┐чФиbigkey</span>
    advise_large_objects <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> 
    advices <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>цЙАф╗ея╝МхГПcreateLatencyReportхЗ╜цХ░ш┐Щца╖хЬишобчоЧх╗╢ш┐Яч╗Яшобч╗УцЮЬчЪДхРМцЧ╢я╝Мф╣Яч╗ЩхЗ║х║Фхп╣цОкцЦ╜чЪДшо╛шобх░▒х╛Иф╕НщФЩя╝Мш┐Щф╣ЯцШпф╗ОRedisх╝АхПСшАЕчЪДшзТх║жч╗ЩхЗ║чЪДх╗║шооя╝МхоГцЫ┤хЕ╖цЬЙщТИхп╣цАзуАВ</p> <p>хе╜ф║Жя╝МхИ░ш┐ЩщЗМя╝МцИСф╗мх░▒ф║Жшзгф║Жх╗╢ш┐ЯчЫСцОзцбЖцЮ╢чЪДхоЮчО░уАВцОеф╕ЛцЭея╝МцИСф╗мхЖНцЭехнжф╣аф╕ЛRedisф╕нцЕвхС╜ф╗дцЧех┐ЧчЪДхоЮчО░уАВ</p> <h2 id="цЕвхС╜ф╗дцЧех┐ЧчЪДхоЮчО░"><a href="#цЕвхС╜ф╗дцЧех┐ЧчЪДхоЮчО░" class="header-anchor">#</a> цЕвхС╜ф╗дцЧех┐ЧчЪДхоЮчО░</h2> <p>RedisцШпф╜┐чФиф║Жф╕Аф╕кш╛Гф╕║чоАхНХчЪДцЦ╣ц│ХцЭешо░х╜ХцЕвхС╜ф╗дцЧех┐Чя╝Мф╣Ях░▒цШпчФиф╕Аф╕кхИЧшбия╝МцККцЙзшбМцЧ╢щЧ┤ш╢ЕхЗ║цЕвхС╜ф╗дцЧех┐ЧцЙзшбМцЧ╢щЧ┤щШИхА╝чЪДхС╜ф╗дшо░х╜Хф╕ЛцЭеуАВ</p> <p>хЬиRedisхЕих▒АхПШщЗПserverхп╣х║ФчЪДцХ░цНоч╗УцЮДredisServerф╕ня╝МцЬЙф╕Аф╕кlistч▒╗хЮЛчЪДцИРхСШхПШщЗП<strong>slowlog</strong>я╝МхоГх░▒цШпчФицЭешо░х╜ХцЕвхС╜ф╗дцЧех┐ЧчЪДхИЧшбичЪДя╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">redisServer</span> <span class="token punctuation">{</span>
    тАж
    list <span class="token operator">*</span>slowlog<span class="token punctuation">;</span>
    тАж
<span class="token punctuation">}</span>
</code></pre></div><p>шАМхоЮчО░цЕвхС╜ф╗дцЧех┐Чшо░х╜ХхКЯшГ╜чЪДф╗гчаБцШпхЬи<a href="https://github.com/redis/redis/tree/5.0/src/slowlog.c" target="_blank" rel="noopener noreferrer">slowlog.c<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>цЦЗф╗╢ф╕нуАВш┐ЩщЗМчЪДф╕╗шжБхЗ╜цХ░цШп<strong>slowlogPushEntryIfNeeded</strong>я╝МхоГчЪДхОЯхЮЛхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">slowlogPushEntryIfNeeded</span><span class="token punctuation">(</span>client <span class="token operator">*</span>c<span class="token punctuation">,</span> robj <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">long</span> <span class="token keyword">long</span> duration<span class="token punctuation">)</span>
</code></pre></div><p>ф╗Оф╗гчаБф╕нф╜ахПпф╗ечЬЛхИ░я╝Мш┐Щф╕кхЗ╜цХ░чЪДхПВцХ░хМЕхРлф║Жх╜УхЙНцЙзшбМхС╜ф╗дхПКхЕ╢хПВцХ░argvя╝Мф╗ехПКх╜УхЙНхС╜ф╗дчЪДцЙзшбМцЧ╢щХ┐durationуАВ</p> <p>ш┐Щф╕кхЗ╜цХ░чЪДщА╗ш╛Сф╣Яф╕НхдНцЭВя╝МхоГф╝ЪхИдцЦнх╜УхЙНхС╜ф╗дчЪДцЙзшбМцЧ╢щХ┐durationя╝МцШпхРжхдзф║О redis.conf щЕНч╜оцЦЗф╗╢ф╕нчЪДцЕвхС╜ф╗дцЧех┐ЧщШИхА╝ slowlog-log-slower-thanуАВхжВцЮЬхдзф║ОчЪДшпЭя╝МхоГх░▒ф╝Ъш░ГчФиslowlogCreateEntryхЗ╜цХ░я╝Мф╕║ш┐ЩцЭбхС╜ф╗дхИЫх╗║ф╕АцЭбцЕвхС╜ф╗дцЧех┐Чщб╣я╝Мх╣╢ш░ГчФиlistAddNodeHeaderхЗ╜цХ░я╝МцККш┐ЩцЭбцЧех┐Чщб╣хКахЕехИ░цЧех┐ЧхИЧшбихд┤я╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//х╜УхЙНхС╜ф╗дчЪДцЙзшбМцЧ╢щХ┐цШпхРжхдзф║ОщЕНч╜ощб╣</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>duration <span class="token operator">&gt;=</span> server<span class="token punctuation">.</span>slowlog_log_slower_than<span class="token punctuation">)</span>
   <span class="token function">listAddNodeHead</span><span class="token punctuation">(</span>server<span class="token punctuation">.</span>slowlog<span class="token punctuation">,</span> <span class="token function">slowlogCreateEntry</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>argv<span class="token punctuation">,</span>argc<span class="token punctuation">,</span>duration<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>х╜УчД╢я╝МхжВцЮЬцЧех┐ЧхИЧшбиф╕ншо░х╜Хф║ЖхдкхдЪцЧех┐Чщб╣я╝МхоГц╢ИшАЧчЪДхЖЕхнШш╡Дц║Рф╣Яф╝ЪхвЮхКауАВцЙАф╗еslowlogPushEntryIfNeededхЗ╜цХ░хЬиц╖╗хКацЧех┐Чщб╣цЧ╢я╝Мф╝ЪхИдцЦнцХ┤ф╕кцЧех┐ЧхИЧшбичЪДщХ┐х║жцШпхРжш╢Еш┐ЗщЕНч╜ощб╣slowlog-max-lenуАВф╕АцЧжш╢Еш┐Зф║Жя╝МхоГх░▒ф╝ЪцККхИЧшбицЬлх░╛чЪДцЧех┐Чщб╣хИащЩдя╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//хжВцЮЬцЧех┐ЧхИЧшбиш╢Еш┐ЗщШИхА╝щХ┐х║жя╝Мх░▒хИащЩдхИЧшбицЬлх░╛чЪДцЧех┐Чщб╣</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">listLength</span><span class="token punctuation">(</span>server<span class="token punctuation">.</span>slowlog<span class="token punctuation">)</span> <span class="token operator">&gt;</span> server<span class="token punctuation">.</span>slowlog_max_len<span class="token punctuation">)</span>
        <span class="token function">listDelNode</span><span class="token punctuation">(</span>server<span class="token punctuation">.</span>slowlog<span class="token punctuation">,</span><span class="token function">listLast</span><span class="token punctuation">(</span>server<span class="token punctuation">.</span>slowlog<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>чО░хЬия╝МцИСф╗мф╣Ях░▒ф║Жшзгф║Жшо░х╜ХцЕвхС╜ф╗дцЧех┐Чщб╣чЪДф╕╗шжБхЗ╜цХ░я╝МslowlogPushEntryIfNeededчЪДхЯ║цЬмщА╗ш╛Сф║ЖуАВчД╢хРОцИСф╗мхЖНцЭечЬЛф╕Ля╝МхоГхЬишо░х╜ХцЧех┐Чщб╣цЧ╢ш░ГчФичЪД<strong>slowlogCreateEntryхЗ╜цХ░</strong>уАВ</p> <p>ш┐Щф╕кхЗ╜цХ░цШпчФицЭехИЫх╗║ф╕Аф╕кцЕвхС╜ф╗дцЧех┐Чщб╣уАВцЕвхС╜ф╗дцЧех┐Чщб╣чЪДцХ░цНоч╗УцЮДцШпslowlogEntryя╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">slowlogEntry</span> <span class="token punctuation">{</span>
    <span class="token comment">//цЧех┐Чщб╣хп╣х║ФчЪДхС╜ф╗дхПКхПВцХ░</span>
    robj <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">;</span>     
    <span class="token comment">//цЧех┐Чщб╣хп╣х║ФчЪДхС╜ф╗дхПКхПВцХ░ф╕кцХ░</span>
    <span class="token keyword">int</span> argc<span class="token punctuation">;</span>        
    <span class="token comment">//цЧех┐Чщб╣чЪДхФпф╕АID</span>
    <span class="token keyword">long</span> <span class="token keyword">long</span> id<span class="token punctuation">;</span> 
    <span class="token comment">//цЧех┐Чщб╣хп╣х║ФхС╜ф╗дчЪДцЙзшбМцЧ╢щХ┐я╝Иф╗ех╛очзТф╕║хНХф╜Ня╝Й</span>
    <span class="token keyword">long</span> <span class="token keyword">long</span> duration<span class="token punctuation">;</span>  
    <span class="token comment">//цЧех┐Чщб╣хп╣х║ФхС╜ф╗дчЪДцЙзшбМцЧ╢щЧ┤цИ│</span>
    <span class="token class-name">time_t</span> time<span class="token punctuation">;</span>        
    <span class="token comment">//цЧех┐Чщб╣хп╣х║ФхС╜ф╗дчЪДхПСщАБховцИ╖члпхРНчз░</span>
    sds cname<span class="token punctuation">;</span>      
    <span class="token comment">//цЧех┐Чщб╣хп╣х║ФхС╜ф╗дчЪДхПСщАБховцИ╖члпч╜Сч╗ЬхЬ░хЭА</span>
    sds peerid<span class="token punctuation">;</span>         
<span class="token punctuation">}</span> slowlogEntry<span class="token punctuation">;</span>
</code></pre></div><p>ф╗ОslowLogEntryчЪДхоЪф╣Йф╕ня╝Мф╜ахПпф╗ечЬЛхИ░я╝МхоГф╝ЪцККцЕвхС╜ф╗дхПКхЕ╢хПВцХ░я╝Мф╗ехПКхПСщАБхС╜ф╗дчЪДховцИ╖члпч╜Сч╗ЬхЬ░хЭАшо░х╜Хф╕ЛцЭеуАВ<strong>ш┐Щца╖шо╛шобчЪДхе╜хдДцШп</strong>я╝Мх╜УцИСф╗мхИЖцЮРцЕвхС╜ф╗дцЧех┐ЧцЧ╢я╝Мх░▒хПпф╗ечЫ┤цОечЬЛхИ░цЕвхС╜ф╗дцЬмш║лхПКхЕ╢хПВцХ░ф║Жя╝МшАМф╕ФхПпф╗ечЯещБУхПСщАБхС╜ф╗дчЪДховцИ╖члпф┐бцБпуАВшАМш┐Щф║Ыф┐бцБпя╝Мх░▒цЬЙхИйф║ОцИСф╗мцОТцЯецЕвхС╜ф╗дчЪДш╡╖хЫахТМцЭец║РуАВ</p> <p>цпФхжВшп┤я╝МхжВцЮЬцИСф╗мхПСчО░цЧех┐Чф╕ншо░х╜ХчЪДхС╜ф╗дхПВцХ░щЭЮх╕╕хдЪя╝МщВгф╣ИхоГх░▒хПпшГ╜цШпф╕АцЭбцУНф╜ЬbigkeyчЪДхС╜ф╗дуАВ</p> <p>х╜УчД╢я╝МшАГшЩСхИ░хЖЕхнШш╡Дц║РцЬЙщЩРя╝МslowlogCreateEntryхЗ╜цХ░хЬихИЫх╗║цЕвхС╜ф╗дцЧех┐Чщб╣цЧ╢я╝Мф╣Яф╝ЪхИдцЦнхС╜ф╗дхПВцХ░ф╕кцХ░уАВхжВцЮЬхС╜ф╗дхПВцХ░ф╕кцХ░я╝Мш╢ЕхЗ║ф║ЖщШИхА╝SLOWLOG_ENTRY_MAX_ARGCш┐Щф╕кхоПхоЪф╣ЙчЪДхдзх░Пя╝Ищ╗Шшод32я╝ЙцЧ╢я╝МхоГх░▒ф╕Нф╝Ъшо░х╜Хш╢ЕхЗ║щШИхА╝чЪДхПВцХ░ф║Жя╝МшАМцШпшо░х╜Хф╕ЛхЙйф╜ЩчЪДхПВцХ░ф╕кцХ░уАВш┐Щца╖ф╕АцЭея╝МцЕвхС╜ф╗дцЧех┐Чщб╣ф╕нх░▒цЧвшо░х╜Хф║ЖщГихИЖхС╜ф╗дхПВцХ░я╝МцЬЙхКйф║ОцОТцЯещЧощвШя╝Мф╣ЯщБ┐хЕНф║Жшо░х╜Хш┐ЗхдЪхПВцХ░я╝МхНачФиш┐ЗхдЪхЖЕхнШуАВ</p> <p>ф╕ЛщЭвчЪДф╗гчаБх▒Хчд║ф║ЖslowlogCreateEntryчЪДхЯ║цЬмцЙзшбМщА╗ш╛Ся╝Мф╜ахПпф╗ечЬЛф╕ЛуАВ</p> <div class="language-c extra-class"><pre class="language-c"><code>slowlogEntry <span class="token operator">*</span><span class="token function">slowlogCreateEntry</span><span class="token punctuation">(</span>client <span class="token operator">*</span>c<span class="token punctuation">,</span> robj <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">long</span> <span class="token keyword">long</span> duration<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//хИЖщЕНцЧех┐Чщб╣чй║щЧ┤</span>
    slowlogEntry <span class="token operator">*</span>se <span class="token operator">=</span> <span class="token function">zmalloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>se<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token comment">//х╛Ешо░х╜ХчЪДхПВцХ░ф╕кцХ░я╝Мщ╗Шшодф╕║х╜УхЙНхС╜ф╗дчЪДхПВцХ░ф╕кцХ░</span>
    <span class="token keyword">int</span> j<span class="token punctuation">,</span> slargc <span class="token operator">=</span> argc<span class="token punctuation">;</span>  

    <span class="token comment">//хжВцЮЬх╜УхЙНхС╜ф╗дхПВцХ░ф╕кцХ░ш╢ЕхЗ║щШИхА╝я╝МхИЩхПкшо░х╜ХщШИхА╝ф╕кцХ░чЪДхПВцХ░</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>slargc <span class="token operator">&gt;</span> SLOWLOG_ENTRY_MAX_ARGC<span class="token punctuation">)</span> slargc <span class="token operator">=</span> SLOWLOG_ENTRY_MAX_ARGC<span class="token punctuation">;</span>
    se<span class="token operator">-&gt;</span>argc <span class="token operator">=</span> slargc<span class="token punctuation">;</span>
    тАж
    <span class="token comment">//щАРф╕Ашо░х╜ХхС╜ф╗дхПКхПВцХ░</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> slargc<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//хжВцЮЬхС╜ф╗дхПВцХ░ф╕кцХ░ш╢ЕхЗ║щШИхА╝я╝Мф╜┐чФицЬАхРОф╕Аф╕кхПВцХ░шо░х╜Хх╜УхЙНхС╜ф╗дхоЮщЩЕхЙйф╜ЩчЪДхПВцХ░ф╕кцХ░</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span>slargc <span class="token operator">!=</span> argc <span class="token operator">&amp;&amp;</span> j <span class="token operator">==</span> slargc<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
          se<span class="token operator">-&gt;</span>argv<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">createObject</span><span class="token punctuation">(</span>OBJ_STRING<span class="token punctuation">,</span>
                    <span class="token function">sdscatprintf</span><span class="token punctuation">(</span><span class="token function">sdsempty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;... (%d more arguments)&quot;</span><span class="token punctuation">,</span>
                    argc<span class="token operator">-</span>slargc<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            тАж  <span class="token comment">//х░ЖхС╜ф╗дхПВцХ░хблхЕЕхИ░цЧех┐Чщб╣ф╕н</span>
            <span class="token punctuation">}</span><span class="token punctuation">}</span>
    тАж <span class="token comment">//х░ЖхС╜ф╗дцЙзшбМцЧ╢щХ┐уАБховцИ╖члпхЬ░хЭАчнЙф┐бцБпхблхЕЕхИ░цЧех┐Чщб╣ф╕н</span>
<span class="token punctuation">}</span>
</code></pre></div><p>хе╜ф║Жя╝МхИ░ш┐ЩщЗМя╝Мф╜ах░▒ф║Жшзгф║ЖцЕвхС╜ф╗дцЧех┐ЧчЪДхоЮчО░уАВцЬАхРОя╝Мф╜аф╣ЯшжБц│ицДПя╝М<strong>цЕвхС╜ф╗дцЧех┐ЧхПкф╝Ъшо░х╜Хш╢ЕхЗ║цЙзшбМцЧ╢щХ┐щШИхА╝чЪДхС╜ф╗дф┐бцБп</strong>я╝МшАМф╕Нф╝ЪхГПх╗╢ш┐ЯчЫСцОзцбЖцЮ╢щВгца╖шо░х╜ХхдЪчзНф║Лф╗╢уАВцЙАф╗ея╝Мшо░х╜ХцЧех┐ЧчЪДхЗ╜цХ░slowlogPushEntryIfNeededя╝МхПкф╝ЪхЬихС╜ф╗дцЙзшбМхЗ╜цХ░callя╝ИхЬиserver.cцЦЗф╗╢ф╕ня╝Йф╕ншвлш░ГчФия╝МхжВф╕ЛцЙАчд║я╝Ъ</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span>client <span class="token operator">*</span>c<span class="token punctuation">,</span> <span class="token keyword">int</span> flags<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    тАж
   	<span class="token comment">//хС╜ф╗дцЙзшбМхЙНшобцЧ╢</span>
    start <span class="token operator">=</span> server<span class="token punctuation">.</span>ustime<span class="token punctuation">;</span> 
    <span class="token comment">//хС╜ф╗дхоЮщЩЕцЙзшбМ</span>
    c<span class="token operator">-&gt;</span>cmd<span class="token operator">-&gt;</span><span class="token function">proc</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token comment">//хС╜ф╗дцЙзшбМхоМцИРшобчоЧшАЧцЧ╢</span>
    duration <span class="token operator">=</span> <span class="token function">ustime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>start<span class="token punctuation">;</span> 
    тАж
    <span class="token keyword">if</span> <span class="token punctuation">(</span>flags <span class="token operator">&amp;</span> CMD_CALL_SLOWLOG <span class="token operator">&amp;&amp;</span> c<span class="token operator">-&gt;</span>cmd<span class="token operator">-&gt;</span>proc <span class="token operator">!=</span> execCommand<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        тАж
        <span class="token comment">//ш░ГчФи slowlogPushEntryIfNeeded хЗ╜цХ░шо░х╜ХцЕвхС╜ф╗д</span>
        <span class="token function">slowlogPushEntryIfNeeded</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>c<span class="token operator">-&gt;</span>argv<span class="token punctuation">,</span>c<span class="token operator">-&gt;</span>argc<span class="token punctuation">,</span>duration<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    тАж
<span class="token punctuation">}</span>
</code></pre></div><h2 id="цА╗ч╗У"><a href="#цА╗ч╗У" class="header-anchor">#</a> цА╗ч╗У</h2> <p>RedisхоЮчО░чЪДх╗╢ш┐ЯчЫСцОзцбЖцЮ╢хТМцЕвхС╜ф╗дцЧех┐ЧуАВ</p> <p>ф╜ашжБчЯещБУя╝МRedisц║РчаБф╝ЪщТИхп╣хПпшГ╜хп╝шЗ┤Redisш┐РшбМхПШцЕвчЪДф║Фч▒╗ф║Лф╗╢я╝МхЬихоГф╗мцЙзшбМцЧ╢ш┐ЫшбМ<strong>щЗЗца╖</strong>уАВшАМф╕АцЧжш┐Щф║Ыф║Лф╗╢чЪДцЙзшбМцЧ╢щХ┐ш╢Еш┐ЗщШИхА╝цЧ╢я╝МчЫСцОзцбЖцЮ╢х░▒ф╝Ъх░ЖщЗЗца╖ч╗УцЮЬшо░х╜Хф╕ЛцЭея╝Мф╗еф╛┐хРОч╗нхИЖцЮРф╜┐чФиуАВш┐ЩчзНщТИхп╣х╗╢ш┐Яф║Лф╗╢ш┐ЫшбМщЗЗца╖шо░х╜ХчЪДчЫСцОзцЦ╣ц│Хя╝МхЕ╢хоЮцШпх╛ИхА╝х╛ЧцИСф╗мхнжф╣ачЪДуАВ</p> <p>шАМцЕвхС╜ф╗дцЧех┐ЧчЪДхоЮчО░хИЩш╛Гф╕║чоАхНХя╝Мх░▒цШпщТИхп╣ш┐РшбМцЧ╢щХ┐ш╢ЕхЗ║щШИхА╝чЪДхС╜ф╗дя╝Мф╜┐чФиф╕Аф╕к<strong>хИЧшби</strong>цККхоГф╗мшо░х╜Хф╕ЛцЭея╝Мш┐ЩщЗМщЭвхМЕцЛмф║ЖхС╜ф╗дхПКхПВцХ░я╝Мф╗ехПКхПСщАБхС╜ф╗дчЪДховцИ╖члпф┐бцБпя╝Мш┐Щца╖хПпф╗ецЦ╣ф╛┐ш┐Рч╗┤ф║║хСШцЯечЬЛхИЖцЮРуАВ</p> <p>х╜УчД╢я╝МRedisц║РчаБф╕нхоЮчО░чЪДх╗╢ш┐ЯчЫСцОзцбЖцЮ╢ф╕╗шжБцШпхЕ│ц│ихп╝шЗ┤х╗╢ш┐ЯхвЮхКачЪДф║Лф╗╢я╝МхоГшо░х╜ХчЪДх╗╢ш┐Яф║Лф╗╢я╝Мф╣ЯцШпхТМRedisш┐РшбМш┐ЗчиЛф╕нхПпшГ╜ф╝Ъхп╝шЗ┤ш┐РшбМхПШцЕвчЪДцУНф╜Ь<strong>ч┤зшАжхРИ</strong>чЪДуАВцндхдЦя╝МRedisчЪДINFOхС╜ф╗дф╣ЯцПРф╛Ыф║ЖRedisш┐РшбМцЧ╢чЪДчЫСцОзф┐бцБпя╝Мф╕Нш┐Зф╜ашжБчЯещБУя╝МINFOхС╜ф╗дчЪДхоЮчО░я╝Мф╕╗шжБцШпхЬихЕих▒АхПШщЗПserverчЪДцИРхСШхПШщЗПф╕ня╝МчФицЭешо░х╜ХRedisхоЮф╛ЛчЪДхоЮцЧ╢ш┐РшбМчК╢цАБцИЦцШпш╡Дц║Рф╜┐чФицГЕхЖ╡чЪДуАВ</p> <h2 id="хПВшАГш╡ДцЦЩ"><a href="#хПВшАГш╡ДцЦЩ" class="header-anchor">#</a> хПВшАГш╡ДцЦЩ</h2> <ul><li><p><a href="https://time.geekbang.org/column/intro/100084301?utm_campaign=geektime_search&amp;utm_content=geektime_search&amp;utm_medium=geektime_search&amp;utm_source=geektime_search&amp;utm_term=geektime_search" target="_blank" rel="noopener noreferrer">цЮБховцЧ╢щЧ┤я╝ЪRedisц║РчаБхЙЦцЮРф╕ОхоЮцИШ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://book.douban.com/subject/25900156/" target="_blank" rel="noopener noreferrer">Redisшо╛шобф╕ОхоЮчО░ <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><a href="https://github.com/redis/redis/blob/5.0/src/ae.c" target="_blank" rel="noopener noreferrer">Githubя╝Ъredis ц║РчаБ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/echo-lxy/echo-system-design/edit/master/docs/Redis ч│╗ч╗Яшо╛шоб/04.хЫЫуАБцФпч║┐ф╗╗хКб/20.Redis ф╕нчЪДх╗╢ш┐ЯчЫСцОз.md" target="_blank" rel="noopener noreferrer">ч╝Цш╛С</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">ф╕КцмбцЫ┤цЦ░ф║О:</span> <span class="time">2024/09/18, 11:29:27</span></div></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><span class="prev">
        тЖР
        <a href="/pages/9b17a7/" class="prev">AOF цМБф╣ЕхМЦ</a></span> <span class="next"><a href="/pages/61d908/">хПСх╕Гф╕ОшовщШЕ</a>тЖТ
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:lixinyang2002@163.com" title="хПСщВоф╗╢" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/echo-lxy" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="хРмщЯ│ф╣Р" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="цЬмчлЩф╕╗щвШ">Vdoing</a> 
    | Copyright ┬й 2024-2024
    <span>Xinyang Li | MIT License</span></div> <div class="buttons"><div title="ш┐ФхЫЮщб╢щГи" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="хО╗шпДшо║" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ф╕╗щвШцибх╝П" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          ш╖ЯщЪПч│╗ч╗Я
        </li><li class="iconfont icon-rijianmoshi">
          ц╡ЕшЙ▓цибх╝П
        </li><li class="iconfont icon-yejianmoshi">
          ц╖▒шЙ▓цибх╝П
        </li><li class="iconfont icon-yuedu">
          щШЕшп╗цибх╝П
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.59640afe.js" defer></script><script src="/assets/js/2.933750c6.js" defer></script><script src="/assets/js/76.15d5bea9.js" defer></script><script src="/assets/js/7.7eb70372.js" defer></script>
  </body>
</html>
