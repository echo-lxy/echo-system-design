(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{363:function(e,r,t){"use strict";t.r(r);var n=t(4),a=Object(n.a)({},(function(){var e=this,r=e._self._c;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h3",{attrs:{id:"域名系统"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#域名系统"}},[e._v("#")]),e._v(" 域名系统")]),e._v(" "),r("p",[r("img",{attrs:{src:"https://echo798.oss-cn-shenzhen.aliyuncs.com/img/202409151051669.jpeg",alt:"img"}})]),e._v(" "),r("p",[e._v("域名系统是把 "),r("a",{attrs:{href:"http://www.example.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("www.example.com"),r("OutboundLink")],1),e._v(" 等域名转换成 IP 地址。")]),e._v(" "),r("p",[e._v("域名系统是分层次的，一些 DNS 服务器位于顶层。当查询（域名） IP 时，路由或 ISP 提供连接 DNS 服务器的信息。较底层的 DNS 服务器缓存映射，它可能会因为 DNS 传播延时而失效。DNS 结果可以缓存在浏览器或操作系统中一段时间，时间长短取决于"),r("a",{attrs:{href:"https://en.wikipedia.org/wiki/Time_to_live",target:"_blank",rel:"noopener noreferrer"}},[e._v("存活时间 TTL"),r("OutboundLink")],1),e._v("。")]),e._v(" "),r("ul",[r("li",[r("strong",[e._v("NS 记录（域名服务）")]),e._v(" ─ 指定解析域名或子域名的 DNS 服务器。")]),e._v(" "),r("li",[r("strong",[e._v("MX 记录（邮件交换）")]),e._v(" ─ 指定接收信息的邮件服务器。")]),e._v(" "),r("li",[r("strong",[e._v("A 记录（地址）")]),e._v(" ─ 指定域名对应的 IP 地址记录。")]),e._v(" "),r("li",[r("strong",[e._v("CNAME（规范）")]),e._v(" ─ 一个域名映射到另一个域名或 "),r("code",[e._v("CNAME")]),e._v(" 记录（ example.com 指向 "),r("a",{attrs:{href:"http://www.example.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("www.example.com"),r("OutboundLink")],1),e._v(" ）或映射到一个 "),r("code",[e._v("A")]),e._v(" 记录。")])]),e._v(" "),r("p",[r("a",{attrs:{href:"https://www.cloudflare.com/dns/",target:"_blank",rel:"noopener noreferrer"}},[e._v("CloudFlare"),r("OutboundLink")],1),e._v(" 和 "),r("a",{attrs:{href:"https://aws.amazon.com/route53/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Route 53"),r("OutboundLink")],1),e._v(" 等平台提供管理 DNS 的功能。某些 DNS 服务通过集中方式来路由流量:")]),e._v(" "),r("ul",[r("li",[e._v("加权轮询调度\n"),r("ul",[r("li",[e._v("防止流量进入维护中的服务器")]),e._v(" "),r("li",[e._v("在不同大小集群间负载均衡")]),e._v(" "),r("li",[e._v("A/B 测试")])])]),e._v(" "),r("li",[e._v("基于延迟路由")]),e._v(" "),r("li",[e._v("基于地理位置路由")])]),e._v(" "),r("h4",{attrs:{id:"缺陷-dns"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#缺陷-dns"}},[e._v("#")]),e._v(" 缺陷:DNS")]),e._v(" "),r("ul",[r("li",[e._v("虽说缓存可以减轻 DNS 延迟，但连接 DNS 服务器还是带来了轻微的延迟。")]),e._v(" "),r("li",[e._v("虽然它们通常由"),r("a",{attrs:{href:"http://superuser.com/questions/472695/who-controls-the-dns-servers/472729",target:"_blank",rel:"noopener noreferrer"}},[e._v("政府，网络服务提供商和大公司"),r("OutboundLink")],1),e._v("管理，但 DNS 服务管理仍可能是复杂的。")]),e._v(" "),r("li",[e._v("DNS 服务最近遭受 "),r("a",{attrs:{href:"http://dyn.com/blog/dyn-analysis-summary-of-friday-october-21-attack/",target:"_blank",rel:"noopener noreferrer"}},[e._v("DDoS 攻击"),r("OutboundLink")],1),e._v("，阻止不知道 Twitter IP 地址的用户访问 Twitter。")])]),e._v(" "),r("h4",{attrs:{id:"来源及延伸阅读"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#来源及延伸阅读"}},[e._v("#")]),e._v(" 来源及延伸阅读")]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://technet.microsoft.com/en-us/library/dd197427(v=ws.10).aspx",target:"_blank",rel:"noopener noreferrer"}},[e._v("DNS 架构"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://en.wikipedia.org/wiki/Domain_Name_System",target:"_blank",rel:"noopener noreferrer"}},[e._v("Wikipedia"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://support.dnsimple.com/categories/dns/",target:"_blank",rel:"noopener noreferrer"}},[e._v("关于 DNS 的文章"),r("OutboundLink")],1)])]),e._v(" "),r("h3",{attrs:{id:"内容分发网络-cdn"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#内容分发网络-cdn"}},[e._v("#")]),e._v(" 内容分发网络（CDN）")]),e._v(" "),r("p",[r("img",{attrs:{src:"https://echo798.oss-cn-shenzhen.aliyuncs.com/img/202409151050537.jpeg",alt:"img"}})]),e._v(" "),r("p",[e._v("内容分发网络（CDN）是一个全球性的代理服务器分布式网络，它从靠近用户的位置提供内容。通常，HTML/CSS/JS，图片和视频等静态内容由 CDN 提供，虽然亚马逊 CloudFront 等也支持动态内容。CDN 的 DNS 解析会告知客户端连接哪台服务器。")]),e._v(" "),r("p",[e._v("将内容存储在 CDN 上可以从两个方面来提供性能:")]),e._v(" "),r("ul",[r("li",[e._v("从靠近用户的数据中心提供资源")]),e._v(" "),r("li",[e._v("通过 CDN 你的服务器不必真的处理请求")])]),e._v(" "),r("h4",{attrs:{id:"cdn-推送-push"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#cdn-推送-push"}},[e._v("#")]),e._v(" CDN 推送（push）")]),e._v(" "),r("p",[e._v("当你服务器上内容发生变动时，推送 CDN 接受新内容。直接推送给 CDN 并重写 URL 地址以指向你的内容的 CDN 地址。你可以配置内容到期时间及何时更新。内容只有在更改或新增是才推送，流量最小化，但储存最大化。")]),e._v(" "),r("h4",{attrs:{id:"cdn-拉取-pull"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#cdn-拉取-pull"}},[e._v("#")]),e._v(" CDN 拉取（pull）")]),e._v(" "),r("p",[e._v("CDN 拉取是当第一个用户请求该资源时，从服务器上拉取资源。你将内容留在自己的服务器上并重写 URL 指向 CDN 地址。直到内容被缓存在 CDN 上为止，这样请求只会更慢，")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://en.wikipedia.org/wiki/Time_to_live",target:"_blank",rel:"noopener noreferrer"}},[e._v("存活时间（TTL）"),r("OutboundLink")],1),e._v("决定缓存多久时间。CDN 拉取方式最小化 CDN 上的储存空间，但如果过期文件并在实际更改之前被拉取，则会导致冗余的流量。")]),e._v(" "),r("p",[e._v("高流量站点使用 CDN 拉取效果不错，因为只有最近请求的内容保存在 CDN 中，流量才能更平衡地分散。")]),e._v(" "),r("h4",{attrs:{id:"缺陷-cdn"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#缺陷-cdn"}},[e._v("#")]),e._v(" 缺陷：CDN")]),e._v(" "),r("ul",[r("li",[e._v("CDN 成本可能因流量而异，可能在权衡之后你将不会使用 CDN。")]),e._v(" "),r("li",[e._v("如果在 TTL 过期之前更新内容，CDN 缓存内容可能会过时。")]),e._v(" "),r("li",[e._v("CDN 需要更改静态内容的 URL 地址以指向 CDN。")])]),e._v(" "),r("h4",{attrs:{id:"来源及延伸阅读-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#来源及延伸阅读-2"}},[e._v("#")]),e._v(" 来源及延伸阅读")]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"http://repository.cmu.edu/cgi/viewcontent.cgi?article=2112&context=compsci",target:"_blank",rel:"noopener noreferrer"}},[e._v("全球性内容分发网络"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"http://www.travelblogadvice.com/technical/the-differences-between-push-and-pull-cdns/",target:"_blank",rel:"noopener noreferrer"}},[e._v("CDN 拉取和 CDN 推送的区别"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://en.wikipedia.org/wiki/Content_delivery_network",target:"_blank",rel:"noopener noreferrer"}},[e._v("Wikipedia"),r("OutboundLink")],1)])]),e._v(" "),r("h3",{attrs:{id:"负载均衡器"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#负载均衡器"}},[e._v("#")]),e._v(" 负载均衡器")]),e._v(" "),r("p",[r("img",{attrs:{src:"https://echo798.oss-cn-shenzhen.aliyuncs.com/img/202409151050055.png",alt:"img"}})]),e._v(" "),r("p",[e._v("负载均衡器将传入的请求分发到应用服务器和数据库等计算资源。无论哪种情况，负载均衡器将从计算资源来的响应返回给恰当的客户端。负载均衡器的效用在于:")]),e._v(" "),r("ul",[r("li",[e._v("防止请求进入不好的服务器")]),e._v(" "),r("li",[e._v("防止资源过载")]),e._v(" "),r("li",[e._v("帮助消除单一的故障点")])]),e._v(" "),r("p",[e._v("负载均衡器可以通过硬件（昂贵）或 HAProxy 等软件来实现。 增加的好处包括:")]),e._v(" "),r("ul",[r("li",[r("p",[e._v("SSL 终结")]),e._v(" "),r("p",[e._v("─ 解密传入的请求并加密服务器响应，这样的话后端服务器就不必再执行这些潜在高消耗运算了。")]),e._v(" "),r("ul",[r("li",[e._v("不需要再每台服务器上安装 "),r("a",{attrs:{href:"https://en.wikipedia.org/wiki/X.509",target:"_blank",rel:"noopener noreferrer"}},[e._v("X.509 证书"),r("OutboundLink")],1),e._v("。")])])]),e._v(" "),r("li",[r("p",[r("strong",[e._v("Session 留存")]),e._v(" ─ 如果 Web 应用程序不追踪会话，发出 cookie 并将特定客户端的请求路由到同一实例。")])])]),e._v(" "),r("p",[e._v("通常会设置采用"),r("a",{attrs:{href:"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%B7%A5%E4%BD%9C%E5%88%B0%E5%A4%87%E7%94%A8%E5%88%87%E6%8D%A2active-passive",target:"_blank",rel:"noopener noreferrer"}},[e._v("工作 ─ 备用"),r("OutboundLink")],1),e._v(" 或 "),r("a",{attrs:{href:"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%8F%8C%E5%B7%A5%E4%BD%9C%E5%88%87%E6%8D%A2active-active",target:"_blank",rel:"noopener noreferrer"}},[e._v("双工作"),r("OutboundLink")],1),e._v(" 模式的多个负载均衡器，以免发生故障。")]),e._v(" "),r("p",[e._v("负载均衡器能基于多种方式来路由流量:")]),e._v(" "),r("ul",[r("li",[e._v("随机")]),e._v(" "),r("li",[e._v("最少负载")]),e._v(" "),r("li",[e._v("Session/cookie")]),e._v(" "),r("li",[r("a",{attrs:{href:"http://g33kinfo.com/info/archives/2657",target:"_blank",rel:"noopener noreferrer"}},[e._v("轮询调度或加权轮询调度算法"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%9B%9B%E5%B1%82%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1",target:"_blank",rel:"noopener noreferrer"}},[e._v("四层负载均衡"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E4%B8%83%E5%B1%82%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1",target:"_blank",rel:"noopener noreferrer"}},[e._v("七层负载均衡"),r("OutboundLink")],1)])]),e._v(" "),r("h4",{attrs:{id:"四层负载均衡"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#四层负载均衡"}},[e._v("#")]),e._v(" 四层负载均衡")]),e._v(" "),r("p",[e._v("四层负载均衡根据监看"),r("a",{attrs:{href:"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E9%80%9A%E8%AE%AF",target:"_blank",rel:"noopener noreferrer"}},[e._v("传输层"),r("OutboundLink")],1),e._v("的信息来决定如何分发请求。通常，这会涉及来源，目标 IP 地址和请求头中的端口，但不包括数据包（报文）内容。四层负载均衡执行"),r("a",{attrs:{href:"https://www.nginx.com/resources/glossary/layer-4-load-balancing/",target:"_blank",rel:"noopener noreferrer"}},[e._v("网络地址转换（NAT）"),r("OutboundLink")],1),e._v("来向上游服务器转发网络数据包。")]),e._v(" "),r("h4",{attrs:{id:"七层负载均衡器"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#七层负载均衡器"}},[e._v("#")]),e._v(" 七层负载均衡器")]),e._v(" "),r("p",[e._v("七层负载均衡器根据监控"),r("a",{attrs:{href:"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E9%80%9A%E8%AE%AF",target:"_blank",rel:"noopener noreferrer"}},[e._v("应用层"),r("OutboundLink")],1),e._v("来决定怎样分发请求。这会涉及请求头的内容，消息和 cookie。七层负载均衡器终结网络流量，读取消息，做出负载均衡判定，然后传送给特定服务器。比如，一个七层负载均衡器能直接将视频流量连接到托管视频的服务器，同时将更敏感的用户账单流量引导到安全性更强的服务器。")]),e._v(" "),r("p",[e._v("以损失灵活性为代价，四层负载均衡比七层负载均衡花费更少时间和计算资源，虽然这对现代商用硬件的性能影响甚微。")]),e._v(" "),r("h4",{attrs:{id:"水平扩展"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#水平扩展"}},[e._v("#")]),e._v(" 水平扩展")]),e._v(" "),r("p",[e._v("负载均衡器还能帮助水平扩展，提高性能和可用性。使用商业硬件的性价比更高，并且比在单台硬件上"),r("strong",[e._v("垂直扩展")]),e._v("更贵的硬件具有更高的可用性。相比招聘特定企业系统人才，招聘商业硬件方面的人才更加容易。")]),e._v(" "),r("h4",{attrs:{id:"缺陷-水平扩展"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#缺陷-水平扩展"}},[e._v("#")]),e._v(" 缺陷：水平扩展")]),e._v(" "),r("ul",[r("li",[e._v("水平扩展引入了复杂度并涉及服务器复制\n"),r("ul",[r("li",[e._v("服务器应该是无状态的:它们也不该包含像 session 或资料图片等与用户关联的数据。")]),e._v(" "),r("li",[e._v("session 可以集中存储在数据库或持久化"),r("a",{attrs:{href:"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E7%BC%93%E5%AD%98",target:"_blank",rel:"noopener noreferrer"}},[e._v("缓存"),r("OutboundLink")],1),e._v("（Redis、Memcached）的数据存储区中。")])])]),e._v(" "),r("li",[e._v("缓存和数据库等下游服务器需要随着上游服务器进行扩展，以处理更多的并发连接。")])]),e._v(" "),r("h4",{attrs:{id:"缺陷-负载均衡器"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#缺陷-负载均衡器"}},[e._v("#")]),e._v(" 缺陷：负载均衡器")]),e._v(" "),r("ul",[r("li",[e._v("如果没有足够的资源配置或配置错误，负载均衡器会变成一个性能瓶颈。")]),e._v(" "),r("li",[e._v("引入负载均衡器以帮助消除单点故障但导致了额外的复杂性。")]),e._v(" "),r("li",[e._v("单个负载均衡器会导致单点故障，但配置多个负载均衡器会进一步增加复杂性。")])]),e._v(" "),r("h4",{attrs:{id:"来源及延伸阅读-3"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#来源及延伸阅读-3"}},[e._v("#")]),e._v(" 来源及延伸阅读")]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://www.nginx.com/blog/inside-nginx-how-we-designed-for-performance-scale/",target:"_blank",rel:"noopener noreferrer"}},[e._v("NGINX 架构"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"http://www.haproxy.org/download/1.2/doc/architecture.txt",target:"_blank",rel:"noopener noreferrer"}},[e._v("HAProxy 架构指南"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"http://www.lecloud.net/post/7295452622/scalability-for-dummies-part-1-clones",target:"_blank",rel:"noopener noreferrer"}},[e._v("可扩展性"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://en.wikipedia.org/wiki/Load_balancing_(computing)",target:"_blank",rel:"noopener noreferrer"}},[e._v("Wikipedia"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://www.nginx.com/resources/glossary/layer-4-load-balancing/",target:"_blank",rel:"noopener noreferrer"}},[e._v("四层负载平衡"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://www.nginx.com/resources/glossary/layer-7-load-balancing/",target:"_blank",rel:"noopener noreferrer"}},[e._v("七层负载平衡"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"http://docs.aws.amazon.com/elasticloadbalancing/latest/classic/elb-listener-config.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("ELB 监听器配置"),r("OutboundLink")],1)])]),e._v(" "),r("h3",{attrs:{id:"反向代理-web-服务器"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#反向代理-web-服务器"}},[e._v("#")]),e._v(" 反向代理（web 服务器）")]),e._v(" "),r("p",[r("img",{attrs:{src:"https://echo798.oss-cn-shenzhen.aliyuncs.com/img/202409151050923.png",alt:""}})])])}),[],!1,null,null,null);r.default=a.exports}}]);